(this.webpackJsonpTwine=this.webpackJsonpTwine||[]).push([[0],[,,,function(e,t,n){"use strict";var a=n(222);n.d(t,"addPassageTag",(function(){return a.a})),n.d(t,"createStory",(function(){return a.b})),n.d(t,"createUntitledPassage",(function(){return a.c})),n.d(t,"deletePassages",(function(){return a.d})),n.d(t,"deleteStory",(function(){return a.e})),n.d(t,"deselectAllStories",(function(){return a.f})),n.d(t,"deselectPassage",(function(){return a.g})),n.d(t,"deselectStory",(function(){return a.h})),n.d(t,"duplicateStory",(function(){return a.i})),n.d(t,"highlightPassagesMatchingSearch",(function(){return a.j})),n.d(t,"importStories",(function(){return a.k})),n.d(t,"movePassages",(function(){return a.l})),n.d(t,"removePassageTag",(function(){return a.m})),n.d(t,"renamePassageTag",(function(){return a.n})),n.d(t,"renameStoryTag",(function(){return a.o})),n.d(t,"replaceInStory",(function(){return a.p})),n.d(t,"selectAllPassages",(function(){return a.q})),n.d(t,"selectPassage",(function(){return a.r})),n.d(t,"selectPassagesInRect",(function(){return a.s})),n.d(t,"selectStory",(function(){return a.t})),n.d(t,"setTagColor",(function(){return a.u})),n.d(t,"updatePassage",(function(){return a.v})),n.d(t,"updateStory",(function(){return a.w}));var r=n(34);n.d(t,"passageDefaults",(function(){return r.a})),n.d(t,"storyDefaults",(function(){return r.b}));var o=n(79);n.d(t,"passageConnections",(function(){return o.a})),n.d(t,"passageWithId",(function(){return o.b})),n.d(t,"passageWithName",(function(){return o.c})),n.d(t,"passagesMatchingSearch",(function(){return o.d})),n.d(t,"storyPassageTags",(function(){return o.e})),n.d(t,"storyStats",(function(){return o.f})),n.d(t,"storyTags",(function(){return o.g})),n.d(t,"storyWithId",(function(){return o.h})),n.d(t,"storyWithName",(function(){return o.i}));var s=n(223);n.d(t,"StoriesContextProvider",(function(){return s.a})),n.d(t,"useStoriesContext",(function(){return s.b}));n(199),n(200)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(4),r=n(0),o=n(22),s=n.n(o),c=(n(174),n(2)),i=n(530),l=n(529),u=(n(374),n(1)),d=function(e){var t=e.anchor,n=e.label,o=e.position,s=void 0===o?"top":o,d=r.useState(null),j=Object(a.a)(d,2),b=j[0],f=j[1],p=r.useState(null),m=Object(a.a)(p,2),h=m[0],g=m[1],O=r.useState(!1),v=Object(a.a)(O,2),x=v[0],y=v[1],w=r.useState(),C=Object(a.a)(w,2),S=C[0],A=C[1],k=Object(l.a)(t,b,{modifiers:[{name:"arrow",options:{element:h}},{name:"flip"}],placement:s,strategy:"fixed"}),N=k.styles,E=k.attributes;return r.useEffect((function(){var e=function(){return A(window.setTimeout((function(){return y(!0)}),500))},n=function(){S&&window.clearTimeout(S),y(!1)};if(t)return t.addEventListener("pointerenter",e),t.addEventListener("pointerleave",n),function(){t.removeEventListener("pointerenter",e),t.removeEventListener("pointerleave",n)}}),[t,S]),Object(u.jsx)(i.a,{classNames:"fade-in-out",in:x,mountOnEnter:!0,timeout:200,unmountOnExit:!0,children:Object(u.jsxs)("div",Object(c.a)(Object(c.a)({"aria-hidden":!0,className:"tooltip",ref:f,role:"tooltip",style:N.popper},E.popper),{},{children:[Object(u.jsx)("div",{className:"tooltip-arrow",ref:g,style:N.arrow}),Object(u.jsx)("div",{className:"tooltip-label",children:n})]}))})},j=r.forwardRef((function(e,t){var n=e.disabled,o=e.icon,c=e.iconOnly,i=e.iconPosition,l=void 0===i?"start":i,j=e.onClick,b=e.preventDefault,f=e.selectable,p=void 0!==f&&f,m=e.selected,h=void 0!==m&&m,g=e.tooltipPosition,O=e.variant,v=void 0===O?"secondary":O,x=s()("icon-button","icon-position-".concat(l),{selected:h},"variant-".concat(v),{"icon-only":c}),y=r.useState(null),w=Object(a.a)(y,2),C=w[0],S=w[1];r.useImperativeHandle(t,(function(){return C}));return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("button",{"aria-label":c?e.label:void 0,"aria-pressed":p?h:void 0,disabled:n,className:x,onClick:function(e){j&&j(e),b&&e.preventDefault()},ref:S,children:[Object(u.jsx)("span",{className:"icon",children:o}),!c&&e.label]}),c&&Object(u.jsx)(d,{anchor:C,label:e.label,position:g})]})}))},function(e,t,n){"use strict";var a=n(175);n.d(t,"setPref",(function(){return a.a}));var r=n(63);n.d(t,"defaults",(function(){return r.a}));var o=n(176);n.d(t,"formatEditorExtensionsDisabled",(function(){return o.a}));var s=n(229);n.d(t,"PrefsContextProvider",(function(){return s.a})),n.d(t,"usePrefsContext",(function(){return s.b}));n(201)},,function(e,t,n){"use strict";var a=n(196);n.d(t,"createFromProperties",(function(){return a.a})),n.d(t,"deleteFormat",(function(){return a.b})),n.d(t,"deselectAllFormats",(function(){return a.c})),n.d(t,"deselectFormat",(function(){return a.d})),n.d(t,"loadAllFormatProperties",(function(){return a.e})),n.d(t,"loadFormatProperties",(function(){return a.f})),n.d(t,"selectFormat",(function(){return a.g}));n(82);var r=n(197);n.d(t,"filteredFormats",(function(){return r.a})),n.d(t,"formatImageUrl",(function(){return r.b})),n.d(t,"formatWithId",(function(){return r.c})),n.d(t,"formatWithNameAndVersion",(function(){return r.d})),n.d(t,"newestFormatNamed",(function(){return r.e})),n.d(t,"sortFormats",(function(){return r.f}));var o=n(230);n.d(t,"StoryFormatsContextProvider",(function(){return o.a})),n.d(t,"useStoryFormatsContext",(function(){return o.b}));n(198)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));n(0);var a=n(22),r=n.n(a),o=(n(264),n(1)),s=function(e){var t;return Object(o.jsx)("div",{className:r()("button-bar","orientation-".concat(null!==(t=e.orientation)&&void 0!==t?t:"horizontal")),children:e.children})},c=(n(265),function(){return Object(o.jsx)("div",{className:"button-bar-separator"})})},,function(e,t,n){"use strict";var a=n(231);n.d(t,"AboutTwineDialog",(function(){return a.a}));var r=n(202);n.d(t,"AppDonationDialog",(function(){return r.a}));var o=n(228);n.d(t,"AppPrefsDialog",(function(){return o.a}));var s=n(128);n.d(t,"DialogsContextProvider",(function(){return s.a})),n.d(t,"useDialogsContext",(function(){return s.b}));n(127);var c=n(206);n.o(c,"PassageEditDialog")&&n.d(t,"PassageEditDialog",(function(){return c.PassageEditDialog})),n.o(c,"PassageTagsDialog")&&n.d(t,"PassageTagsDialog",(function(){return c.PassageTagsDialog})),n.o(c,"StoryDetailsDialog")&&n.d(t,"StoryDetailsDialog",(function(){return c.StoryDetailsDialog})),n.o(c,"StoryImportDialog")&&n.d(t,"StoryImportDialog",(function(){return c.StoryImportDialog})),n.o(c,"StoryJavaScriptDialog")&&n.d(t,"StoryJavaScriptDialog",(function(){return c.StoryJavaScriptDialog})),n.o(c,"StorySearchDialog")&&n.d(t,"StorySearchDialog",(function(){return c.StorySearchDialog})),n.o(c,"StoryStylesheetDialog")&&n.d(t,"StoryStylesheetDialog",(function(){return c.StoryStylesheetDialog})),n.o(c,"StoryTagsDialog")&&n.d(t,"StoryTagsDialog",(function(){return c.StoryTagsDialog}));var i=n(224);n.d(t,"PassageEditDialog",(function(){return i.a}));var l=n(207);n.d(t,"PassageTagsDialog",(function(){return l.a}));var u=n(225);n.d(t,"StoryImportDialog",(function(){return u.a}));var d=n(208);n.d(t,"StoryJavaScriptDialog",(function(){return d.a}));var j=n(227);n.d(t,"StoryDetailsDialog",(function(){return j.a}));var b=n(209);n.d(t,"StorySearchDialog",(function(){return b.a}));var f=n(210);n.d(t,"StoryStylesheetDialog",(function(){return f.a}));var p=n(211);n.d(t,"StoryTagsDialog",(function(){return p.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return o}));var a=n(78),r=(n(0),n(267),n(1)),o=function(e){var t=e.children;return Object(r.jsx)("div",{className:"card-content",children:t})};n(268)},,,,,function(e,t,n){"use strict";var a=n(226);n.d(t,"UndoableStoriesContextProvider",(function(){return a.a})),n.d(t,"useUndoableStoriesContext",(function(){return a.b}));n(204)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f}));var a=n(0),r=n(22),o=n.n(r),s=n(55),c=n(5),i=n(18),l=n(8),u=(n(375),n(83)),d=n(43),j=n(1),b=function(e){var t=e.children,n=e.className,r=e.collapsed,b=e.fixedSize,f=e.headerLabel,p=e.highlighted,m=e.maximizable,h=e.maximized,g=e.onChangeCollapsed,O=e.onChangeHighlighted,v=e.onChangeMaximized,x=e.onClose,y=Object(u.a)(),w=y.didCatch,C=y.ErrorBoundary,S=y.error,A=Object(s.a)().t;a.useEffect((function(){S&&console.error(S)}),[S]),a.useEffect((function(){if(p){var e=window.setTimeout((function(){return O(!1)}),400);return function(){return window.clearTimeout(e)}}}),[p,O]);var k=o()("dialog-card",n,{collapsed:r,highlighted:p,"fixed-size":b,maximized:h});return Object(j.jsx)("div",{"aria-label":f,role:"dialog",className:k,onKeyDown:function(e){"Escape"===e.key&&x()},children:Object(j.jsxs)(i.a,{floating:!0,children:[Object(j.jsxs)("h2",{className:"hidden",children:[Object(j.jsx)("div",{className:"dialog-card-header",children:Object(j.jsx)(l.a,{icon:r?Object(j.jsx)(c.n,{}):Object(j.jsx)(c.m,{}),label:f,onClick:function(){return g(!r)}})}),Object(j.jsxs)("div",{className:"dialog-card-header-controls",children:[m&&Object(j.jsx)(l.a,{icon:h?Object(j.jsx)(c.g,{}):Object(j.jsx)(c.f,{}),iconOnly:!0,label:A(h?"common.unmaximize":"common.maximize"),onClick:function(){return v(!h)},tooltipPosition:"bottom"}),Object(j.jsx)(l.a,{icon:Object(j.jsx)(c.V,{}),iconOnly:!0,label:A("common.close"),onClick:x,tooltipPosition:"bottom"})]})]}),w?Object(j.jsx)(d.a,{children:A("components.dialogCard.contentsCrashed")}):Object(j.jsx)(C,{children:!r&&t})]})})},f=(n(376),function(e){return Object(j.jsx)("div",{className:"dialog-editor",children:e.children})})},,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return u}));var a=n(104);function r(e,t){return 180*Math.atan2(t.top-e.top,t.left-e.left)/Math.PI}function o(e,t){return Math.hypot(e.left-t.left,e.top-t.top)}function s(e){return{left:e.left+e.width/2,top:e.top+e.height/2}}function c(e,t){var n={height:0,left:0,top:0,width:0};return e.left<t.left?(n.left=e.left,n.width=t.left-e.left):(n.left=t.left,n.width=e.left-t.left),e.top<t.top?(n.top=e.top,n.height=t.top-e.top):(n.top=t.top,n.height=e.top-t.top),n}function i(e,t){return!(t.left>e.left+e.width||t.left+t.width<e.left||t.top>e.top+e.height||t.top+t.height<e.top)}function l(e,t,n){var r=[NaN,NaN];return Object(a.a)(r,[e.left,e.top],[e.left,e.top+e.height],[t.left,t.top],[n.left,n.top])||Object(a.a)(r,[e.left+e.width,e.top],[e.left+e.width,e.top+e.height],[t.left,t.top],[n.left,n.top])||Object(a.a)(r,[e.left,e.top],[e.left+e.width,e.top],[t.left,t.top],[n.left,n.top])||Object(a.a)(r,[e.left,e.top+e.height],[e.left+e.width,e.top+e.height],[t.left,t.top],[n.left,n.top])?{left:r[0],top:r[1]}:null}function u(e){if(0===e.length)throw new Error("Can't calculate bounding rect for 0 rects");for(var t=e[0].left,n=e[0].left+e[0].width,a=e[0].top,r=e[0].top+e[0].height,o=1;o<e.length;o++){var s=e[o].left+e[o].width,c=e[o].top+e[o].height;e[o].left<t&&(t=e[o].left),e[o].top<a&&(a=e[o].top),s>n&&(n=s),c>r&&(r=c)}return{left:t,top:a,height:r-a,width:n-t}}},,,function(e,t,n){"use strict";var a=n(191);n.o(a,"storyFileName")&&n.d(t,"storyFileName",(function(){return a.storyFileName}));var r=n(192);n.d(t,"storyFileName",(function(){return r.a}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(65),r=function(){return{height:100,highlighted:!1,left:0,name:a.a.t("store.passageDefaults.name"),selected:!1,tags:[],text:"",top:0,width:100,options:[],text_user:""}},o=function(){return{ifid:"",lastUpdate:new Date,passages:[],name:a.a.t("store.storyDefaults.name"),script:"",selected:!1,snapToGrid:!0,startPassage:"",storyFormat:"",storyFormatVersion:"",stylesheet:"",tags:[],tagColors:{},zoom:1}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(20),o=(n(0),n(5)),s=n(8),c=n(1),i=function(e){var t=e.checkedIcon,n=e.icon,i=e.onChange,l=e.uncheckedIcon,u=e.value,d=Object(r.a)(e,["checkedIcon","icon","onChange","uncheckedIcon","value"]),j=u?null!==t&&void 0!==t?t:Object(c.jsx)(o.O,{}):null!==l&&void 0!==l?l:Object(c.jsx)(o.N,{});return Object(c.jsx)("span",{"aria-disabled":d.disabled,className:"checkbox-button",role:"checkbox","aria-checked":u,children:Object(c.jsx)(s.a,Object(a.a)({icon:null!==n&&void 0!==n?n:j,onClick:function(){return i(!u)}},d))})}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i}));var a=["highlighted","selected"],r=["lastUpdate","selected"],o=["loadError","loadState","properties","selected"];function s(e){return Object.keys(e).some((function(e){return!a.includes(e)}))}function c(e){return Object.keys(e).some((function(e){return!r.includes(e)}))}function i(e){return Object.keys(e).some((function(e){return!o.includes(e)}))}},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var a=function(){return-1!==window.navigator.userAgent.indexOf("Electron")}}).call(this,n(153))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return f}));var a=n(5),r=(n(0),n(261),n(1)),o=function(e){var t=e.children;return Object(r.jsxs)("div",{className:"error-message",children:[Object(r.jsx)(a.a,{}),Object(r.jsx)("div",{className:"message",children:t})]})},s=n(83),c=(n(263),function(e){var t=e.children,n=Object(s.a)(),a=n.ErrorBoundary,c=n.didCatch,i=n.error;return c?Object(r.jsx)("div",{className:"global-error-boundary",children:Object(r.jsxs)("div",{children:[Object(r.jsxs)(o,{children:[Object(r.jsx)("p",{children:"Something went wrong and Twine can't continue."}),Object(r.jsx)("p",{children:"Please try restarting Twine or reloading the page."}),Object(r.jsxs)("p",{children:["If you see this message repeatedly, please"," ",Object(r.jsx)("a",{href:"https://twinery.org/2bugs",rel:"noreferrer",target:"_blank",children:"report a bug"}),"."]})]}),Object(r.jsx)("p",{children:"Details:"}),Object(r.jsx)("pre",{children:i.stack})]})}):Object(r.jsx)(a,{children:t})}),i=n(55),l=n(232),u=n.n(l),d=n(15),j=n(18),b=n(69),f=(n(269),function(e){var t=Object(i.a)().t,n=(new u.a).getBrowser();if("Safari"!==n.name)return null;if(n.version){var s=parseInt(n.version.replace(/\..*/,""));if(Number.isFinite(s)&&s<13)return null}var c=window.navigator;if(c.standalone)return null;var l=void 0!==c.standalone;return Object(r.jsx)("div",{className:"safari-warning-card",children:Object(r.jsxs)(j.a,{children:[Object(r.jsxs)(o,{children:[Object(r.jsx)("p",{children:t("components.safariWarningCard.message")}),l&&Object(r.jsx)("p",{children:t("components.safariWarningCard.addToHomeScreen")}),Object(r.jsx)("p",{children:t("components.safariWarningCard.archiveAndUseAnotherBrowser")})]}),Object(r.jsxs)(d.a,{children:[Object(r.jsx)(b.a,{href:"https://twinery.org/2ioslocalstorage",icon:Object(r.jsx)(a.C,{}),label:t("components.safariWarningCard.learnMore"),variant:"primary"}),l&&Object(r.jsx)(b.a,{href:"https://twinery.org/2ioshomescreen",icon:Object(r.jsx)(a.C,{}),label:t("components.safariWarningCard.howToAddToHomeScreen")})]})]})})})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(0);var a=n(22),r=n.n(a),o=(n(379),n(1)),s=function(e){var t=e.children,n=e.onChange,a=e.options,s=e.orientation,c=e.value,i=r()("text-select","orientation-".concat(null!==s&&void 0!==s?s:"horizontal"));return Object(o.jsx)("span",{className:i,children:Object(o.jsxs)("label",{children:[Object(o.jsx)("span",{className:"text-select-label",children:t}),Object(o.jsx)("span",{className:"text-select-control",children:Object(o.jsx)("select",{onChange:n,value:c,children:a.map((function(e){return Object(o.jsx)("option",{disabled:e.disabled,value:e.value,children:e.label},e.value)}))})})]})})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o.a})),n.d(t,"c",(function(){return s}));var a=n(87);function r(e,t){var n;if("loaded"===e.loadState&&(null===(n=e.properties.editorExtensions)||void 0===n?void 0:n.twine)){var r=Object.keys(e.properties.editorExtensions.twine).filter((function(e){return Object(a.satisfies)(t,e)}));if(0!==r.length)return r.length>1&&console.warn("More than one set of editor extensions for ".concat(e.name," ").concat(e.version," is satisfied by ").concat(t,". Using the first.")),e.properties.editorExtensions.twine[r[0]];console.info("".concat(e.name," ").concat(e.version," has editor extensions, but none that ").concat(t," satisfies"))}}var o=n(81);function s(e){return e.name.toLowerCase().replace(/\s/g,"-")+"-"+e.version}},,function(e,t,n){"use strict";function a(){return{name:"Twine",version:"2.5.1"}}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n(4),o=n(20),s=n(0),c=n(529),i=n(530),l=n(18),u=n(8),d=(n(398),n(245)),j=n.n(d),b=n(1),f=function(e){var t=e.ariaLabel,n=e.children,d=(e.focusSelector,e.onChangeOpen),f=e.open,p=Object(o.a)(e,["ariaLabel","children","focusSelector","onChangeOpen","open"]),m=s.useState(null),h=Object(r.a)(m,2),g=h[0],O=h[1],v=s.useState(null),x=Object(r.a)(v,2),y=x[0],w=x[1],C=Object(c.a)(g,y,{strategy:"fixed"}),S=C.styles,A=C.attributes;return Object(b.jsxs)("span",{className:"card-button",children:[Object(b.jsx)(u.a,Object(a.a)(Object(a.a)({onClick:function(){return d(!f)}},p),{},{ref:O})),Object(b.jsx)(i.a,{classNames:"fade-out",in:f,mountOnEnter:!0,timeout:200,unmountOnExit:!0,children:Object(b.jsx)(j.a,{focusTrapOptions:{clickOutsideDeactivates:!0,onDeactivate:function(){return d(!1)}},children:Object(b.jsx)("div",Object(a.a)(Object(a.a)({"aria-label":t,className:"card-button-card",ref:w,role:"dialog",style:S.popper},A.popper),{},{children:Object(b.jsx)(l.a,{floating:!0,children:n})}))})})]})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u}));var a=n(36),r=n.n(a),o=n(65);function s(){var e=(new Date).toLocaleString().replace(/[/:\\]/g,".");return o.a.t("store.archiveFilename",{timestamp:e})}function c(e,t){return e.reduce((function(e,n){return e+l(n,t,{startOptional:!0})+"\n\n"}),"")}function i(e,t){return'<tw-passagedata pid="'.concat(r()(t.toString()),'" ')+'name="'.concat(r()(e.name),'" ')+'tags="'.concat(r()(e.tags.join(" ")),'" ')+'position="'.concat(e.left,",").concat(e.top,'" ')+'size="'.concat(e.width,",").concat(e.height,'">')+"".concat(r()(e.text),"</tw-passagedata>")}function l(e,t){var n,a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=o.formatOptions,c=o.startId,l=o.startOptional;if(c=null!==(n=c)&&void 0!==n?n:e.startPassage,!l){if(!c)throw new Error("There is no starting point set for this story and none was set manually.");if(!e.passages.find((function(e){return e.id===c})))throw new Error("The passage set as starting point for this story does not exist.")}var u="";e.passages.forEach((function(e,t){u+=i(e,t+1),e.id===c&&(a=t+1)}));var d=Object.keys(e.tagColors).reduce((function(t,n){return t+'<tw-tag name="'.concat(r()(n),'" color="').concat(r()(e.tagColors[n]),'"></tw-tag>')}),"");return'<tw-storydata name="'.concat(r()(e.name),'" ')+'startnode="'.concat(a||"",'" ')+'creator="'.concat(r()(t.name),'" ')+'creator-version="'.concat(r()(t.version),'" ')+'format="'.concat(r()(e.storyFormat),'" ')+'format-version="'.concat(r()(e.storyFormatVersion),'" ')+'ifid="'.concat(r()(e.ifid),'" ')+'options="'.concat(r()(s),'" ')+'tags="'.concat(r()(e.tags.join(" ")),'" ')+'zoom="'.concat(r()(e.zoom.toString()),'" hidden>')+'<style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">'+e.stylesheet+'</style><script role="script" id="twine-user-script" type="text/twine-javascript">'+e.script+"<\/script>"+d+u+"</tw-storydata>"}function u(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=a.formatOptions,s=a.startId;if(!t)throw new Error("Story format source cannot be empty.");var c=t;return c=(c=c.replace(/{{STORY_NAME}}/g,(function(){return r()(e.name)}))).replace(/{{STORY_DATA}}/g,(function(){return l(e,n,{formatOptions:o,startId:s})}))}},,,,function(e,t,n){"use strict";function a(e){return e.length>0&&!/\s/.test(e)}n.d(t,"a",(function(){return a}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),r=n(7),o=n.n(r),s=n(12),c=n(4),i=n(20),l=n(0),u=n(55),d=n(5),j=n(15),b=n(18),f=n(48),p=n(8),m=n(72),h=n(1),g=function(e){var t=e.cancelIcon,n=e.cancelLabel,r=e.onChange,g=e.onSubmit,O=e.prompt,v=e.submitIcon,x=e.submitLabel,y=e.submitVariant,w=e.validate,C=e.value,S=Object(i.a)(e,["cancelIcon","cancelLabel","onChange","onSubmit","prompt","submitIcon","submitLabel","submitVariant","validate","value"]),A=l.useRef(!0),k=l.useState(!1),N=Object(c.a)(k,2),E=N[0],F=N[1],I=l.useState(),P=Object(c.a)(I,2),D=P[0],T=P[1],L=Object(u.a)().t;return l.useEffect((function(){function e(){return(e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=7;break}return e.next=3,w(C);case 3:t=e.sent,A.current&&T(t),e.next=8;break;case 7:A.current&&T({valid:!0});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[w,C]),l.useEffect((function(){return function(){A.current=!1}}),[]),Object(h.jsx)("span",{className:"prompt-button",children:Object(h.jsx)(f.a,Object(a.a)(Object(a.a)({ariaLabel:O,onChangeOpen:F,open:E},S),{},{children:Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(null===D||void 0===D?void 0:D.valid)&&(g(C),F(!1))},children:[Object(h.jsxs)(b.b,{children:[Object(h.jsx)(m.a,{onChange:r,orientation:"vertical",value:C,children:O}),(null===D||void 0===D?void 0:D.message)&&Object(h.jsx)("p",{children:D.message})]}),Object(h.jsxs)(j.a,{children:[Object(h.jsx)(p.a,{buttonType:"submit",disabled:!(null===D||void 0===D?void 0:D.valid),icon:null!==v&&void 0!==v?v:Object(h.jsx)(d.l,{}),label:null!==x&&void 0!==x?x:L("common.ok"),variant:null!==y&&void 0!==y?y:"primary"}),Object(h.jsx)(p.a,{buttonType:"button",icon:null!==t&&void 0!==t?t:Object(h.jsx)(d.V,{}),label:null!==n&&void 0!==n?n:L("common.cancel"),onClick:function(e){e.preventDefault(),F(!1)}})]})]})}))})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(2),r=n(4),o=n(20),s=n(0),c=n(529),i=n(530),l=n(15),u=n(78),d=(n(396),n(1)),j=function(e){return Object(d.jsx)("div",{className:"button-card",children:Object(d.jsx)(u.a,Object(a.a)({},e))})},b=n(73),f=n(8),p=(n(397),n(35)),m=n(5),h=function(e){var t=e.items,n=Object(o.a)(e,["items"]),u=s.useState(null),h=Object(r.a)(u,2),g=h[0],O=h[1],v=s.useState(null),x=Object(r.a)(v,2),y=x[0],w=x[1],C=s.useState(!1),S=Object(r.a)(C,2),A=S[0],k=S[1],N=Object(c.a)(g,y,{strategy:"fixed"}),E=N.styles,F=N.attributes;return s.useEffect((function(){var e=function(){return k(!1)};return A&&document.addEventListener("click",e),function(){return document.removeEventListener("click",e)}}),[y,A,k]),Object(d.jsxs)("span",{className:"menu-button",children:[Object(d.jsx)(f.a,Object(a.a)(Object(a.a)({},n),{},{onClick:function(){return k((function(e){return!e}))},ref:O})),Object(d.jsx)(i.a,{classNames:"fade-out",in:A,mountOnEnter:!0,timeout:200,unmountOnExit:!0,children:Object(d.jsx)("div",Object(a.a)(Object(a.a)({className:"menu-button-menu",ref:w,style:E.popper},F.popper),{},{children:Object(d.jsx)(j,{floating:!0,children:Object(d.jsx)(l.a,{orientation:"vertical",children:t.map((function(e,t){return e.separator?Object(d.jsx)(l.b,{},t):"checkable"in e?Object(d.jsx)(p.a,{checkedIcon:Object(d.jsx)(m.l,{}),disabled:e.disabled,label:e.label,onChange:e.onClick,uncheckedIcon:Object(d.jsx)(b.a,{}),value:e.checked},t):Object(d.jsx)(f.a,{disabled:e.disabled,icon:Object(d.jsx)(b.a,{}),label:e.label,onClick:e.onClick,variant:e.variant},t)}))})})}))})]})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(132),r=n.n(a),o=function(e){return!/^\w+:\/\/\/?\w/i.test(e)},s=function(e){return""!==e},c=function(e){var t=l(e,"][",0);return null!==t&&void 0!==t?t:e},i=function(e){return e.substr(2,e.length-4)},l=function(e,t,n){var a=e.split(t);if(1!==a.length)return n<0?a[a.length+n]:a[n]},u=function(e){return l(e,"->",-1)||l(e,"<-",0)||l(e,"|",-1)||e};function d(e,t){var n=r()(function(e){return e.match(/\[\[.*?\]\]/g)||[]}(e).map(i).map(c).map(u).filter(s));return t&&(n=n.filter(o)),n}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(){return{appTheme:"system",codeEditorFontFamily:"var(--font-monospaced)",codeEditorFontScale:1,dialogWidth:600,disabledStoryFormatEditorExtensions:[],donateShown:!1,editorCursorBlinks:!0,firstRunTime:(new Date).getTime(),lastUpdateSeen:"",lastUpdateCheckTime:(new Date).getTime(),locale:window.navigator.userLanguage||window.navigator.language||window.navigator.browserLanguage||window.navigator.systemLanguage||"en-us",passageEditorFontFamily:"var(--font-system)",passageEditorFontScale:1,proofingFormat:{name:"Paperthin",version:"1.0.0"},storyFormat:{name:"Harlowe",version:"3.3.3"},storyFormatListFilter:"current",storyListSort:"name",storyListTagFilter:[],storyTagColors:{},welcomeSeen:!1}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),r=n(20),o=(n(0),n(244)),s=(n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(22)),c=n.n(s),i=n(37),l=n(41),u=n.n(l),d=[];function j(e,t){var n=t.prefixes,a=t.callback;function r(e){if(!e.state.completionActive&&n&&a){var t=e.findWordAt(e.getDoc().getCursor());t.anchor.ch--;var r,o=e.findWordAt(t.anchor),s=e.getRange(o.anchor,o.head),c=Object(i.a)(n);try{for(c.s();!(r=c.n()).done;){if(s===r.value)return void a(e)}}catch(l){c.e(l)}finally{c.f()}}}a&&n&&!d.includes(e)?(d.push(e),e.on("inputRead",r)):d.includes(e)&&(e.off("inputRead",r),d=d.filter((function(t){return t!==e})))}var b=!1;var f=n(1);b||(u.a.defineOption("prefixTrigger",[],j),b=!0);var p=function(e){var t=e.fontFamily,n=e.fontScale,s=e.label,i=Object(r.a)(e,["fontFamily","fontScale","label"]),l={};return t&&(l.fontFamily=t.includes(" ")?'"'.concat(t,'"'):t),n&&(l.fontSize="".concat(100*n,"%")),Object(f.jsx)("div",{className:"code-area",style:l,children:Object(f.jsxs)("label",{children:[Object(f.jsx)("span",{className:c()("label",{"screen-reader-only":e.labelHidden}),children:s}),Object(f.jsx)(o.Controlled,Object(a.a)({},i))]})})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(253),r=n(237),o=n(93),s=a.a.createInstance();s.use(r.a).use(o.e).init({debug:!1,backend:{loadPath:"".concat(".","/locales/{{lng}}.json")},fallbackLng:"en-us",interpolation:{escapeValue:!1},load:"currentOnly"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return Z}));var a=n(0),r=n(7),o=n.n(r),s=n(12),c=n(63);function i(){return l.apply(this,arguments)}function l(){return(l=Object(s.a)(o.a.mark((function e(){var t,n,a,r,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window,n=t.twineElectron,a={},r=Object.keys(Object(c.a)()),n){e.next=5;break}throw new Error("Electron bridge is not present on window.");case 5:return e.next=7,null===n||void 0===n?void 0:n.ipcRenderer.invoke("load-prefs");case 7:if((s=e.sent)&&"object"===typeof s)for(i in s)r.includes(i)&&(a[i]=s[i]);return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e,t){var n=window.twineElectron;if(!n)throw new Error("Electron bridge is not present on window.");n.ipcRenderer.send("save-json",e,t)}function d(e,t){"repair"!==t.type&&"update"!==t.type||u("prefs.json",e)}var j=n(13),b=n(130);function f(){return p.apply(this,arguments)}function p(){return(p=Object(s.a)(o.a.mark((function e(){var t,n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window,n=t.twineElectron){e.next=3;break}throw new Error("Electron bridge is not present on window.");case 3:return e.next=5,null===n||void 0===n?void 0:n.ipcRenderer.invoke("load-stories");case 5:if(!(a=e.sent)||!Array.isArray(a)){e.next=10;break}return e.abrupt("return",a.reduce((function(e,t){var n=Object(b.a)(t.htmlSource,t.mtime);return n[0]?[].concat(Object(j.a)(e),[n[0]]):(console.warn("Could not hydrate story: ",t.htmlSource),e)}),[]));case 10:console.warn("No stories to hydrate in Electron bridge");case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m,h=n(3),g=n(40),O=n(49),v=n(11),x=n(47),y=n(81);function w(e,t){return C.apply(this,arguments)}function C(){return(C=Object(s.a)(o.a.mark((function e(t,n){var a,r,s,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=window,r=a.twineElectron){e.next=3;break}throw new Error("Electron bridge is not present on window.");case 3:if(e.prev=3,"loaded"!==(s=Object(v.formatWithNameAndVersion)(n,t.storyFormat,t.storyFormatVersion)).loadState){e.next=9;break}r.ipcRenderer.send("save-story-html",t,Object(O.d)(t,s.properties.source,Object(x.a)(),{startOptional:!0})),e.next=14;break;case 9:return e.next=11,Object(y.a)(s.url);case 11:c=e.sent,i=c.source,r.ipcRenderer.send("save-story-html",t,Object(O.d)(t,i,Object(x.a)(),{startOptional:!0}));case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),console.warn("Could not save full story (".concat(e.t0.message,"). Trying to save story data only.")),r.ipcRenderer.send("save-story-html",t,Object(O.c)(t,Object(x.a)(),{startOptional:!0}));case 20:case"end":return e.stop()}}),e,null,[[3,16]])})))).apply(this,arguments)}function S(e,t,n){var a=window.twineElectron;if(!a)throw new Error("Electron bridge is not present on window.");switch(t.type){case"init":case"repair":break;case"createStory":if(!t.props.name)throw new Error("Passage was created but with no name specified");w(Object(h.storyWithName)(e,t.props.name),n);break;case"deleteStory":a.ipcRenderer.send("delete-story",Object(h.storyWithId)(m,t.storyId));break;case"updateStory":if(Object(g.b)(t.props))if(t.props.name){var r=Object(h.storyWithId)(m,t.storyId),o=Object(h.storyWithId)(e,t.storyId);a.ipcRenderer.once("story-renamed",(function(){return w(o,n)})),a.ipcRenderer.send("rename-story",r,o)}else w(Object(h.storyWithId)(e,t.storyId),n);break;case"createPassage":case"createPassages":case"deletePassage":case"deletePassages":w(Object(h.storyWithId)(e,t.storyId),n);break;case"updatePassage":Object(g.a)(t.props)&&w(Object(h.storyWithId)(e,t.storyId),n);break;case"updatePassages":Object.keys(t.passageUpdates).some((function(e){return Object(g.a)(t.passageUpdates[e])}))&&w(Object(h.storyWithId)(e,t.storyId),n);break;default:console.warn("Story action ".concat(t.type," has no Electron persistence handler"))}m=Object(j.a)(e)}var A=n(21),k=n.n(A);function N(){return E.apply(this,arguments)}function E(){return(E=Object(s.a)(o.a.mark((function e(){var t,n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window,n=t.twineElectron){e.next=3;break}throw new Error("Electron bridge is not present on window.");case 3:return e.next=5,null===n||void 0===n?void 0:n.ipcRenderer.invoke("load-story-formats");case 5:if((a=e.sent)&&Array.isArray(a)){e.next=8;break}return e.abrupt("return",[]);case 8:return e.abrupt("return",a.map((function(e){return{id:k()(),loadState:"unloaded",name:e.name,selected:!1,version:e.version,url:e.url,userAdded:e.userAdded}})));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t){("create"===t.type||"delete"===t.type||"repair"===t.type||"update"===t.type&&Object(g.c)(t.props))&&u("story-formats.json",e.map((function(e){return{id:e.id,name:e.name,selected:void 0,version:e.version,url:e.url,userAdded:e.userAdded}})))}function I(){return P.apply(this,arguments)}function P(){return(P=Object(s.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.localStorage.getItem("twine-prefs"),n={},t){e.next=4;break}return e.abrupt("return",{});case 4:return t.split(",").forEach((function(e){try{var t=window.localStorage.getItem("twine-prefs-".concat(e));if(!t)return void console.warn("No preference stored at twine-prefs-".concat(e));var a=JSON.parse(t);n[a.name]=a.value}catch(r){console.warn("Preference ".concat(e," had corrupt serialized value, skipping"),window.localStorage.getItem("twine-prefs-".concat(e)),r)}})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t){"repair"!==t.type&&"update"!==t.type||function(e){var t=window.localStorage.getItem("twine-prefs");t&&t.split(",").forEach((function(e){window.localStorage.removeItem("twine-prefs-".concat(e))}));var n=[];for(var a in e){var r=k()();n.push(r),window.localStorage.setItem("twine-prefs-".concat(r),JSON.stringify({id:r,name:a,value:e[a]}))}window.localStorage.setItem("twine-prefs",n.join(","))}(e)}var T,L=n(2),M=n(34);function B(){return z.apply(this,arguments)}function z(){return(z=Object(s.a)(o.a.mark((function e(){var t,n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},n=window.localStorage.getItem("twine-stories")){e.next=4;break}return e.abrupt("return",[]);case 4:return n.split(",").forEach((function(e){var n=window.localStorage.getItem("twine-stories-".concat(e));if(n)try{var a=JSON.parse(n);if(!a.id)return void console.warn("Story in local storage had no ID, skipping",a);t[a.id]=Object(L.a)(Object(L.a)(Object(L.a)({},Object(M.b)()),a),{},{lastUpdate:a.lastUpdate?new Date(Date.parse(a.lastUpdate)):new Date,passages:[]})}catch(r){console.warn("Could not parse story as JSON, skipping: ".concat(n))}else console.warn("Story list contained ID ".concat(e,", but twine-stories-").concat(e," does not exist, skipping"))})),(a=window.localStorage.getItem("twine-passages"))&&a.split(",").forEach((function(e){var n=window.localStorage.getItem("twine-passages-".concat(e));if(n)try{var a=JSON.parse(n);if(!a||!a.story)return void console.warn("Passage ".concat(e," did not have parent story ID, skipping"),a);if(!t[a.story])return void console.warn("Passage ".concat(e," is orphaned (looking for story ID ").concat(a.story,"), skipping"));t[a.story].passages.push(Object(L.a)(Object(L.a)(Object(L.a)({},M.a),a),{},{tags:a.tags?a.tags.filter((function(e){return""!==e.trim()})):[]}))}catch(r){console.warn("Could not parse passage as JSON, skipping: ".concat(n))}else console.warn("Passage list contained ID ".concat(e,", but twine-passages-").concat(e," does not exist, skipping"))})),e.abrupt("return",Object.values(t));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t){return""===e?t:function(e,t){return new RegExp("\\b"+t+"\\b").test(e)}(e,t)?e:e+","+t}function U(e,t){return","===(e=e.replace(new RegExp(",?"+t),""))[0]?e.substring(1):e}function V(e){var t,n,a={passageIds:null!==(t=window.localStorage.getItem("twine-passages"))&&void 0!==t?t:"",storyIds:null!==(n=window.localStorage.getItem("twine-stories"))&&void 0!==n?n:""};e(a),window.localStorage.setItem("twine-stories",a.storyIds),window.localStorage.setItem("twine-passages",a.passageIds)}function X(e,t){if(!t.id)throw new Error("Story has no ID");e.storyIds=R(e.storyIds,t.id),window.localStorage.setItem("twine-stories-".concat(t.id),JSON.stringify(Object(L.a)(Object(L.a)({},t),{},{passages:void 0})))}function H(e,t){if(!t.id)throw new Error("Passage has no ID");e.passageIds=R(e.passageIds,t.id),window.localStorage.setItem("twine-passages-".concat(t.id),JSON.stringify(t))}function W(e,t){e.passageIds=U(e.passageIds,t),window.localStorage.removeItem("twine-passages-".concat(t))}function Q(e,t){switch(t.type){case"init":case"repair":break;case"createPassage":if(!t.props.name)throw new Error("Passage was created but with no name specified");var n=Object(h.storyWithId)(e,t.storyId),a=Object(h.passageWithName)(e,n.id,t.props.name);V((function(e){X(e,n),H(e,a)}));break;case"createPassages":var r=Object(h.storyWithId)(e,t.storyId);V((function(n){X(n,r),t.props.forEach((function(t){if(!t.name)throw new Error("Passage was created but with no name specified");H(n,Object(h.passageWithName)(e,r.id,t.name))}))}));break;case"createStory":if(!t.props.name)throw new Error("Story was created but with no name specified");var o=Object(h.storyWithName)(e,t.props.name);V((function(e){X(e,o),o.passages.forEach((function(t){return H(e,t)}))}));break;case"deletePassage":var s=Object(h.storyWithId)(e,t.storyId);V((function(e){X(e,s),W(e,t.passageId)}));break;case"deletePassages":var c=Object(h.storyWithId)(e,t.storyId);V((function(e){X(e,c),t.passageIds.forEach((function(t){return W(e,t)}))}));break;case"deleteStory":var i=Object(h.storyWithId)(T,t.storyId);V((function(e){i.passages.forEach((function(t){return W(e,t.id)})),function(e,t){if(!t.id)throw new Error("Story has no ID");e.storyIds=U(e.storyIds,t.id),window.localStorage.removeItem("twine-stories-".concat(t.id))}(e,i)}));break;case"updatePassage":if(Object(g.a)(t.props)){var l=Object(h.storyWithId)(e,t.storyId),u=Object(h.passageWithId)(e,t.storyId,t.passageId);V((function(e){X(e,l),H(e,u)}));break}break;case"updatePassages":var d=Object(h.storyWithId)(e,t.storyId);V((function(n){X(n,d),Object.keys(t.passageUpdates).filter((function(e){return Object(g.a)(t.passageUpdates[e])})).forEach((function(a){return H(n,Object(h.passageWithId)(e,t.storyId,a))}))}));break;case"updateStory":var j=Object(h.storyWithId)(e,t.storyId);V((function(e){X(e,j),j.passages.forEach((function(t){return H(e,t)}))}));break;default:console.warn("Story action ".concat(t.type," has no local storage persistence handler"))}T=e}function q(){return K.apply(this,arguments)}function K(){return(K=Object(s.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],n=window.localStorage.getItem("twine-storyformats")){e.next=4;break}return e.abrupt("return",[]);case 4:return n.split(",").forEach((function(e){try{var n=window.localStorage.getItem("twine-storyformats-".concat(e));if(!n)return void console.warn("No story format stored at twine-storyformats-".concat(e,", skipping"));t.push(Object(L.a)(Object(L.a)({},JSON.parse(n)),{},{loadState:"unloaded"}))}catch(a){console.warn("Story format ".concat(e," had corrupt serialized value, skipping"),window.localStorage.getItem("twine-storyformats-".concat(e)))}})),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){var t=window.localStorage.getItem("twine-storyformats");t&&t.split(",").forEach((function(e){window.localStorage.removeItem("twine-storyformats-".concat(e))}));var n=[];e.forEach((function(e){var t=k()();n.push(t),window.localStorage.setItem("twine-storyformats-".concat(t),JSON.stringify(Object(L.a)(Object(L.a)({},e),{},{loadError:void 0,loadState:void 0,properties:void 0,selected:void 0})))})),window.localStorage.setItem("twine-storyformats",n.join(","))}function G(e,t){switch(t.type){case"create":case"delete":case"repair":Y(e);break;case"update":Object(g.c)(t.props)&&Y(e)}}var J=n(42);function Z(){var e=a.useMemo((function(){return{prefs:{load:i,saveMiddleware:d},stories:{load:f,saveMiddleware:S},storyFormats:{load:N,saveMiddleware:F}}}),[]),t=a.useMemo((function(){return{prefs:{load:I,saveMiddleware:D},stories:{load:B,saveMiddleware:Q},storyFormats:{load:q,saveMiddleware:G}}}),[]);return a.useMemo((function(){return Object(J.a)()?e:t}),[e,t])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return x}));var a=n(13),r=n(4),o=n(0),s=n(55),c=n(91),i=n(5),l=n(15),u=n(18),d=n(48),j=n(8),b=n(72),f=n(44),p=n(53),m=(n(399),n(1)),h=function(e){var t=e.assignedTags,n=e.disabled,h=e.existingTags,g=e.icon,O=e.label,v=e.onAdd,x=o.useState(!0),y=Object(r.a)(x,2),w=y[0],C=y[1],S=o.useState("none"),A=Object(r.a)(S,2),k=A[0],N=A[1],E=o.useState(""),F=Object(r.a)(E,2),I=F[0],P=F[1],D=o.useState(!1),T=Object(r.a)(D,2),L=T[0],M=T[1],B=Object(s.a)().t,z=void 0,R=Object(p.a)(I);return R||""===I||(z=B("components.addTagButton.invalidName")),R&&w&&((R=!h.includes(I))||(z=B("components.addTagButton.alreadyAdded"))),Object(m.jsx)("span",{className:"add-tag-button",children:Object(m.jsxs)(d.a,{ariaLabel:B("components.addTagButton.addLabel"),disabled:n,icon:null!==g&&void 0!==g?g:Object(m.jsx)(i.G,{}),label:null!==O&&void 0!==O?O:B("common.tag"),onChangeOpen:M,open:L,children:[Object(m.jsxs)(u.b,{children:[Object(m.jsx)(f.a,{onChange:function(e){var t=e.target.value;P(t),C(""===t)},options:[{label:B("components.addTagButton.newTag"),value:""}].concat(Object(a.a)(h.map((function(e){return{disabled:t.includes(e),label:e,value:e}})))),value:w?"":I,children:B("components.addTagButton.addLabel")}),w&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(b.a,{onChange:function(e){return P(e.target.value.replace(/\s/g,"-"))},value:I,children:B("components.addTagButton.tagNameLabel")}),Object(m.jsx)(f.a,{onChange:function(e){return N(e.target.value)},options:c.a.map((function(e){return{label:B("colors.".concat(e)),value:e}})),value:k,children:B("components.addTagButton.tagColorLabel")})]}),w&&!!z&&Object(m.jsx)("p",{children:z})]}),Object(m.jsxs)(l.a,{children:[Object(m.jsx)(j.a,{disabled:!R,icon:Object(m.jsx)(i.G,{}),label:B("common.add"),onClick:function(){w?v(I,k):v(I),M(!1)},variant:"create"}),Object(m.jsx)(j.a,{icon:Object(m.jsx)(i.V,{}),label:B("common.cancel"),onClick:function(){return M(!1)}})]})]})})},g=n(22),O=n.n(g),v=n(58),x=(n(400),function(e){var t=Object(s.a)().t;return Object(m.jsx)("span",{className:O()("tag-button","color-".concat(e.color)),children:Object(m.jsx)(v.a,{icon:Object(m.jsx)(i.m,{}),iconPosition:"end",items:[].concat(Object(a.a)(c.a.map((function(n){return{checkable:!0,checked:"none"===n?!e.color:n===e.color,label:t("colors.".concat(n)),onClick:function(){return e.onChangeColor(n)}}}))),[{separator:!0},{label:t("common.remove"),onClick:e.onRemove}]),label:e.name})})});n(126)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(0);var a=n(22),r=n.n(a),o=(n(174),n(1)),s=function(e){var t=e.href,n=e.icon,a=e.label,s=e.target,c=e.variant,i=r()("icon-link","variant-".concat(c));return Object(o.jsxs)("a",{href:t,className:i,target:null!==s&&void 0!==s?s:"_blank",children:[Object(o.jsx)("span",{className:"icon",children:n}),a]})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u}));var a=n(0),r=n(55),o=n(5),s=n(8),c=n(1),i=function(e){var t=e.editor,n=Object(r.a)().t;function a(e){null===t||void 0===t||t.execCommand(e),null===t||void 0===t||t.focus()}return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(s.a,{disabled:!t,icon:Object(c.jsx)(o.B,{}),label:n("components.indentButtons.indent"),onClick:function(){return a("indentMore")}}),Object(c.jsx)(s.a,{disabled:!t,icon:Object(c.jsx)(o.A,{}),label:n("components.indentButtons.unindent"),onClick:function(){return a("indentLess")}})]})},l=n(4),u=function(e){var t=e.editor,n=e.watch,i=Object(r.a)().t,u=a.useState(!1),d=Object(l.a)(u,2),j=d[0],b=d[1],f=a.useState(!1),p=Object(l.a)(f,2),m=p[0],h=p[1];function g(e){null===t||void 0===t||t.execCommand(e),null===t||void 0===t||t.focus()}return a.useEffect((function(){if(t){var e=t.historySize();b(e.redo>0),h(e.undo>0)}else b(!1),h(!1)}),[t,n]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(s.a,{disabled:!m,icon:Object(c.jsx)(o.c,{}),label:i("common.undo"),onClick:function(){return g("undo")}}),Object(c.jsx)(s.a,{disabled:!j,icon:Object(c.jsx)(o.d,{}),label:i("common.redo"),onClick:function(){return g("redo")}})]})}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(22),r=n.n(a),o=(n(0),n(378),n(1)),s=function(e){var t,n=r()("text-input","orientation-".concat(e.orientation),"type-".concat(e.type));return Object(o.jsx)("span",{className:n,children:Object(o.jsxs)("label",{children:[Object(o.jsx)("span",{className:"text-input-label",children:e.children}),Object(o.jsx)("input",{onChange:e.onChange,onInput:e.onInput,placeholder:e.placeholder,type:null!==(t=e.type)&&void 0!==t?t:"text",value:e.value})]})})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));n(0);var a=n(1),r=function(){return Object(a.jsx)("svg",{viewBox:"0 0 24 24",width:"24",height:"24",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})},o=n(5),s=(n(275),function(){return Object(a.jsx)("span",{className:"icon-loading",children:Object(a.jsx)(o.o,{})})})},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(0);var a=n(22),r=n.n(a),o=(n(266),n(1)),s=function(e){var t=e.children,n=e.floating,a=e.highlighted,s=r()("card",{floating:n,highlighted:a});return Object(o.jsx)("div",{className:s,children:t})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return m}));var a=n(13),r=n(132),o=n.n(r),s=n(101),c=n(59);function i(e,t,n){var a=p(e,t).passages.find((function(e){return e.id===n}));if(a)return a;throw new Error('There is no passage with ID "'.concat(n,'" in a story with ID "').concat(t,'".'))}function l(e,t,n){var a=p(e,t).passages.find((function(e){return e.name===n}));if(a)return a;throw new Error('There is no passage with name "'.concat(n,'" in a story with ID "').concat(t,'".'))}function u(e,t){var n=null!==t&&void 0!==t?t:function(e){return Object(c.a)(e,!0)},a=new Map(e.map((function(e){return[e.name,e]}))),r={draggable:{broken:new Set,connections:new Map,self:new Set},fixed:{broken:new Set,connections:new Map,self:new Set}};return e.forEach((function(e){return n(e.text).forEach((function(t){if(t===e.name)(e.selected?r.draggable:r.fixed).self.add(e);else{var n=a.get(t);if(n){var o=e.selected||n.selected?r.draggable:r.fixed;o.connections.has(e)?o.connections.get(e).add(n):o.connections.set(e,new Set([n]))}else(e.selected?r.draggable:r.fixed).broken.add(e)}}))})),r}function d(e,t,n){if(""===t)return[];var r,o=n.includePassageNames,c=n.matchCase,i=n.useRegexes;try{r=Object(s.a)(t,{matchCase:c,useRegexes:i})}catch(l){return[]}return e.reduce((function(e,t){return r.test(t.text)||o&&r.test(t.name)?[].concat(Object(a.a)(e),[t]):e}),[])}function j(e){return Array.from(e.passages.reduce((function(e,t){return t.tags&&t.tags.forEach((function(t){return e.add(t)})),e}),new Set)).sort()}function b(e){var t=e.passages.reduce((function(e,t){return[].concat(Object(a.a)(e),Object(a.a)(Object(c.a)(t.text).filter((function(t){return-1===e.indexOf(t)}))))}),[]);return{brokenLinks:o()(t).filter((function(t){return!e.passages.some((function(e){return e.name===t}))})),links:t,characters:e.passages.reduce((function(e,t){return e+t.text.length}),0),passages:e.passages.length,words:e.passages.reduce((function(e,t){return e+t.text.split(/\s+/).length}),0)}}function f(e){return Array.from(e.reduce((function(e,t){return t.tags&&t.tags.forEach((function(t){return e.add(t)})),e}),new Set)).sort()}function p(e,t){var n=e.find((function(e){return e.id===t}));if(n)return n;throw new Error('There is no story with ID "'.concat(t,'".'))}function m(e,t){var n=e.find((function(e){return e.name===t}));if(n)return n;throw new Error('There is no story with name "'.concat(t,'".'))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(7),r=n.n(a),o=n(12),s=n(239),c=n.n(s),i=n(42),l=Promise.resolve();function u(e){return d.apply(this,arguments)}function d(){return d=Object(o.a)(r.a.mark((function e(t){var n,a,o,s,u=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:2e3,a=window,o=a.twineElectron,s=Object(i.a)()&&(null===o||void 0===o?void 0:o.jsonp)?o.jsonp:c.a,e.abrupt("return",new Promise((function(e,a){return l=l.then((function(){return new Promise((function(r){s(t,{timeout:n,name:"storyFormat"},(function(t,n){t?a(t):e(n),r()}))}))}))})));case 4:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(){return[{name:"Chapbook",url:"story-formats/chapbook-1.2.2/format.js",version:"1.2.2"},{name:"Harlowe",url:"story-formats/harlowe-1.2.4/format.js",version:"1.2.4"},{name:"Harlowe",url:"story-formats/harlowe-2.1.0/format.js",version:"2.1.0"},{name:"Harlowe",url:"story-formats/harlowe-3.3.3/format.js",version:"3.3.3"},{name:"Paperthin",url:"story-formats/paperthin-1.0.0/format.js",version:"1.0.0"},{name:"Snowman",url:"story-formats/snowman-1.4.0/format.js",version:"1.4.0"},{name:"Snowman",url:"story-formats/snowman-2.0.2/format.js",version:"2.0.2",userAdded:!1},{name:"SugarCube",url:"story-formats/sugarcube-1.0.35/format.js",version:"1.0.35"},{name:"SugarCube",url:"story-formats/sugarcube-2.36.1/format.js",version:"2.36.1"}]}},,,function(e,t,n){"use strict";function a(e,t){if(t.includes(e)){for(var n=1;t.includes("".concat(e," ").concat(n));)n++;return"".concat(e," ").concat(n)}return e}n.d(t,"a",(function(){return a}))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(55),r=n(42);function o(){var e=Object(a.a)("",{useSuspense:!1}),t=e.t,n=e.ready;return{reportError:function(e,a){console.error("Twine store error",e),n?window.alert(t(a,{error:e.message})+" "+t("store.errors.".concat(Object(r.a)()?"electron":"web","Remediation"))):window.alert("An error occurred while saving (".concat(e.message,"). Reloading or restarting the application may help."))}}}},function(e){e.exports=JSON.parse('{"a":"2.5.1"}')},function(e,t,n){"use strict";function a(e){var t={extraKeys:{Insert:function(){}}};return e.editorCursorBlinks||(t.cursorBlinkRate=0),t}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=["none","red","orange","yellow","green","blue","purple"]},,,,,,,,function(e,t,n){},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(133),r=n.n(a);function o(e,t){return new RegExp(t.useRegexes?e:r()(e),t.matchCase?"g":"gi")}function s(e){return e.replace(/\$/g,"$$$$")}},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0),r=(n(401),n(1)),o=a.memo((function(e){return Object(r.jsx)("div",{className:"tag-stripe",children:e.tags.map((function(t){return Object(r.jsx)("span",{className:"color-".concat(e.tagColors[t]),title:t},t)}))})}));o.displayName="TagStripe"},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var a,r,o=n(2),s=n(4),c=n(0),i=n(243),l=n(530),u=n(535),d=n(128),j=n(9),b=n(3),f=n(23),p=(n(385),n(24)),m=n(25),h=n(31),g=n(30),O=(n(205),n(1)),v=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(e){return Object(p.a)(this,n),t.call(this,e)}return Object(m.a)(n,[{key:"render",value:function(){return Object(O.jsx)("div",{className:"options-making__container",children:Object(O.jsxs)("form",{action:"",method:"post",onSubmit:function(e){e.preventDefault(),this.props.onCreate(e.target.option_title.value,e.target.status1.value,e.target.amount_change1.value,e.target.status2.value,e.target.amount_change2.value,e.target.after_story.value)}.bind(this),children:[Object(O.jsx)("input",{className:"option-mini-title",name:"option_title",placeholder:"\uc120\ud0dd\uc9c0 \ucd9c\ub825 \ub0b4\uc6a9",required:!0}),Object(O.jsx)("div",{className:"mini-line"}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("select",{className:"select-dropdown",name:"status1",required:!0,children:[Object(O.jsx)("option",{value:"",children:"(\ub2a5\ub825)"}),Object(O.jsx)("option",{value:"health",children:"\uccb4\ub825"}),Object(O.jsx)("option",{value:"money",children:"\ub3c8"}),Object(O.jsx)("option",{value:"satiety",children:"\ud3ec\ub9cc\uac10"}),Object(O.jsx)("option",{value:"strength",children:"\ud798"}),Object(O.jsx)("option",{value:"agility",children:"\ubbfc\ucca9"}),Object(O.jsx)("option",{value:"armor",children:"\ub0b4\uad6c\ub3c4"}),Object(O.jsx)("option",{value:"mental",children:"\uc815\uc2e0\ub825"})]}),Object(O.jsxs)("select",{className:"select-dropdown",name:"amount_change1",required:!0,children:[Object(O.jsx)("option",{value:"",children:"(\ubcc0\ud654\ub7c9)"}),Object(O.jsx)("option",{value:"1",children:"+1"}),Object(O.jsx)("option",{value:"0",children:"0"}),Object(O.jsx)("option",{value:"-1",children:"-1"})]})]}),Object(O.jsx)("div",{className:"mini-line"}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("select",{className:"select-dropdown",name:"status2",required:!0,children:[Object(O.jsx)("option",{value:"",children:"(\ub2a5\ub8252)"}),Object(O.jsx)("option",{value:"null",children:"(\uc5c6\uc74c)"}),Object(O.jsx)("option",{value:"health",children:"\uccb4\ub825"}),Object(O.jsx)("option",{value:"money",children:"\ub3c8"}),Object(O.jsx)("option",{value:"satiety",children:"\ud3ec\ub9cc\uac10"}),Object(O.jsx)("option",{value:"strength",children:"\ud798"}),Object(O.jsx)("option",{value:"agility",children:"\ubbfc\ucca9"}),Object(O.jsx)("option",{value:"armor",children:"\ub0b4\uad6c\ub3c4"}),Object(O.jsx)("option",{value:"mental",children:"\uc815\uc2e0\ub825"})]}),Object(O.jsxs)("select",{className:"select-dropdown",name:"amount_change2",required:!0,children:[Object(O.jsx)("option",{value:"0",children:"0"}),Object(O.jsx)("option",{value:"1",children:"+1"}),Object(O.jsx)("option",{value:"-1",children:"-1"})]})]}),Object(O.jsx)("div",{className:"mini-line"}),Object(O.jsx)("textarea",{placeholder:"\ud50c\ub808\uc774\uc5b4\uac00 \uc120\ud0dd\uc9c0 \uc120\ud0dd \ud6c4\uc5d0 \ub4f1\uc7a5\ud558\ub294 \uacb0\uacfc \uc774\uc57c\uae30",className:"option-mini-textarea",name:"after_story",id:"",cols:30,rows:10,required:!0}),Object(O.jsx)("input",{className:"option-submit-btn",type:"submit",value:"\uc0dd\uc131\ud558\uae30"})]})})}}]),n}(c.Component),x=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).max_option_num=void 0,a.max_option_num=0,a.state={mode:"default",options_id:[],options_title:[],options_status1:[],options_amount_change1:[],options_status2:[],options_amount_change2:[],options_after_story:[],selected_modify_optionNum:0},a}return Object(m.a)(n,[{key:"render",value:function(){for(var e,t=this,n=[],a=function(e){if("optionModify"===t.state.mode&&t.state.selected_modify_optionNum===e)n.push(Object(O.jsxs)("div",{id:e.toString(),className:"option-list-div option-list-div-onmodify",children:[Object(O.jsxs)("div",{className:"info-icon-onmodify",children:["\uc120\ud0dd\uc9c0",e+1]}),Object(O.jsx)("div",{className:"options-making__container",children:Object(O.jsxs)("form",{action:"",method:"post",id:e.toString(),onSubmit:function(e){e.preventDefault(),this.setState({mode:"default"})}.bind(t),children:[Object(O.jsx)("input",{className:"option-mini-title",value:t.state.options_title[e],onChange:function(t){var n=this.state.options_title.map((function(n,a){return e===a?t.target.value:n}));this.setState({options_title:n}),this.props.onTrackingOption(n)}.bind(t),required:!0}),Object(O.jsx)("div",{className:"mini-line"}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("select",{className:"select-dropdown",name:"status1",required:!0,onChange:function(e){var t=this.state.options_status1.map((function(e,t){return e}));this.setState({options_status1:t})}.bind(t),children:[Object(O.jsx)("option",{value:"",children:"(\ub2a5\ub825)"}),Object(O.jsx)("option",{value:"health",children:"\uccb4\ub825"}),Object(O.jsx)("option",{value:"money",children:"\ub3c8"}),Object(O.jsx)("option",{value:"satiety",children:"\ud3ec\ub9cc\uac10"}),Object(O.jsx)("option",{value:"strength",children:"\ud798"}),Object(O.jsx)("option",{value:"agility",children:"\ubbfc\ucca9"}),Object(O.jsx)("option",{value:"armor",children:"\ub0b4\uad6c\ub3c4"}),Object(O.jsx)("option",{value:"mental",children:"\uc815\uc2e0\ub825"})]}),Object(O.jsxs)("select",{className:"select-dropdown",name:"amount_change1",required:!0,onChange:function(t){var n=this.state.options_amount_change1.map((function(n,a){return e===a?t.target.value:n}));this.setState({options_amount_change1:n})}.bind(t),children:[Object(O.jsx)("option",{value:"",children:"(\ubcc0\ud654\ub7c9)"}),Object(O.jsx)("option",{value:"1",children:"+1"}),Object(O.jsx)("option",{value:"0",children:"0"}),Object(O.jsx)("option",{value:"-1",children:"-1"})]})]}),Object(O.jsx)("div",{className:"mini-line"}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("select",{className:"select-dropdown",name:"status2",required:!0,onChange:function(t){var n=this.state.options_status2.map((function(n,a){return e===a?t.target.value:n}));this.setState({options_status2:n})}.bind(t),children:[Object(O.jsx)("option",{value:"",children:"(\ub2a5\ub8252)"}),Object(O.jsx)("option",{value:"null",children:"\uc5c6\uc74c"}),Object(O.jsx)("option",{value:"health",children:"\uccb4\ub825"}),Object(O.jsx)("option",{value:"money",children:"\ub3c8"}),Object(O.jsx)("option",{value:"satiety",children:"\ud3ec\ub9cc\uac10"}),Object(O.jsx)("option",{value:"strength",children:"\ud798"}),Object(O.jsx)("option",{value:"agility",children:"\ubbfc\ucca9"}),Object(O.jsx)("option",{value:"armor",children:"\ub0b4\uad6c\ub3c4"}),Object(O.jsx)("option",{value:"mental",children:"\uc815\uc2e0\ub825"})]}),Object(O.jsxs)("select",{className:"select-dropdown",name:"amount_change2",required:!0,onChange:function(t){var n=this.state.options_amount_change2.map((function(n,a){return e===a?t.target.value:n}));this.setState({options_amount_change2:n})}.bind(t),children:[Object(O.jsx)("option",{value:"0",children:"0"}),Object(O.jsx)("option",{value:"1",children:"+1"}),Object(O.jsx)("option",{value:"-1",children:"-1"})]})]}),Object(O.jsx)("div",{className:"mini-line"}),Object(O.jsx)("textarea",{className:"option-mini-textarea",value:t.state.options_after_story[e],onChange:function(t){var n=this.state.options_after_story.map((function(n,a){return e===a?t.target.value:n}));this.setState({options_after_story:n})}.bind(t),required:!0}),Object(O.jsx)("input",{className:"option-submit-btn",value:"\ud655\uc778",type:"submit"})]},e)})]},e));else{var a,r;switch(t.state.options_status1[e]){case"null":a="\ubcc0\ud654\uc5c6\uc74c";break;case"health":a="\uccb4\ub825";break;case"money":a="\ub3c8";break;case"satiety":a="\ud3ec\ub9cc\uac10";break;case"strength":a="\ud798";break;case"agility":a="\uc18d\ub3c4";break;case"armor":a="\ub0b4\uad6c\ub3c4";break;case"mental":a="\uc815\uc2e0\ub825";break;default:a="\uc5c6\uc74c"}switch(t.state.options_status2[e]){case"null":default:r="\uc5c6\uc74c";break;case"health":r="\uccb4\ub825";break;case"money":r="\ub3c8";break;case"satiety":r="\ud3ec\ub9cc\uac10";break;case"strength":r="\ud798";break;case"agility":r="\uc18d\ub3c4";break;case"armor":r="\ub0b4\uad6c\ub3c4";break;case"mental":r="\uc815\uc2e0\ub825"}n.push(Object(O.jsxs)("div",{id:e.toString(),className:"option-list-div",children:[Object(O.jsxs)("div",{className:"info-icon",children:["\uc120\ud0dd\uc9c0",e+1]}),Object(O.jsxs)("div",{className:"option-info-container",children:[Object(O.jsx)("div",{className:"option-info-title",children:t.state.options_title[e]}),Object(O.jsxs)("div",{className:"option-info-main",children:[Object(O.jsx)("span",{children:a}),Object(O.jsx)("span",{children:t.state.options_amount_change1[e]}),Object(O.jsx)("span",{}),Object(O.jsx)("span",{children:r}),Object(O.jsx)("span",{children:t.state.options_amount_change2[e]}),Object(O.jsx)("span",{}),Object(O.jsxs)("span",{className:"after-story-preview-btn",children:[Object(O.jsx)("span",{children:"\uc5d0\ud544\ub85c\uadf8"}),Object(O.jsx)("div",{children:t.state.options_after_story[e]})]})]})]}),Object(O.jsx)("button",{className:"option-list-m-btn",onClick:function(e){e.preventDefault(),this.setState({mode:"optionModify"}),this.setState({selected_modify_optionNum:parseInt(e.target.parentNode.id)})}.bind(t),children:"\uc218\uc815"}),Object(O.jsx)("button",{className:"option-list-d-btn",onClick:function(e){if(window.confirm("\uc120\ud0dd\uc9c0\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){var t=parseInt(e.target.parentNode.id);console.log(t);var n=Array.from(this.state.options_title),a=Array.from(this.state.options_status1),r=Array.from(this.state.options_amount_change1),o=Array.from(this.state.options_status2),s=Array.from(this.state.options_amount_change2),c=Array.from(this.state.options_after_story);n.splice(t,1),a.splice(t,1),r.splice(t,1),o.splice(t,1),s.splice(t,1),c.splice(t,1),console.log(n),this.max_option_num=this.max_option_num-1,this.setState({options_title:n,options_status1:a,options_amount_change1:r,options_status2:o,options_amount_change2:s,options_after_story:c}),this.props.onTrackingOption(n)}}.bind(t),children:"\uc0ad\uc81c"})]},e))}},r=0;r<this.max_option_num;r++)a(r);return"optionCreate"===this.state.mode?this.max_option_num>4?(this.setState({mode:"default"}),alert("\uc120\ud0dd\uc9c0\ub294 \ucd5c\ub300 5\uac1c\uae4c\uc9c0 \ub9cc\ub4e4 \uc218 \uc788\uc2b5\ub2c8\ub2e4.")):e=Object(O.jsx)(v,{onCreate:function(e,t,n,a,r,o){this.max_option_num=this.max_option_num+1;var s=this.state.options_title.concat(e),c=this.state.options_status1.concat(t),i=this.state.options_amount_change1.concat(n),l=this.state.options_status2.concat(a),u=this.state.options_amount_change2.concat(r),d=this.state.options_after_story.concat(o);this.setState({options_title:s,options_status1:c,options_amount_change1:i,options_status2:l,options_amount_change2:u,options_after_story:d,mode:"default"}),this.props.onTrackingOption(s)}.bind(this)}):e="",Object(O.jsxs)("div",{className:"option-ui__container",children:[Object(O.jsx)("div",{className:"options-show__container",children:n}),Object(O.jsxs)("div",{className:"add-option-btn-container",children:[e,Object(O.jsx)("a",{className:"add-option-btn",href:"/",onClick:function(e){e.preventDefault(),"optionCreate"===this.state.mode?window.confirm("\uc791\uc131 \uc911\uc778 \uc120\ud0dd\uc9c0 \uc815\ubcf4\uac00 \uc0ac\ub77c\uc9d1\ub2c8\ub2e4.\n\uc815\ub9d0 \uc120\ud0dd\uc9c0 \uc0dd\uc131 \ucc3d\uc744 \ub2eb\uc73c\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&this.setState({mode:"default"}):this.setState({mode:"optionCreate"})}.bind(this),children:"+ \uc120\ud0dd\uc9c0 \ucd94\uac00\ud558\uae30"})]})]})}}]),n}(c.Component),y=(n(386),function(e){var t=Object(c.useState)(e.passage.name),n=Object(s.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(e.passage.text),i=Object(s.a)(o,2),l=i[0],u=i[1],d=Object(c.useState)([]),j=Object(s.a)(d,2),p=j[0],m=j[1],h=Object(f.useUndoableStoriesContext)(),g=h.dispatch,v=(h.stories,/\[\[.*\]\]/g);Object(c.useEffect)((function(){console.log(l.match(v))}),[]),Object(c.useEffect)((function(){r(e.passage.name),u(e.passage.text)}),[e.passage.name,e.passage.text]);var y="";return Object(O.jsx)("div",{className:"making-all-container",children:Object(O.jsxs)("div",{className:"making-window",children:[Object(O.jsxs)("div",{className:"making-window-header",children:[Object(O.jsx)("div",{className:"title-info-icon info-icon",children:"\uc81c\ubaa9"}),Object(O.jsx)("input",{value:a,onChange:function(e){r(e.target.value)}})]}),Object(O.jsxs)("div",{className:"making-window-main",children:[Object(O.jsx)("div",{className:"main-info-icon info-icon",children:"\ubcf8\ubb38"}),Object(O.jsx)("textarea",{value:l,name:"",id:"",cols:30,rows:10,onChange:function(e){u(e.target.value)}})]}),Object(O.jsx)(x,{onTrackingOption:function(e){var t=e.concat();m(t)}}),Object(O.jsx)("div",{className:"save-btn-container",children:Object(O.jsx)("button",{onClick:function(t){var n;!function(){y=l;for(var e=0;e<p.length;e++)y=y+"\n[["+p[e]+"]]"}(),n=a,g(Object(b.updatePassage)(e.story,e.passage,{name:n},{dontUpdateOthers:!0})),e.onWrite(y)},children:"\uc791\uc131\uc644\ub8cc"})})]})})}),w=function(e){var t=Object(c.useState)(),n=Object(s.a)(t,2),i=n[0],u=n[1];return Object(O.jsxs)("div",{children:[Object(O.jsx)(y,{passage:r,story:a,onWrite:function(e){u(e)}}),Object(O.jsx)(l.a,Object(o.a)(Object(o.a)({classNames:"hidden pop",timeout:200},e),{},{userDialogText:i,children:e.children}))]})},C=function(e){var t=Object(i.useScrollbarSize)(),n=t.height,l=t.width,p=(Object(j.usePrefsContext)().prefs,Object(d.b)()),m=p.dispatch,h=p.dialogs,g=Object(c.useState)(),v=Object(s.a)(g,2),x=(v[0],v[1],{paddingLeft:"calc(100% - (850px + 2 * (var(--grid-size))))",marginBottom:n,marginRight:l}),y={marginRight:h.some((function(e){return!e.maximized}))?"calc(850px + var(--grid-size))":0},C=Object(f.useUndoableStoriesContext)().stories;return Object(O.jsx)("div",{className:"dialogs",style:x,children:Object(O.jsx)(u.a,{component:null,children:h.map((function(e,t){r=Object(b.passageWithId)(C,h[0].props.storyId,h[0].props.passageId),a=Object(b.storyWithId)(C,h[0].props.storyId);var n={collapsed:e.collapsed,highlighted:e.highlighted,maximized:e.maximized,onChangeCollapsed:function(e){return m({type:"setDialogCollapsed",collapsed:e,index:t})},onChangeHighlighted:function(e){return m({type:"setDialogHighlighted",highlighted:e,index:t})},onChangeMaximized:function(e){return m({type:"setDialogMaximized",maximized:e,index:t})},onClose:function(){return m({type:"removeDialog",index:t})}};return Object(O.jsx)(w,{children:e.maximized?Object(O.jsx)("div",{className:"maximized ",style:y,children:Object(O.jsx)(e.component,Object(o.a)(Object(o.a)({},e.props),n))}):Object(O.jsx)(e.component,Object(o.a)(Object(o.a)({},e.props),n))},t)}))})})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return b}));var a=n(4),r=n(0),o=n(86),s=n.n(o),c=n(2),i=function(e,t){switch(t.type){case"addDialog":return[{collapsed:!1,component:t.component,highlighted:!1,maximized:!1,props:t.props}];case"removeDialog":return e.filter((function(e,n){return n!==t.index}));case"setDialogCollapsed":e.map((function(e,n){return n===t.index?Object(c.a)(Object(c.a)({},e),{},{collapsed:t.collapsed}):e}));return e.map((function(e,n){return n===t.index?Object(c.a)(Object(c.a)({},e),{},{collapsed:t.collapsed}):e}));case"setDialogHighlighted":return e.map((function(e,n){return n===t.index?Object(c.a)(Object(c.a)({},e),{},{highlighted:t.highlighted}):e}));case"setDialogMaximized":return e.map((function(e,n){return Object(c.a)(Object(c.a)({},e),{},{maximized:n===t.index&&t.maximized})}))}},l=n(127),u=n(1),d=r.createContext({dispatch:function(){},dialogs:[]});d.displayName="Dialogs";var j=function(){return r.useContext(d)},b=function(e){var t=s()(i,[]),n=Object(a.a)(t,2),r=n[0],o=n[1];return Object(u.jsxs)(d.Provider,{value:{dispatch:o,dialogs:r},children:[e.children,Object(u.jsx)(l.a,{})]})}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(14),r=n(2),o=n(168),s=n.n(o),c=n(21),i=n.n(c),l=n(3),u="[role=script]",d="[role=stylesheet]",j="tw-storydata",b="tw-tag",f="tw-passagedata";function p(e){return parseFloat(e)}function m(e,t){return Array.from(e.querySelectorAll(t))}function h(e){if("string"===typeof e){var t=e.split(",");return 2===t.length?[t[0],t[1]]:void 0}}function g(e,t){var n=document.createElement("div");return n.innerHTML=e,m(n,j).map((function(e){var n=function(e){var t,n,o,s,c,l=e.getAttribute("startnode"),j=void 0,g={ifid:null!==(t=e.getAttribute("ifid"))&&void 0!==t?t:i()(),id:i()(),lastUpdate:void 0,name:null!==(n=e.getAttribute("name"))&&void 0!==n?n:void 0,storyFormat:null!==(o=e.getAttribute("format"))&&void 0!==o?o:void 0,storyFormatVersion:null!==(s=e.getAttribute("format-version"))&&void 0!==s?s:void 0,script:m(e,u).map((function(e){return e.textContent})).join("\n"),stylesheet:m(e,d).map((function(e){return e.textContent})).join("\n"),tags:e.getAttribute("tags")?e.getAttribute("tags").split(/\s+/):[],zoom:parseFloat(null!==(c=e.getAttribute("zoom"))&&void 0!==c?c:"1"),tagColors:m(e,b).reduce((function(e,t){var n=t.getAttribute("name");return"string"!==typeof n?e:Object(r.a)(Object(r.a)({},e),{},Object(a.a)({},n,t.getAttribute("color")))}),{}),passages:m(e,f).map((function(e){var t,n,a=i()(),r=h(e.getAttribute("position")),o=h(e.getAttribute("size"));return e.getAttribute("pid")===l&&(j=a),{id:a,left:r?p(r[0]):void 0,top:r?p(r[1]):void 0,width:o?p(o[0]):void 0,height:o?p(o[1]):void 0,tags:e.getAttribute("tags")?e.getAttribute("tags").split(/\s+/):[],name:null!==(t=e.getAttribute("name"))&&void 0!==t?t:void 0,text:null!==(n=e.textContent)&&void 0!==n?n:void 0}}))};return g.startPassage=j,g}(e),o=s()(n,{id:i()()},Object(l.storyDefaults)());return t&&(o.lastUpdate=t),o.passages=o.passages.map((function(e){return s()(e,Object(l.passageDefaults)(),{story:o.id})})),o}))}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),r=n(4),o=n(0),s=n(55),c=n(5),i=n(57),l=n(8),u=n(1),d=function(){var e=Object(s.a)().t;return Object(u.jsx)(l.a,{disabled:!0,icon:Object(u.jsx)(c.U,{}),label:e("common.rename")})},j=function(e){var t=e.onRename,n=e.passage,a=e.story,l=o.useState(n.name),d=Object(r.a)(l,2),j=d[0],b=d[1],f=Object(s.a)().t;return Object(u.jsx)(i.a,{icon:Object(u.jsx)(c.U,{}),label:f("common.rename"),onChange:function(e){return b(e.target.value)},onSubmit:t,prompt:f("common.renamePrompt",{name:n.name}),validate:function(e){return""===e.trim()?{message:f("components.renamePassageButton.emptyName"),valid:!1}:a.passages.some((function(t){return t.id!==n.id&&t.name===e}))?{message:f("components.renamePassageButton.nameAlreadyUsed"),valid:!1}:{valid:!0}},value:j})},b=function(e){return e.passage?Object(u.jsx)(j,Object(a.a)({},e)):Object(u.jsx)(d,{})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),r=n(0),o=n(9);function s(){var e=Object(o.usePrefsContext)().prefs,t=r.useState(window.matchMedia("(prefers-color-scheme: dark)")),n=Object(a.a)(t,1)[0],s=r.useState(n.matches?"dark":"light"),c=Object(a.a)(s,2),i=c[0],l=c[1];return r.useEffect((function(){var e=function(e){return l(e.matches?"dark":"light")};return n.addEventListener("change",e),function(){return n.removeEventListener("change",e)}}),[n]),"system"===e.appTheme?i:e.appTheme}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(4),r=n(0),o=n(55),s=n(22),c=n.n(s),i=n(5),l=n(91),u=n(57),d=n(44),j=(n(403),n(1)),b=function(e){var t=e.allTags,n=e.color,s=e.name,b=e.onChangeColor,f=e.onChangeName,p=r.useState(s),m=Object(a.a)(p,2),h=m[0],g=m[1],O=Object(o.a)().t;return Object(j.jsxs)("div",{className:"tag-editor",children:[Object(j.jsx)("span",{className:c()("tag-name","color-".concat(e.color)),children:e.name}),Object(j.jsx)(u.a,{icon:Object(j.jsx)(i.U,{}),label:O("common.rename"),onChange:function(e){return g(e.target.value.replace(/\s/g,"-"))},onSubmit:function(){return f(h)},prompt:O("common.renamePrompt",{name:s}),value:h,validate:function(e){return e!==s&&t.includes(e)?{message:O("components.tagEditor.alreadyExists"),valid:!1}:{valid:!0}}}),Object(j.jsx)(d.a,{onChange:function(e){return b(e.target.value)},options:l.a.map((function(e){return{label:O("colors.".concat(e)),value:e}})),value:null!==n&&void 0!==n?n:"",children:O("common.color")})]})}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(13),r=n(4),o=n(0),s=(n(408),n(1)),c=function(e){var t=e.children,n=e.domId,a=e.percent;return Object(s.jsxs)("div",{className:"meter",id:n,role:"meter","aria-labelledby":"".concat(n,"-label"),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":100*a,children:[Object(s.jsx)("div",{className:"meter-bar",children:Object(s.jsx)("span",{className:"filled",style:{width:100*a+"%"}})}),Object(s.jsx)("div",{className:"meter-label",id:"".concat(n,"-label"),children:t})]})},i=n(11),l=function(e){var t=e.block,n=e.children,l=o.useState([]),u=Object(r.a)(l,2),d=u[0],j=u[1],b=Object(i.useStoryFormatsContext)(),f=b.dispatch,p=b.formats;o.useEffect((function(){var e=p.filter((function(e){return!d.find((function(t){return t.name===e.name&&t.version===e.version}))}));e.length>0&&(f(Object(i.loadAllFormatProperties)(e)),j([].concat(Object(a.a)(d),Object(a.a)(e))))}),[f,p,d]);var m=p.find((function(e){return"loading"===e.loadState})),h=p.filter((function(e){return"loaded"===e.loadState})).length/p.length;return t&&h<1?Object(s.jsx)(c,{domId:"story-format-loader",percent:h,children:m&&Object(s.jsxs)(s.Fragment,{children:["Loading ",m.name," ",m.version]})}):Object(s.jsx)(s.Fragment,{children:n})}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e){e.exports=JSON.parse('{"code":["Chris Klimas","Leon Arnott","Ingrid Cheung","Daithi O Crualaoich","Thomas Michael Edwards","Micah Fitch","Juhana Leinonen","Michael Savich","Ross Smith"],"localizations":["David Marchand (Castellano)","Jordi Mallach (catal\xe0)","Svatopluk V\xedt (\u010ce\u0161tina)","Kristian Torgard (Dansk)","Julian Brehmer, Moritz Rebbert (Deutsch)","Valentin Rocher (Fran\xe7ais)","Marco Secchi (Italiano)","Stefan Peeters (Nederlands)","Jos\xe9 Carlos Dias (Portugu\xeas)","Alliah (Portugu\xeas Brasileiro)","Anton Zhuchkov (\u0420\u0443\u0441\u0441\u043a\u0438\u0439)","Mika Letonsaari (Suomi)","D\xe9sir\xe9e Nordlund (Svenska)","H. Utku Maden (T\xfcrk\xe7e)","Shitake & SEN1 (Chinese)"]}')},,,,,function(e,t,n){},function(e,t,n){"use strict";function a(e,t){return{type:"update",name:e,value:t}}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";function a(e,t,n){return e.disabledStoryFormatEditorExtensions.some((function(e){return e.name===t&&e.version===n}))}n.d(t,"a",(function(){return a}))},,,,,,,,,,,,,,,function(e,t){},function(e,t,n){"use strict";function a(e){return e.name.replace(/[^\w. -]/g,"_")+".html"}n.d(t,"a",(function(){return a}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return h}));var a=n(2),r=n(7),o=n.n(r),s=n(12),c=n(37),i=n(81);function l(e,t){if(!t.name||!t.version)throw new Error("Missing required properties for a new story format");return{type:"create",props:{url:e,name:t.name,selected:!1,userAdded:!0,version:t.version}}}function u(e){return{type:"delete",id:e.id}}function d(){return function(e,t){var n,a=Object(c.a)(t());try{for(a.s();!(n=a.n()).done;){var r=n.value;r.selected&&e({type:"update",id:r.id,props:{selected:!1}})}}catch(o){a.e(o)}finally{a.f()}}}function j(e){return{type:"update",id:e.id,props:{selected:!1}}}function b(e,t){return f.apply(this,arguments)}function f(){return(f=Object(s.a)(o.a.mark((function e(t,n){var r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"update",id:t.id,props:{loadState:"loading"}}),e.prev=1,e.next=4,Object(i.a)(t.url);case 4:if((r=e.sent).hydrate)try{s={},new Function(r.hydrate).call(s),r=Object(a.a)(Object(a.a)({},s),r)}catch(o){console.error("Format ".concat(t.id," has a hydrate property but it threw an error when called"),o)}return n({type:"update",id:t.id,props:{properties:r,loadState:"loaded"}}),e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(1),n({type:"update",id:t.id,props:{loadError:e.t0,loadState:"error"}});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function p(e){var t=e.filter((function(e){return"loaded"!==e.loadState&&"loading"!==e.loadState}));return t?function(){var e=Object(s.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled(t.map((function(e){return b(e,n)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}():function(){}}function m(e){return"loaded"===e.loadState?function(){return e.properties}:function(){var t=Object(s.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function h(e,t){return function(n,a){if(e.selected||n({type:"update",id:e.id,props:{selected:!0}}),t){var r,o=Object(c.a)(a());try{for(o.s();!(r=o.n()).done;){var s=r.value;s.id!==e.id&&s.selected&&n({type:"update",id:s.id,props:{selected:!1}})}}catch(i){o.e(i)}finally{o.f()}}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return p}));var a=n(14),r=n(2),o=n(240),s=n.n(o),c=n(80),i=n.n(c),l=n(87);function u(e,t){switch(t){case"all":return e;case"current":return Object.values(e.reduce((function(e,t){return!e[t.name]||i()(e[t.name].version,t.version)?Object(r.a)(Object(r.a)({},e),{},Object(a.a)({},t.name,t)):e}),{}));case"user":return e.filter((function(e){return e.userAdded}))}}function d(e){if("loaded"!==e.loadState||!e.properties.image)throw new Error("Format has no image property");return s()(e.properties.image)?e.properties.image:e.url.replace(/\/[^/]*?$/,"/")+e.properties.image}function j(e,t){var n=e.find((function(e){return e.id===t}));if(n)return n;throw new Error('There is no story format with ID "'.concat(t,'".'))}function b(e,t,n){var a=e.find((function(e){return e.name===t&&e.version===n}));if(a)return a;throw new Error('There is no story format with name "'.concat(t,'" and version "').concat(n,'".'))}function f(e,t){return e.reduce((function(e,n){return n.name!==t?e:!e||Object(l.gt)(n.version,e.version)?n:e}),void 0)}function p(e){return e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:e.version===t.version?0:i()(t.version,e.version)?-1:1}))}},function(e,t){},function(e,t){},function(e,t,n){"use strict"},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n(5),o=n(0),s=n(55),c=n(15),i=n(18),l=n(27),u=n(8),d=n(69),j=n(9),b=n(1),f=function(e){var t=Object(j.usePrefsContext)().dispatch,n=Object(s.a)().t;return o.useEffect((function(){return t(Object(j.setPref)("donateShown",!0))}),[t]),Object(b.jsxs)(l.a,Object(a.a)(Object(a.a)({},e),{},{className:"app-donation-dialog",fixedSize:!0,headerLabel:n("dialogs.appDonation.title"),children:[Object(b.jsx)(i.b,{children:Object(b.jsxs)("div",{className:"text",children:[Object(b.jsx)("p",{children:n("dialogs.appDonation.supportMessage")}),Object(b.jsx)("p",{children:n("dialogs.appDonation.onlyOnce")})]})}),Object(b.jsxs)(c.a,{children:[Object(b.jsx)(d.a,{href:"https://twinery.org/donate",icon:Object(b.jsx)(r.y,{}),label:n("dialogs.appDonation.donate"),variant:"primary"}),Object(b.jsx)(u.a,{icon:Object(b.jsx)(r.V,{}),label:n("dialogs.appDonation.noThanks"),onClick:e.onClose})]})]}))}},,function(e,t){},function(e,t,n){},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(2),r=n(20),o=(n(0),n(55)),s=n(27),c=n(18),i=n(3),l=n(23),u=n(138),d=n(1),j=function(e){var t=e.storyId,n=Object(r.a)(e,["storyId"]),j=Object(l.useUndoableStoriesContext)(),b=j.dispatch,f=j.stories,p=Object(o.a)().t,m=Object(i.storyWithId)(f,t),h=Object(i.storyPassageTags)(m);return Object(d.jsx)(s.a,Object(a.a)(Object(a.a)({className:"passage-tags-dialog",fixedSize:!0,headerLabel:p("dialogs.passageTags.title")},n),{},{children:Object(d.jsx)(c.b,{children:h.length>0?h.map((function(e){return Object(d.jsx)(u.a,{allTags:h,color:m.tagColors[e],name:e,onChangeColor:function(t){return function(e,t){b(Object(i.setTagColor)(m,e,t),p("undoChange.changeTagColor"))}(e,t)},onChangeName:function(t){return function(e,t){b(Object(i.renamePassageTag)(m,e,t),p("undoChange.renameTag"))}(e,t)}},e)})):Object(d.jsx)("p",{children:p("dialogs.passageTags.noTags")})})}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),r=n(4),o=n(20),s=n(0),c=n(55),i=n(70),l=n(15),u=n(27),d=n(64),j=n(9),b=n(3),f=n(90),p=(n(407),n(1)),m=function(e){var t=e.storyId,n=Object(o.a)(e,["storyId"]),m=s.useState(),h=Object(r.a)(m,2),g=h[0],O=h[1],v=Object(b.useStoriesContext)(),x=v.dispatch,y=v.stories,w=Object(j.usePrefsContext)().prefs,C=Object(b.storyWithId)(y,t),S=Object(c.a)().t;return Object(p.jsxs)(u.a,Object(a.a)(Object(a.a)({},n),{},{className:"story-javascript-dialog",headerLabel:S("dialogs.storyJavaScript.title"),maximizable:!0,children:[Object(p.jsxs)(l.a,{children:[Object(p.jsx)(i.b,{editor:g,watch:C.script}),Object(p.jsx)(i.a,{editor:g})]}),Object(p.jsx)(u.b,{children:Object(p.jsx)(d.a,{editorDidMount:O,fontFamily:w.codeEditorFontFamily,fontScale:w.codeEditorFontScale,label:S("dialogs.storyJavaScript.editorLabel"),labelHidden:!0,onBeforeChange:function(e,t,n){O(e),x(Object(b.updateStory)(y,C,{script:n}))},options:Object(a.a)(Object(a.a)({},Object(f.a)(w)),{},{autofocus:!0,lineWrapping:!0,mode:"javascript",placeholder:S("dialogs.storyJavaScript.explanation")}),value:C.script})})]}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(14),r=n(2),o=n(4),s=n(20),c=n(135),i=n(0),l=n(55),u=n(5),d=n(27),j=n(35),b=n(64),f=n(8),p=n(3),m=n(23),h=(n(410),n(1)),g={Tab:!1,"Shift-Tab":!1},O=function(e){var t,n,O,v=e.storyId,x=Object(s.a)(e,["storyId"]),y=i.useState({includePassageNames:!0,matchCase:!1,useRegexes:!1}),w=Object(o.a)(y,2),C=w[0],S=w[1],A=i.useState(""),k=Object(o.a)(A,2),N=k[0],E=k[1],F=i.useState(""),I=Object(o.a)(F,2),P=I[0],D=I[1],T=Object(m.useUndoableStoriesContext)(),L=T.dispatch,M=T.stories,B=i.useMemo((function(){return Object(c.debounce)(L,250)}),[L]),z=Object(l.a)().t,R=Object(p.storyWithId)(M,v),U=Object(p.passagesMatchingSearch)(R.passages,P,C);function V(e){S((function(t){return Object(r.a)(Object(r.a)({},t),{},Object(a.a)({},e,!t[e]))}))}return i.useEffect((function(){return B(Object(p.highlightPassagesMatchingSearch)(R,P,C)),function(){return B(Object(p.highlightPassagesMatchingSearch)(R,"",{}))}}),[B,P,C,R]),Object(h.jsxs)(d.a,Object(r.a)(Object(r.a)({},x),{},{className:"story-search-dialog",fixedSize:!0,headerLabel:z("dialogs.storySearch.title"),children:[Object(h.jsxs)("div",{className:"search-fields",children:[Object(h.jsx)(b.a,{label:z("dialogs.storySearch.find"),onBeforeChange:function(e,t,n){D(n)},options:{extraKeys:g,mode:"text"},value:P}),Object(h.jsx)(b.a,{label:z("dialogs.storySearch.replaceWith"),onBeforeChange:function(e,t,n){E(n)},options:{extraKeys:g,mode:"text"},value:N})]}),Object(h.jsxs)("div",{className:"search-flags",children:[Object(h.jsx)(j.a,{label:z("dialogs.storySearch.includePassageNames"),onChange:function(){return V("includePassageNames")},value:null!==(t=C.includePassageNames)&&void 0!==t&&t}),Object(h.jsx)(j.a,{label:z("dialogs.storySearch.matchCase"),onChange:function(){return V("matchCase")},value:null!==(n=C.matchCase)&&void 0!==n&&n}),Object(h.jsx)(j.a,{label:z("dialogs.storySearch.useRegexes"),onChange:function(){return V("useRegexes")},value:null!==(O=C.useRegexes)&&void 0!==O&&O})]}),Object(h.jsxs)("div",{className:"search-results",children:[Object(h.jsx)(f.a,{disabled:0===U.length,icon:Object(h.jsx)(u.I,{}),label:z("dialogs.storySearch.replaceAll"),onClick:function(){L(Object(p.replaceInStory)(R,P,N,C),"undoChange.replaceAllText")},variant:"danger"}),Object(h.jsx)("span",{children:P&&(U.length>0?z("dialogs.storySearch.matchCount",{count:U.length}):z("dialogs.storySearch.noMatches"))})]})]}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),r=n(4),o=n(20),s=n(0),c=n(55),i=n(70),l=n(15),u=n(27),d=n(64),j=n(9),b=n(3),f=n(90),p=(n(411),n(1)),m=function(e){var t=e.storyId,n=Object(o.a)(e,["storyId"]),m=s.useState(),h=Object(r.a)(m,2),g=h[0],O=h[1],v=Object(b.useStoriesContext)(),x=v.dispatch,y=v.stories,w=Object(j.usePrefsContext)().prefs,C=Object(b.storyWithId)(y,t),S=Object(c.a)().t;return Object(p.jsxs)(u.a,Object(a.a)(Object(a.a)({},n),{},{className:"story-stylesheet-dialog",headerLabel:S("dialogs.storyStylesheet.title"),maximizable:!0,children:[Object(p.jsxs)(l.a,{children:[Object(p.jsx)(i.b,{editor:g,watch:C.script}),Object(p.jsx)(i.a,{editor:g})]}),Object(p.jsx)(u.b,{children:Object(p.jsx)(d.a,{editorDidMount:O,fontFamily:w.codeEditorFontFamily,fontScale:w.codeEditorFontScale,label:S("dialogs.storyStylesheet.editorLabel"),labelHidden:!0,onBeforeChange:function(e,t,n){O(e),x(Object(b.updateStory)(y,C,{stylesheet:n}))},options:Object(a.a)(Object(a.a)({},Object(f.a)(w)),{},{autofocus:!0,lineWrapping:!0,mode:"css",placeholder:S("dialogs.storyStylesheet.explanation")}),value:C.stylesheet})})]}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(14),r=n(2),o=(n(0),n(55)),s=n(27),c=n(18),i=n(3),l=n(9),u=n(23),d=n(138),j=n(1),b=function(e){var t=Object(u.useUndoableStoriesContext)(),n=t.dispatch,b=t.stories,f=Object(l.usePrefsContext)(),p=f.dispatch,m=f.prefs,h=Object(o.a)().t,g=Object(i.storyTags)(b);return Object(j.jsx)(s.a,Object(r.a)(Object(r.a)({className:"story-tags-dialog",fixedSize:!0,headerLabel:h("dialogs.storyTags.title")},e),{},{children:Object(j.jsx)(c.b,{children:g.length>0?g.map((function(e){return Object(j.jsx)(d.a,{allTags:g,color:m.storyTagColors[e],name:e,onChangeColor:function(t){return function(e,t){p(Object(l.setPref)("storyTagColors",Object(r.a)(Object(r.a)({},m.storyTagColors),{},Object(a.a)({},e,t))))}(e,t)},onChangeName:function(t){return function(e,t){n(Object(i.renameStoryTag)(b,e,t))}(e,t)}},e)})):Object(j.jsx)("p",{children:h("dialogs.storyTags.noTags")})})}))}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return p})),n.d(t,"p",(function(){return A})),n.d(t,"j",(function(){return N})),n.d(t,"k",(function(){return F})),n.d(t,"l",(function(){return I})),n.d(t,"n",(function(){return D})),n.d(t,"o",(function(){return T})),n.d(t,"g",(function(){return L})),n.d(t,"q",(function(){return M})),n.d(t,"r",(function(){return B})),n.d(t,"s",(function(){return z})),n.d(t,"h",(function(){return R})),n.d(t,"f",(function(){return U})),n.d(t,"t",(function(){return V})),n.d(t,"u",(function(){return X})),n.d(t,"a",(function(){return H})),n.d(t,"m",(function(){return W})),n.d(t,"v",(function(){return w})),n.d(t,"w",(function(){return Q}));var a=n(34),r=n(29),o=n(59);function s(e,t,n,s){if(!e.passages.some((function(e){return e.id===t.id})))throw new Error("This passage does not belong to this story.");return function(c){var i=Object(o.a)(s),l=Object(o.a)(n).filter((function(t){return!i.includes(t)&&!e.passages.some((function(e){return e.name===t}))}));if(0!==l.length){for(var u=Object(a.a)(),d=25,j=t.top+t.height+d,b=l.length*u.width+(l.length-1)*d,f=t.left+(t.width-b)/2,p=function(){return e.passages.some((function(e){return Object(r.g)(e,{left:f,top:j,height:u.height,width:b})}))};p()&&(f+=u.width+d,p())&&(f-=2*(u.width+d),p());)f+=u.width+d,j+=u.height+d;c({type:"createPassages",storyId:e.id,props:l.map((function(e){var t={left:f,name:e,top:j};return f+=u.width+d,t}))})}}}var c=n(2),i=n(21),l=n.n(i);function u(e,t,n){var a=l()();if(""===n.name.trim())throw new Error("Story name cannot be empty");if(e.some((function(e){return e.name.toLowerCase()===n.name.toLowerCase()})))throw new Error('There is already a story named "'.concat(n.name,'"'));return function(e){return e({type:"createStory",props:Object(c.a)({id:a,storyFormat:t.storyFormat.name,storyFormatVersion:t.storyFormat.version},n)}),a}}var d=n(85);function j(e,t,n){if(!Number.isFinite(t)||!Number.isFinite(n))throw new Error("Center must be a finite coordinate pair");var o=Object(a.a)(),s=Object(d.a)(o.name,e.passages.map((function(e){return e.name}))),i=25,l={height:o.height,left:Math.max(t-o.width/2,0),top:Math.max(n-o.height/2,0),width:o.width};e.snapToGrid&&(l.left=Math.round(l.left/i)*i,l.top=Math.round(l.top/i)*i);for(var u=function(){return e.passages.some((function(e){return Object(r.g)(e,l)}))};u()&&(l.left+=l.width+i,u())&&(l.left-=l.width+i,l.top+=l.height+i,u());){if(l.left>=l.width+i){if(l.left-=l.width+i,!u())break;l.left+=l.width+i}l.top+=l.height+i}return{type:"createPassage",storyId:e.id,props:Object(c.a)(Object(c.a)({},l),{},{story:e.id,name:s})}}function b(e,t){return{type:"deletePassages",storyId:e.id,passageIds:t.map((function(e){return e.id}))}}function f(e){return{type:"deleteStory",storyId:e.id}}function p(e,t){return{type:"createStory",props:Object(c.a)(Object(c.a)({},e),{},{id:l()(),ifid:l()(),name:Object(d.a)(e.name,t.map((function(e){return e.name})))})}}var m=n(37),h=n(101),g=n(133),O=n.n(g),v=n(79),x=n(13);function y(e,t,n,a){if(!e.passages.some((function(e){return e.id===t.id})))throw new Error("This passage does not belong to this story.");return function(r){var s=Object(o.a)(a),c=Object(o.a)(n),i=s.filter((function(e){return!c.includes(e)})).reduce((function(n,a){var r=e.passages.find((function(e){return e.name===a}));return r&&function(e){return""===e.text&&0===e.tags.length&&100===e.width&&100===e.height}(r)&&e.startPassage!==r.id?e.passages.some((function(e){return e.id!==t.id&&Object(o.a)(e.text).includes(a)}))?n:[].concat(Object(x.a)(n),[r.id]):n}),[]);i.length>0&&r({type:"deletePassages",passageIds:i,storyId:e.id})}}function w(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e.passages.some((function(e){return e.id===t.id})))throw new Error("This passage does not belong to this story.");if("name"in n&&e.passages.filter((function(e){return e.name===n.name})).some((function(e){return e.id!==t.id})))throw new Error('There is already a passage named "'.concat(n.name,'".'));return function(r,o){var c=t.name,i=t.text;if(r({props:n,type:"updatePassage",passageId:t.id,storyId:e.id}),!a.dontUpdateOthers&&n.text){r(y(e,t,n.text,i));var l=Object(v.h)(o(),e.id);r(s(l,t,n.text,i))}if(n.name){var u=O()(c),d=n.name.replace(/\$/g,"$$$$"),j=new RegExp("\\[\\["+u+"(\\]\\[.*?)?\\]\\]","g"),b=new RegExp("\\[\\[(.*?)(\\||->)"+u+"(\\]\\[.*?)?\\]\\]","g"),f=new RegExp("\\[\\["+u+"(<-.*?)(\\]\\[.*?)?\\]\\]","g");e.passages.forEach((function(t){if(j.test(t.text)||b.test(t.text)||f.test(t.text)){var n=t.text;n=(n=(n=n.replace(j,"[["+d+"$1]]")).replace(b,"[[$1$2"+d+"$3]]")).replace(f,"[["+d+"$1$2]]"),w(e,t,{text:n},a)(r,o)}}))}}}function C(e,t,n,a){var r=a.matchCase,o=a.useRegexes,s=Object(h.a)(t,{matchCase:r,useRegexes:o}),c=o?n:Object(h.b)(n);return e.replace(s,c)}function S(e,t,n,a,r){return function(o,s){if(""===n)throw new Error("Can't replace an empty string");if(t.story!==e.id)throw new Error("Passage does not belong to story");var c=r.includePassageNames,i={},l=C(t.text,n,a,r);if(l!==t.text&&(i.text=l),c){var u=C(t.name,n,a,r);u!==t.name&&(i.name=u)}Object.keys(i).length>0&&w(e,t,i)(o,s)}}function A(e,t,n,a){return function(r,o){if(""===t)throw new Error("Can't replace an empty string");if(a.includePassageNames){var s,c=Object(m.a)(e.passages);try{for(c.s();!(s=c.n()).done;){var i=s.value,l=C(i.name,t,n,a);l!==i.name&&w(e,i,{name:l})(r,o)}}catch(g){c.e(g)}finally{c.f()}var u,d=Object(m.a)(e.passages);try{for(d.s();!(u=d.n()).done;){var j=u.value,b=C(j.text,t,n,a);b!==j.text&&w(e,j,{text:b})(r,o)}}catch(g){d.e(g)}finally{d.f()}}else{var f,p=Object(m.a)(e.passages);try{for(p.s();!(f=p.n()).done;){var h=f.value;S(e,h,t,n,a)(r,o)}}catch(g){p.e(g)}finally{p.f()}}}}var k=n(14);function N(e,t,n){return function(a){var r={};if(""===t)r=e.passages.reduce((function(e,t){return t.highlighted?Object(c.a)(Object(c.a)({},e),{},Object(k.a)({},t.id,{highlighted:!1})):e}),{});else{var o=Object(v.d)(e.passages,t,n).map((function(e){return e.id}));e.passages.forEach((function(e){var t=e.highlighted,n=o.includes(e.id);n!==t&&(r[e.id]={highlighted:n})}))}Object.keys(r).length>0&&a({passageUpdates:r,type:"updatePassages",storyId:e.id})}}var E=n(32);function F(e,t){return e.forEach((function(t){if(e.some((function(e){return e!==t&&Object(E.storyFileName)(e)===Object(E.storyFileName)(t)})))throw new Error('Stories to import cannot have the same name: "'.concat(t.name,'"'))})),function(n){e.forEach((function(e){var a=Object(c.a)({},e);delete a.id;var r=t.find((function(t){return Object(E.storyFileName)(t)===Object(E.storyFileName)(e)}));r?(a.passages&&(a.passages=a.passages.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{story:r.id})}))),n({props:a,type:"updateStory",storyId:r.id})):n({props:a,type:"createStory"})}))}}function I(e,t,n,a){var r={};if(!Number.isFinite(n)||!Number.isFinite(a))throw new Error("Offset must be a finite number.");return t.forEach((function(t){var o=e.passages.find((function(e){return e.id===t}));if(!o)throw new Error('There is no passage in this story with ID "'.concat(t,'".'));var s=Math.max(o.left+n,0),c=Math.max(o.top+a,0);e.snapToGrid&&(s=100*Math.round(s/100),c=100*Math.round(c/100)),r[o.id]={left:s,top:c}})),{type:"updatePassages",passageUpdates:r,storyId:e.id}}var P=n(53);function D(e,t,n){if(!Object(P.a)(n))throw new Error('"'.concat(n,'" is not a valid tag name.'));return function(a){var r={};if(e.passages.forEach((function(e){e.tags.includes(t)&&(r[e.id]={tags:e.tags.map((function(e){return e===t?n:e}))})})),Object.keys(r).length>0){a({type:"updatePassages",passageUpdates:r,storyId:e.id});var o=Object(c.a)({},e.tagColors);delete o[t],o[n]=e.tagColors[t],a({type:"updateStory",props:{tagColors:o},storyId:e.id})}}}function T(e,t,n){if(!Object(P.a)(n))throw new Error('"'.concat(n,'" is not a valid tag name.'));return function(a){e.forEach((function(e){e.tags.includes(t)&&a({type:"updateStory",storyId:e.id,props:{tags:e.tags.map((function(e){return e===t?n:e}))}})}))}}function L(e,t){if(t.story!==e.id)throw new Error("This passage does not belong to this story");return function(n){t.selected&&n({type:"updatePassage",passageId:t.id,props:{selected:!1},storyId:e.id})}}function M(e){return function(t){var n={};e.passages.forEach((function(e){e.selected||(n[e.id]={selected:!0})})),Object.keys(n).length>0&&t({passageUpdates:n,type:"updatePassages",storyId:e.id})}}function B(e,t,n){if(t.story!==e.id)throw new Error("This passage does not belong to this story");return function(a){var r={};t.selected||(r[t.id]={selected:!0}),n&&e.passages.forEach((function(e){e.id!==t.id&&e.selected&&(r[e.id]={selected:!1})})),Object.keys(r).length>0&&a({type:"updatePassages",passageUpdates:r,storyId:e.id})}}function z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return function(a){var o={};e.passages.forEach((function(e){if(!n.find((function(t){return t===e.id}))){var a=Object(r.g)(t,e);e.selected!==a&&(o[e.id]={selected:a})}})),Object.keys(o).length>0&&a({type:"updatePassages",passageUpdates:o,storyId:e.id})}}function R(e){return function(t,n){e.selected||t({type:"updateStory",storyId:e.id,props:{selected:!1}})}}function U(){return function(e,t){var n,a=Object(m.a)(t());try{for(a.s();!(n=a.n()).done;){var r=n.value;r.selected&&e({type:"updateStory",storyId:r.id,props:{selected:!1}})}}catch(o){a.e(o)}finally{a.f()}}}function V(e,t){return function(n,a){if(e.selected||n({type:"updateStory",storyId:e.id,props:{selected:!0}}),t){var r,o=Object(m.a)(a());try{for(o.s();!(r=o.n()).done;){var s=r.value;s.id!==e.id&&s.selected&&n({type:"updateStory",storyId:s.id,props:{selected:!1}})}}catch(c){o.e(c)}finally{o.f()}}}}function X(e,t,n){if(!Object(P.a)(t))throw new Error('"'.concat(t,'" is not a valid tag name.'));return function(a){if("none"===n){if(t in e.tagColors){var r=Object(c.a)({},e.tagColors);delete r[t],a({type:"updateStory",props:{tagColors:r},storyId:e.id})}}else a({type:"updateStory",props:{tagColors:Object(c.a)(Object(c.a)({},e.tagColors),{},Object(k.a)({},t,n))},storyId:e.id})}}function H(e,t,n){if(t.story!==e.id)throw new Error("This passage does not belong to this story.");if(!Object(P.a)(n))throw new Error('"'.concat(n,'" is not a valid tag name.'));if(t.tags.includes(n))throw new Error('This passage already has the tag "'.concat(n,'".'));return{type:"updatePassage",passageId:t.id,storyId:e.id,props:{tags:[].concat(Object(x.a)(t.tags),[n])}}}function W(e,t,n){if(t.story!==e.id)throw new Error("This passage does not belong to this story.");if(!Object(P.a)(n))throw new Error('"'.concat(n,'" is not a valid tag name.'));if(!t.tags.includes(n))throw new Error('This passage does not have the tag "'.concat(n,'".'));return{type:"updatePassage",passageId:t.id,storyId:e.id,props:{tags:t.tags.filter((function(e){return e!==n}))}}}function Q(e,t,n){if(n.name&&e.filter((function(e){return Object(E.storyFileName)(e)===Object(E.storyFileName)(Object(c.a)(Object(c.a)({},e),n))})).some((function(e){return e.id!==t.id})))throw new Error('There is already a story named "'.concat(n.name,'".'));return{props:n,storyId:t.id,type:"updateStory"}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return k}));var a=n(4),r=n(0),o=n(86),s=n.n(o),c=n(67),i=n(13),l=n(2),u=n(21),d=n.n(u),j=n(34);function b(e,t,n){var a=!1,r=!1,o=e.map((function(e){if(e.id!==t)return e;if(a=!0,e.passages.some((function(e){return e.id===n.id})))return console.warn('There is already a passage in this story with ID "'.concat(n.id,'", taking no action')),e;if("name"in n&&e.passages.some((function(e){return e.name===n.name})))return console.warn('There is already a passage in this story with name "'.concat(n.name,'", taking no action')),e;var o=Object(l.a)(Object(l.a)(Object(l.a)({},Object(j.a)()),{},{id:d()()},n),{},{story:e.id}),s=Object(l.a)(Object(l.a)({},e),{},{lastUpdate:new Date,passages:[].concat(Object(i.a)(e.passages),[o])});return 1===s.passages.length&&(s.startPassage=o.id),r=!0,s}));return a?r?o:e:(console.warn('No story in state with ID "'.concat(t,'", taking no action')),e)}function f(e,t,n){var a=!1,r=!1,o=e.map((function(e){if(e.id!==t)return e;a=!0;var o=Object(l.a)(Object(l.a)({},e),{},{passages:e.passages.filter((function(e){return e.id!==n||(r=!0,!1)}))});return r?(o.lastUpdate=new Date,o):e}));return a?r?o:(console.warn('Asked to delete a passage with ID "'.concat(n,'", but it does not exist in story ID ').concat(t,", taking no action")),e):(console.warn('No story in state with ID "'.concat(t,'", taking no action')),e)}var p=n(87);function m(e,t,n,a){var r='Repairing passage (name: "'.concat(e.name,'", id: ').concat(e.id,"): ")+"setting ".concat(t," to ").concat(n,", was ").concat(e[t]);a&&(r+=" (".concat(a,")")),console.info(r)}function h(e,t,n,a){var r='Repairing story (name: "'.concat(e.name,'", id: ').concat(e.id,") by ")+"setting ".concat(t," to ").concat(n,", was ").concat(e[t]);a&&(r+=" (".concat(a,")")),console.info(r)}function g(e,t,n,r){var o=Object(j.b)(),s={};if("string"!==typeof e.id||""===e.id){var c=d()();h(e,"id",c,"was bad type or empty string"),s.id=c}if("string"!==typeof e.ifid||""===e.id){var i=d()();h(e,"ifid",i,"was bad type or empty string"),s.ifid=i}if(Object.entries(o).forEach((function(t){var n=Object(a.a)(t,2),r=n[0],c=n[1],i=r;("number"===typeof c&&!Number.isFinite(e[i])||typeof c!==typeof e[i])&&(h(e,i,o[i]),s[i]=o[i])})),"string"!==typeof e.storyFormat||""===e.storyFormat||"string"!==typeof e.storyFormatVersion||""===e.storyFormatVersion)h(e,"storyFormat",r.name,"was bad type or unset"),h(e,"storyFormatVersion",r.version,"was bad type or unset"),s.storyFormat=r.name,s.storyFormatVersion=r.version;else if(!n.some((function(t){return t.name===e.storyFormat&&t.version===e.storyFormatVersion}))){var u=n.find((function(t){return t.name===e.storyFormat&&Object(p.satisfies)(t.version,"^"+e.storyFormatVersion)}));u?(h(e,"storyFormat",u.name,"no match in existing formats but found one that satisfies semver"),h(e,"storyFormatVersion",u.version,"no match in existing formats but found one that satisfies semver"),s.storyFormat=u.name,s.storyFormatVersion=u.version):(h(e,"storyFormat",r.name,"no match in existing formats and could not find one that satisfies semver"),h(e,"storyFormatVersion",r.version,"no match in existing formats and could not find one that satisfies semver"),s.storyFormat=r.name,s.storyFormatVersion=r.version)}if(t.some((function(t){return t!==e&&t.id===e.id}))){var b=d()();h(e,"id",b,"conflicted with another story's ID"),s.id=b}var f=!1,g=e.passages.map((function(t){var n=function(e,t){var n=Object(j.a)(),r={};if("string"!==typeof e.id||""===e.id){var o=d()();m(e,"id",o,"was undefined or empty string"),r.id=d()()}if(Object.entries(n).forEach((function(t){var o=Object(a.a)(t,2),s=o[0],c=o[1],i=s;("number"===typeof c&&!Number.isFinite(e[i])||typeof c!==typeof e[i])&&(m(e,i,n[i]),r[i]=n[i])})),["left","top"].forEach((function(t){var n=t;e[n]<0&&(m(e,n,0,"was negative"),r[n]=0)})),["height","width"].forEach((function(t){var n=t;e[n]<5&&(m(e,n,0,"was less than 5"),r[n]=5)})),e.story!==t.id&&(m(e,"story",t.id,"didn't match parent story"),r.story=t.id),t.passages.some((function(t){return t!==e&&t.id===e.id}))){var s=d()();m(e,"id",s,"conflicted with another passage in the story"),r.id=s}return Object.keys(r).length>0?Object(l.a)(Object(l.a)({},e),r):e}(t,Object(l.a)(Object(l.a)({},e),s));return n!==t?(f=!0,n):t}));return f&&(s.passages=g),Object.keys(s).length>0?Object(l.a)(Object(l.a)({},e),s):e}var O=n(40);function v(e,t,n,a){var r=!1,o=!1,s=e.map((function(e){if(e.id!==t)return e;if(r=!0,"name"in a&&e.passages.some((function(e){return e.name===a.name&&e.id!==n})))return console.warn('There is already a passage in this story with name "'.concat(a.name,'", taking no action')),e;var s=Object(l.a)(Object(l.a)({},e),{},{passages:e.passages.map((function(e){return e.id!==n?e:(o=!0,Object(l.a)(Object(l.a)({},e),a))}))});return o?(Object(O.a)(a)&&(s.lastUpdate=new Date),s):(console.warn('Asked to update a passage with ID "'.concat(n,'", but it does not exist in story ID ').concat(t,", taking no action")),e)}));return r?o?s:e:(console.warn('No story in state with ID "'.concat(t,'", taking no action')),e)}var x=function(e,t){switch(t.type){case"createPassage":return b(e,t.storyId,t.props);case"createPassages":return function(e,t,n){return n.reduce((function(e,n){return b(e,t,n)}),e)}(e,t.storyId,t.props);case"createStory":return function(e,t){if("id"in t&&e.some((function(e){return e.id===t.id})))return console.warn('There is already a story in state with ID "'.concat(t.id,'", taking no action')),e;if("name"in t&&e.some((function(e){return e.name===t.name})))return console.warn('There is already a story in state with name "'.concat(t.name,'", taking no action')),e;var n=Object(l.a)(Object(l.a)({id:d()()},Object(j.b)()),{},{ifid:d()().toUpperCase(),lastUpdate:new Date,passages:[],tags:[],tagColors:{}},t);return n.passages=n.passages.map((function(e){return Object(l.a)(Object(l.a)(Object(l.a)({},j.a),e),{},{story:n.id})})),[].concat(Object(i.a)(e),[n])}(e,t.props);case"deletePassage":return f(e,t.storyId,t.passageId);case"deletePassages":return function(e,t,n){return n.reduce((function(e,n){return f(e,t,n)}),e)}(e,t.storyId,t.passageIds);case"deleteStory":return function(e,t){var n=!1,a=e.filter((function(e){return e.id!==t||(n=!0,!1)}));return n?a:(console.warn('Asked to delete a story with ID "'.concat(t,'", but it does not exist in state')),e)}(e,t.storyId);case"init":return n=t.state,Object(i.a)(n);case"repair":return function(e,t,n){return e.map((function(a){return g(a,e,t,n)}))}(e,t.allFormats,t.defaultFormat);case"updatePassage":return v(e,t.storyId,t.passageId,t.props);case"updatePassages":return function(e,t,n){return Object.keys(n).reduce((function(e,a){return v(e,t,a,n[a])}),e)}(e,t.storyId,t.passageUpdates);case"updateStory":return function(e,t,n){if("name"in n&&e.some((function(e){return e.name===n.name&&e.id!==t})))return console.warn('There is another story in state with name "'.concat(n.name,'", taking no action')),e;var a=!1,r=e.map((function(e){if(e.id!==t)return e;a=!0;var r=Object(l.a)(Object(l.a)({},e),n);return Object(O.b)(n)&&(r.lastUpdate=new Date),r}));return a?r:(console.warn('Asked to update a story with ID "'.concat(t,'", but it does not exist in state')),e)}(e,t.storyId,t.props);default:console.warn("".concat(t.type," not implemented yet"))}var n;return e},y=n(11),w=n(88),C=n(1),S=r.createContext({dispatch:function(){},stories:[]});S.displayName="Stories";var A=function(){return r.useContext(S)},k=function(e){var t=Object(c.a)().stories,n=Object(y.useStoryFormatsContext)().formats,o=Object(w.a)().reportError,i=r.useMemo((function(){return function(e,a){var r=x(e,a);try{t.saveMiddleware(r,a,n)}catch(s){o(s,"store.errors.cantPersistStories")}return r}}),[n,o,t]),l=s()(i,[]),u=Object(a.a)(l,2),d=u[0],j=u[1];return Object(C.jsx)(S.Provider,{value:{dispatch:j,stories:d},children:e.children})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var a=n(2),r=n(4),o=n(20),s=n(0),c=n(55),i=n(83),l=n(27),u=n(43),d=n(3),j=n(11),b=n(23),f=(n(387),n(135)),p=n(64),m=n(9),h=n(13),g=n(41),O=n.n(g);var v=n(89),x=n(45);var y=n(90),w=n(1),C=function(e){var t,n=e.onChange,o=e.onEditorChange,i=e.passage,u=e.story,d=e.storyFormat,b=e.storyFormatExtensionsDisabled,g=s.useState(!1),C=Object(r.a)(g,2),S=C[0],A=C[1],k=s.useState(i.text),N=Object(r.a)(k,2),E=N[0],F=N[1],I=Object(m.usePrefsContext)().prefs,P=function(e){return s.useCallback((function(t){t.showHint({completeSingle:!1,extraKeys:["]","-","|"].reduce((function(e,t){return e[t]=function(e,n){var a=e.getDoc();a.replaceRange(t,a.getCursor()),n.close()},e}),{}),hint:function(){var n=t.findWordAt(t.getCursor()),a=t.getRange(n.anchor,n.head).toLowerCase(),r={list:e.passages.reduce((function(e,t){return t.name.toLowerCase().includes(a)?[].concat(Object(h.a)(e),[t.name]):e}),[]),from:n.anchor,to:n.head};return O.a.on(r,"pick",(function(){var e=t.getDoc();e.replaceRange("]] ",e.getCursor())})),r}})}),[e.passages])}(u),D=null!==(t=function(e,t){var n=Object(j.useStoryFormatsContext)(),a=n.dispatch,o=n.formats,c=Object(j.formatWithNameAndVersion)(o,e,t),i=Object(m.usePrefsContext)().prefs,l=s.useState(),u=Object(r.a)(l,2),d=u[0],b=u[1],f=Object(m.formatEditorExtensionsDisabled)(i,e,t);return s.useEffect((function(){if(!f)if("unloaded"===c.loadState)a(Object(j.loadFormatProperties)(c));else if("loaded"===c.loadState){var e,t=Object(x.b)(c,v.a);(null===t||void 0===t||null===(e=t.codeMirror)||void 0===e?void 0:e.mode)&&(O.a.defineMode(Object(x.c)(c),t.codeMirror.mode),b(Object(x.c)(c)))}}),[a,f,c]),d}(d.name,d.version))&&void 0!==t?t:"text",T=Object(c.a)().t;s.useEffect((function(){S||E===i.text||F(i.text)}),[S,E,i.text]);var L=s.useMemo((function(){return Object(f.debounce)((function(e){n(e),A(!1)}),1e3)}),[n]),M=s.useCallback((function(e){o(e),window.setTimeout((function(){e.focus(),e.refresh()}),400)}),[o]),B=s.useCallback((function(e,t,n){o(e),A(!0),L(n),F(n)}),[L,o]),z=s.useMemo((function(){return Object(a.a)(Object(a.a)({},Object(y.a)(I)),{},{mode:b?"text":D,lineWrapping:!0,placeholder:T("dialogs.passageEdit.passageTextPlaceholder"),prefixTrigger:{callback:P,prefixes:["[[","->"]}})}),[P,D,I,b,T]);return Object(w.jsx)(l.b,{children:Object(w.jsx)(p.a,{editorDidMount:M,fontFamily:I.passageEditorFontFamily,fontScale:I.passageEditorFontScale,label:T("dialogs.passageEdit.passageTextEditorLabel"),labelHidden:!0,onBeforeChange:B,onChange:o,options:z,value:E})})},S=n(5),A=n(70),k=n(15),N=n(35),E=n(58),F=n(136),I=n(68),P=function(e){var t=e.editor,n=e.passage,a=e.story,r=Object(b.useUndoableStoriesContext)(),o=r.dispatch,s=r.stories,i=Object(c.a)().t,l=a.startPassage===n.id;function u(e){var t=e.height,r=e.width;o(Object(d.updatePassage)(a,n,{height:t,width:r}))}return Object(w.jsxs)(k.a,{children:[Object(w.jsx)(A.b,{editor:t,watch:n.text}),Object(w.jsx)(I.a,{assignedTags:n.tags,existingTags:Object(d.storyPassageTags)(a),onAdd:function(e,t){o(Object(d.addPassageTag)(a,n,e),i("undoChange.addTag")),t&&o(Object(d.setTagColor)(a,e,t))}}),Object(w.jsx)(E.a,{icon:Object(w.jsx)(S.J,{}),items:[{checkable:!0,checked:100===n.height&&100===n.width,label:i("dialogs.passageEdit.sizeSmall"),onClick:function(){return u({height:100,width:100})}},{checkable:!0,checked:200===n.height&&200===n.width,label:i("dialogs.passageEdit.sizeLarge"),onClick:function(){return u({height:200,width:200})}},{checkable:!0,checked:200===n.height&&100===n.width,label:i("dialogs.passageEdit.sizeTall"),onClick:function(){return u({height:200,width:100})}},{checkable:!0,checked:100===n.height&&200===n.width,label:i("dialogs.passageEdit.sizeWide"),onClick:function(){return u({height:100,width:200})}}],label:i("dialogs.passageEdit.size")}),Object(w.jsx)(F.a,{onRename:function(e){o(Object(d.updatePassage)(a,n,{name:e},{dontUpdateOthers:!0}))},passage:n,story:a}),Object(w.jsx)(N.a,{disabled:l,label:i("dialogs.passageEdit.setAsStart"),onChange:function(){o(Object(d.updateStory)(s,a,{startPassage:n.id}))},value:l})]})},D=n(137),T=n(14);var L=n(8),M=(n(402),function(e){var t=e.editor,n=e.onExecCommand,o=e.storyFormat,c=s.useRef(null),i=Object(D.a)(),l=Object(m.usePrefsContext)().prefs,u=function(e,t){var n=Object(j.useStoryFormatsContext)(),o=n.dispatch,c=n.formats,i=s.useState({}),l=Object(r.a)(i,2),u=l[0],d=l[1],b=s.useState(),f=Object(r.a)(b,2),p=f[0],g=f[1],y=Object(j.formatWithNameAndVersion)(c,e,t),w=Object(m.usePrefsContext)().prefs,C=Object(m.formatEditorExtensionsDisabled)(w,e,t);return s.useEffect((function(){if(!C)if("unloaded"===y.loadState)o(Object(j.loadFormatProperties)(y));else if("loaded"===y.loadState&&!u[Object(x.c)(y)]){var e,t,n=Object(x.c)(y),r=Object(x.b)(y,v.a);if(null===r||void 0===r||null===(e=r.codeMirror)||void 0===e?void 0:e.commands)for(var s in r.codeMirror.commands){var c=n+s;c in O.a.commands?console.warn('CodeMirror already has a "'.concat(c,'" command defined, skipping')):O.a.commands[c]=r.codeMirror.commands[s]}(null===r||void 0===r||null===(t=r.codeMirror)||void 0===t?void 0:t.toolbar)&&g((function(){return function(e,t){var o;if(!(null===r||void 0===r||null===(o=r.codeMirror)||void 0===o?void 0:o.toolbar))return[];var s=r.codeMirror.toolbar(e,t);return Array.isArray(s)?s.reduce((function(e,t){switch(t.type){case"button":return[].concat(Object(h.a)(e),[Object(a.a)(Object(a.a)({},t),{},{command:n+t.command})]);case"menu":if(Array.isArray(t.items))return[].concat(Object(h.a)(e),[Object(a.a)(Object(a.a)({},t),{},{items:t.items.filter((function(e){return["button","separator"].includes(e.type)})).map((function(e){return"separator"===e.type?e:Object(a.a)(Object(a.a)({},e),{},{command:n+e.command})}))})])}return e}),[]):[]}})),d((function(e){return Object(a.a)(Object(a.a)({},e),{},Object(T.a)({},Object(x.c)(y),!0))}))}}),[o,C,y,u]),p}(o.name,o.version),d=s.useState([]),b=Object(r.a)(d,2),f=b[0],p=b[1],g=s.useCallback((function(){if(u&&c.current&&t)try{var e=window.getComputedStyle(c.current);p(u(t,{appTheme:i,foregroundColor:e.color,locale:l.locale}))}catch(n){console.error("Toolbar function for ".concat(o.name," ").concat(o.version," threw an error, skipping update"),n)}else p([])}),[i,t,l.locale,o.name,o.version,u]);function y(e){n(e),Promise.resolve().then(g)}return s.useEffect((function(){if(t)return g(),t.on("cursorActivity",g),function(){return t.off("cursorActivity",g)}}),[t,g]),Object(w.jsx)("div",{className:"story-format-toolbar",ref:c,children:Object(w.jsx)(k.a,{children:f.map((function(e,t){switch(e.type){case"button":return Object(w.jsx)(L.a,{disabled:e.disabled,icon:Object(w.jsx)("img",{src:e.icon,alt:""}),iconOnly:e.iconOnly,label:e.label,onClick:function(){return y(e.command)}},t);case"menu":return Object(w.jsx)(E.a,{disabled:e.disabled,icon:Object(w.jsx)("img",{src:e.icon,alt:""}),iconOnly:e.iconOnly,items:e.items.filter((function(e){return["button","separator"].includes(e.type)})).map((function(e){return"button"===e.type?{type:"button",disabled:e.disabled,label:e.label,onClick:function(){return y(e.command)}}:{separator:!0}})),label:e.label},t)}return null}))})})}),B=function(e){var t=e.passage,n=e.story,r=Object(b.useUndoableStoriesContext)(),o=r.dispatch,s=r.stories,i=Object(c.a)().t;return 0===t.tags.length?null:Object(w.jsx)("div",{className:"tags",children:Object(w.jsx)(k.a,{children:t.tags.map((function(e){return Object(w.jsx)(I.b,{color:n.tagColors[e],name:e,onChangeColor:function(t){return function(e,t){o(Object(d.updateStory)(s,n,{tagColors:Object(a.a)(Object(a.a)({},n.tagColors),{},Object(T.a)({},e,t))}))}(e,t)},onRemove:function(){return a=e,void o(Object(d.removePassageTag)(n,t,a),i("undoChange.removeTag"));var a}},e)}))})})},z=function(e){var t=e.passageId,n=e.storyId,f=Object(o.a)(e,["passageId","storyId"]),p=s.useState(!0),m=Object(r.a)(p,2),h=m[0],g=m[1],O=s.useState(!1),v=Object(r.a)(O,2),x=v[0],y=v[1],S=s.useState(),A=Object(r.a)(S,2),k=A[0],N=A[1],E=Object(i.a)(),F=E.ErrorBoundary,I=E.error,D=E.reset,T=Object(b.useUndoableStoriesContext)(),L=T.dispatch,z=T.stories,R=Object(j.useStoryFormatsContext)().formats,U=Object(d.passageWithId)(z,n,t),V=Object(d.storyWithId)(z,n),X=Object(j.formatWithNameAndVersion)(R,V.storyFormat,V.storyFormatVersion),H=Object(c.a)().t;s.useEffect((function(){I&&(h?(console.error("Passage editor crashed, trying without format extensions",I),g(!1)):y(!0),D())}),[I,D,h]);var W=s.useCallback((function(e){L(Object(d.updatePassage)(V,U,{text:e}))}),[L,U,V]);return s.useEffect((function(){f.userDialogText&&(W(f.userDialogText),e.onClose())}),[f.userDialogText]),Object(w.jsx)(l.a,Object(a.a)(Object(a.a)({},f),{},{className:"passage-edit-dialog",headerLabel:U.name,maximizable:!0,children:x?Object(w.jsx)(u.a,{children:H("dialogs.passageEdit.editorCrashed")}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(P,{editor:k,passage:U,story:V}),h&&Object(w.jsx)(M,{editor:k,onExecCommand:function(e){if(!k)throw new Error("No editor set");k.execCommand(e);var t=k.listSelections();Promise.resolve().then((function(){return k.setSelections(t)}))},storyFormat:X}),Object(w.jsx)(B,{passage:U,story:V}),Object(w.jsx)(F,{children:Object(w.jsx)(C,{onChange:W,onEditorChange:N,passage:U,story:V,storyFormat:X,storyFormatExtensionsDisabled:!h})})]})}))},R=function(e){var t=Object(b.useUndoableStoriesContext)().stories;try{Object(d.passageWithId)(t,e.storyId,e.passageId)}catch(n){return e.onClose(),null}return Object(w.jsx)(z,Object(a.a)({},e))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(2),r=n(4),o=n(0),s=n(55),c=n(18),i=n(27),l=n(32),u=n(3),d=n(20),j=n(22),b=n.n(j),f=(n(404),n(1)),p=function(e){var t=e.children,n=e.onChange,r=e.onError,o=e.orientation,s=Object(d.a)(e,["children","onChange","onError","orientation"]),c=b()("file-input","orientation-".concat(null!==o&&void 0!==o?o:"horizontal"));return Object(f.jsx)("span",{className:c,children:Object(f.jsxs)("label",{children:[Object(f.jsx)("span",{className:"file-input-label",children:t}),Object(f.jsx)("span",{className:"file-input-control",children:Object(f.jsx)("input",Object(a.a)(Object(a.a)({},s),{},{onChange:function(e){if(!e.target.files)throw new Error("Change event occurred but no files present");var t=e.target.files[0],a=new FileReader;a.addEventListener("loadend",(function(e){a.error?(console.warn(a.error),r&&r(a.error)):n(t,a.result)})),a.readAsText(t)},type:"file"}))})]})})},m=n(130),h=function(e){var t=e.onChange,n=Object(s.a)().t;return Object(f.jsx)("div",{className:"file-chooser",children:Object(f.jsx)("p",{children:Object(f.jsx)(p,{accept:".html",onChange:function(e,n){t(e,Object(m.a)(n))},orientation:"vertical",children:n("dialogs.storyImport.filePrompt")})})})},g=n(13),O=n(5),v=n(35),x=n(8),y=(n(405),function(e){var t=e.existingStories,n=e.onImport,a=e.stories,c=o.useState([]),i=Object(r.a)(c,2),u=i[0],d=i[1],j=Object(s.a)().t,b=o.useCallback((function(e){return t.some((function(t){return Object(l.storyFileName)(t)===Object(l.storyFileName)(e)}))}),[t]);return o.useEffect((function(){d(a.filter((function(e){return!b(e)})))}),[a,b]),Object(f.jsxs)("div",{className:"story-chooser",children:[Object(f.jsx)("p",{children:j("dialogs.storyImport.storiesPrompt")}),Object(f.jsx)("ul",{children:a.map((function(e){return Object(f.jsxs)("li",{children:[Object(f.jsx)(v.a,{label:e.name,onChange:function(t){return function(e,t){d(t?function(t){return[].concat(Object(g.a)(t),[e])}:function(t){return t.filter((function(t){return t.id!==e.id}))})}(e,t)},value:u.includes(e)}),u.includes(e)&&b(e)&&Object(f.jsx)("span",{className:"replace-warning",children:j("dialogs.storyImport.willReplaceExisting")})]},e.id)}))}),Object(f.jsx)("div",{className:"actions",children:Object(f.jsx)(x.a,{disabled:0===u.length,icon:Object(f.jsx)(O.v,{}),label:j("dialogs.storyImport.importSelected"),onClick:function(){return n(u)},variant:"primary"})})]})}),w=(n(406),function(e){var t=e.onClose,n=Object(s.a)().t,d=Object(u.useStoriesContext)(),j=d.dispatch,b=d.stories,p=o.useState(),m=Object(r.a)(p,2),g=m[0],O=m[1],v=o.useState([]),x=Object(r.a)(v,2),w=x[0],C=x[1];function S(e){j(Object(u.importStories)(e,b)),t()}return Object(f.jsx)(i.a,Object(a.a)(Object(a.a)({},e),{},{className:"story-import-dialog",fixedSize:!0,headerLabel:n("dialogs.storyImport.title"),children:Object(f.jsxs)(c.b,{children:[Object(f.jsx)(h,{onChange:function(e,t){0===t.length||t.some((function(e){return b.some((function(t){return Object(l.storyFileName)(t)===Object(l.storyFileName)(e)}))}))?(O(e),C(t)):S(t)}}),g&&w.length>0&&Object(f.jsx)(y,{existingStories:b,onImport:S,stories:w}),g&&0===w.length&&Object(f.jsx)("p",{children:n("dialogs.storyImport.noStoriesInFile")})]})}))})},function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var a=n(4),r=n(0),o=n(55),s=n(2),c=n(13),i=n(14),l=n(3);function u(e,t){switch(e.type){case"createPassage":if(e.props.id)return{type:"deletePassage",passageId:e.props.id,storyId:e.storyId};if(e.props.name){return function(t,n){t({type:"deletePassage",passageId:Object(l.passageWithName)(n(),e.storyId,e.props.name).id,storyId:e.storyId})}}throw new Error("Can't reverse a createPassage action without either name or ID");case"createPassages":if(e.props.some((function(e){return!e.id&&!e.name})))throw new Error("Can't reverse a createPassages action where a prop set doesn't have either name or ID");return function(t,n){e.props.forEach((function(a){a.id?t({type:"deletePassage",passageId:a.id,storyId:e.storyId}):a.name&&t({type:"deletePassage",passageId:Object(l.passageWithName)(n(),e.storyId,a.name).id,storyId:e.storyId})}))};case"deletePassage":return{type:"createPassage",props:Object(l.passageWithId)(t,e.storyId,e.passageId),storyId:e.storyId};case"deletePassages":return{type:"createPassages",props:e.passageIds.map((function(n){return Object(l.passageWithId)(t,e.storyId,n)})),storyId:e.storyId};case"updatePassage":var n=Object(l.passageWithId)(t,e.storyId,e.passageId);return{type:"updatePassage",props:Object.keys(e.props).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(i.a)({},t,n[t]))}),{}),passageId:e.passageId,storyId:e.storyId};case"updatePassages":return{type:"updatePassages",passageUpdates:Object.keys(e.passageUpdates).reduce((function(n,a){var r=Object(l.passageWithId)(t,e.storyId,a);return Object(s.a)(Object(s.a)({},n),{},Object(i.a)({},a,Object.keys(e.passageUpdates[a]).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(i.a)({},t,r[t]))}),{})))}),{}),storyId:e.storyId};case"updateStory":var a=Object(l.storyWithId)(t,e.storyId);return{type:"updateStory",props:Object.keys(e.props).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(i.a)({},t,a[t]))}),{}),storyId:e.storyId}}throw new Error("Don't know how to reverse action type \"".concat(e.type,'"'))}function d(e,t){var n=[];return e((function(e){"function"===typeof e?n.push(d(e,t)):n.push(u(e,t))}),(function(){return t})),function(e){return n.forEach(e)}}var j=function(e,t){switch(t.type){case"addChange":var n={description:t.description,redo:t.action,undo:"function"===typeof t.action?d(t.action,t.storiesState):u(t.action,t.storiesState)},a=[].concat(Object(c.a)(e.changes.slice(0,e.currentChange+1)),[n]);return{changes:a,currentChange:a.length-1};case"updateCurrent":return Object(s.a)(Object(s.a)({},e),{},{currentChange:Math.min(Math.max(e.currentChange+t.change,-1),e.changes.length-1)})}},b=n(1),f=r.createContext({dispatch:function(){},stories:[]});f.displayName="UndoableStories";var p=function(){return r.useContext(f)},m=function(e){var t=Object(l.useStoriesContext)(),n=t.dispatch,s=t.stories,c=r.useReducer(j,{changes:[],currentChange:-1}),i=Object(a.a)(c,2),u=i[0],d=i[1],p=r.useCallback((function(e,t){return t&&d({type:"addChange",action:e,description:t,storiesState:s}),n(e)}),[s,n]),m=Object(o.a)().t,h=void 0,g=void 0,O=void 0,v=void 0;return u.changes.length>0&&(u.currentChange>=0&&(O=function(){n(u.changes[u.currentChange].undo),d({type:"updateCurrent",change:-1})},v=m("common.undoChange",{change:m(u.changes[u.currentChange].description)})),u.currentChange<u.changes.length-1&&(h=function(){n(u.changes[u.currentChange+1].redo),d({type:"updateCurrent",change:1})},g=m("common.redoChange",{change:m(u.changes[u.currentChange+1].description)}))),Object(b.jsx)(f.Provider,{value:{dispatch:p,redo:h,redoLabel:g,stories:s,undo:O,undoLabel:v},children:e.children})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),r=n(20),o=(n(0),n(55)),s=n(35),c=n(15),i=n(18),l=n(27),u=n(11),d=n(44),j=n(1),b=function(e){var t=e.formats,n=e.selectedFormat,s=Object(r.a)(e,["formats","selectedFormat"]),c=Object(o.a)().t,i=t.filter((function(e){return"loading"===e.loadState})),l=Object(u.sortFormats)(t.filter((function(e){return"loaded"===e.loadState||e.id===n.id}))).map((function(e){return{disabled:!1,label:"".concat(e.name," ").concat(e.version),value:e.id}}));return 0!==i.length&&l.push({disabled:!0,label:c("components.storyFormatSelect.loadingCount",{loadingCount:i.length}),value:""}),Object(j.jsx)(d.a,Object(a.a)(Object(a.a)({},s),{},{options:l,value:n.id}))},f=n(3),p=n(142),m=(n(409),new Intl.DateTimeFormat([],{dateStyle:"full",timeStyle:"long"})),h=function(e){var t=e.story,n=Object(f.storyStats)(t),a=Object(o.a)().t;return Object(j.jsxs)("div",{className:"story-stats",children:[Object(j.jsx)("table",{className:"counts",children:Object(j.jsxs)("tbody",{children:[Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{children:n.characters}),Object(j.jsx)("td",{children:a("dialogs.storyDetails.stats.characters")})]}),Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{children:n.words}),Object(j.jsx)("td",{children:a("dialogs.storyDetails.stats.words")})]}),Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{children:n.passages}),Object(j.jsx)("td",{children:a("dialogs.storyDetails.stats.passages")})]}),Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{children:n.links.length}),Object(j.jsx)("td",{children:a("dialogs.storyDetails.stats.links")})]}),Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{children:n.brokenLinks.length}),Object(j.jsx)("td",{children:a("dialogs.storyDetails.stats.brokenLinks")})]})]})}),Object(j.jsxs)("div",{className:"update-and-ifid",children:[Object(j.jsx)("p",{children:a("dialogs.storyDetails.stats.lastUpdate",{date:m.format(t.lastUpdate)})}),Object(j.jsxs)("p",{children:[a("dialogs.storyDetails.stats.ifid",{ifid:t.ifid}),"\xa0",Object(j.jsx)("a",{href:"https://ifdb.org/help-ifid",target:"_blank",rel:"noreferrer",children:a("dialogs.storyDetails.stats.ifidExplanation")})]})]})]})},g=function(e){var t=e.storyId,n=Object(r.a)(e,["storyId"]),d=Object(f.useStoriesContext)(),m=d.dispatch,g=d.stories,O=Object(u.useStoryFormatsContext)().formats,v=Object(f.storyWithId)(g,t),x=Object(o.a)().t;return Object(j.jsxs)(l.a,Object(a.a)(Object(a.a)({},n),{},{className:"story-details-dialog",fixedSize:!0,headerLabel:v.name,children:[Object(j.jsxs)("div",{className:"story-format",children:[Object(j.jsx)(p.a,{block:!1}),Object(j.jsx)(b,{formats:O,onChange:function(e){var t=Object(u.formatWithId)(O,e.target.value);m(Object(f.updateStory)(g,v,{storyFormat:t.name,storyFormatVersion:t.version}))},selectedFormat:Object(u.formatWithNameAndVersion)(O,v.storyFormat,v.storyFormatVersion),children:x("common.storyFormat")}),Object(j.jsx)("a",{href:"https://twinery.org/2storyformats",target:"_blank",rel:"noreferrer",children:x("dialogs.storyDetails.storyFormatExplanation")})]}),Object(j.jsx)(c.a,{children:Object(j.jsx)(s.a,{label:x("dialogs.storyDetails.snapToGrid"),onChange:function(e){return m(Object(f.updateStory)(g,v,{snapToGrid:e}))},value:v.snapToGrid})}),Object(j.jsx)(i.b,{children:!n.collapsed&&Object(j.jsx)(h,{story:v})})]}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(2),r=n(0),o=n(55),s=n(18),c=n(27),i=n(35),l=n(13),u=n(4),d=n(72),j=n(44),b=(n(380),n(1)),f=["var(--font-monospaced)","var(--font-system)"],p=[.8,.9,1,1.25,1.5,2],m=function(e){var t=e.familyLabel,n=e.fontFamily,a=e.fontScale,s=e.onChangeFamily,c=e.onChangeScale,i=e.scaleLabel,m=r.useState(!p.includes(a)),h=Object(u.a)(m,2),g=h[0],O=h[1],v=r.useState(!f.includes(n)),x=Object(u.a)(v,2),y=x[0],w=x[1],C=r.useState(n),S=Object(u.a)(C,2),A=S[0],k=S[1],N=r.useState((100*a).toString()),E=Object(u.a)(N,2),F=E[0],I=E[1],P=Object(o.a)().t;return Object(b.jsxs)("div",{className:"font-select",children:[Object(b.jsx)(j.a,{onChange:function(e){"custom"===e.target.value?(w(!0),f.includes(A)&&k("")):(w(!1),s(e.target.value))},options:[{label:P("components.fontSelect.fonts.system"),value:"var(--font-system)"},{label:P("components.fontSelect.fonts.monospaced"),value:"var(--font-monospaced)"},{label:P("common.custom"),value:"custom"}],value:y?"custom":n,children:t}),y&&Object(b.jsx)(d.a,{onChange:function(e){k(e.target.value),""!==e.target.value.trim()&&s(e.target.value)},orientation:"vertical",value:A,children:P("components.fontSelect.customFamilyDetail")}),Object(b.jsx)(j.a,{onChange:function(e){"custom"===e.target.value?O(!0):(O(!1),c(parseFloat(e.target.value)))},options:[].concat(Object(l.a)(p.map((function(e){return{label:P("components.fontSelect.percentage",{percent:100*e}),value:e.toString()}}))),[{label:P("common.custom"),value:"custom"}]),value:g?"custom":a.toString(),children:i}),g&&Object(b.jsx)(d.a,{onChange:function(e){I(e.target.value);var t=parseInt(e.target.value);Number.isFinite(t)&&c(t/100)},orientation:"vertical",value:F,children:P("components.fontSelect.customScaleDetail")})]})},h=n(9),g=[{code:"ca",name:"Catal\xe0"},{code:"cs",name:"\u010ce\u0161tina"},{code:"da",name:"Dansk"},{code:"de",name:"Deutsch"},{code:"en",name:"English"},{code:"es",name:"Castellano"},{code:"fi",name:"Suomi"},{code:"fr",name:"Fran\xe7ais"},{code:"it",name:"Italiano"},{code:"ms",name:"Bahasa Melayu"},{code:"nb",name:"Norsk bokm\xe5l"},{code:"nl",name:"Nederlands"},{code:"pt-br",name:"Portugu\xeas Brasileiro"},{code:"pt-pt",name:"Portugu\xeas"},{code:"ru",name:"\u0440\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"sv",name:"Svenska"},{code:"tr",name:"T\xfcrk\xe7e"},{code:"zh-cn",name:"\u4e2d\u6587(\u7b80\u4f53)"}];function O(e){if(g.some((function(t){return t.code===e})))return e;if(e.includes("-")){var t=e.replace(/-.+/,""),n=g.find((function(e){return e.code===t||e.code.replace(/-.+/,"")===t}));if(n)return n.code}return"en"}n(381);var v=function(e){var t=Object(h.usePrefsContext)(),n=t.dispatch,r=t.prefs,l=Object(o.a)().t;return Object(b.jsx)(c.a,Object(a.a)(Object(a.a)({},e),{},{className:"app-prefs-dialog",fixedSize:!0,headerLabel:l("dialogs.appPrefs.title"),children:Object(b.jsxs)(s.b,{children:[Object(b.jsx)(j.a,{onChange:function(e){return n(Object(h.setPref)("locale",e.target.value))},options:g.map((function(e){return{label:e.name,value:e.code}})),value:O(r.locale),children:l("dialogs.appPrefs.language")}),Object(b.jsx)(j.a,{onChange:function(e){return n(Object(h.setPref)("appTheme",e.target.value))},options:[{label:l("dialogs.appPrefs.themeSystem"),value:"system"},{label:l("dialogs.appPrefs.themeLight"),value:"light"},{label:l("dialogs.appPrefs.themeDark"),value:"dark"}],value:r.appTheme,children:l("dialogs.appPrefs.theme")}),Object(b.jsx)(j.a,{onChange:function(e){return n(Object(h.setPref)("dialogWidth",parseInt(e.target.value)))},options:[{label:l("dialogs.appPrefs.dialogWidths.default"),value:"600"},{label:l("dialogs.appPrefs.dialogWidths.wider"),value:"700"},{label:l("dialogs.appPrefs.dialogWidths.widest"),value:"800"}],value:r.dialogWidth.toString(),children:l("dialogs.appPrefs.dialogWidth")}),Object(b.jsx)(i.a,{label:l("dialogs.appPrefs.editorCursorBlinks"),onChange:function(e){return n(Object(h.setPref)("editorCursorBlinks",e))},value:r.editorCursorBlinks}),Object(b.jsx)("p",{className:"font-explanation",children:l("dialogs.appPrefs.fontExplanation")}),Object(b.jsx)(m,{familyLabel:l("dialogs.appPrefs.passageEditorFont"),fontFamily:r.passageEditorFontFamily,fontScale:r.passageEditorFontScale,onChangeFamily:function(e){return n(Object(h.setPref)("passageEditorFontFamily",e))},onChangeScale:function(e){return n(Object(h.setPref)("passageEditorFontScale",e))},scaleLabel:l("dialogs.appPrefs.passageEditorFontScale")}),Object(b.jsx)(m,{familyLabel:l("dialogs.appPrefs.codeEditorFont"),fontFamily:r.codeEditorFontFamily,fontScale:r.codeEditorFontScale,onChangeFamily:function(e){return n(Object(h.setPref)("codeEditorFontFamily",e))},onChangeScale:function(e){return n(Object(h.setPref)("codeEditorFontScale",e))},scaleLabel:l("dialogs.appPrefs.codeEditorFontScale")})]})}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return f}));var a=n(4),r=n(0),o=n(67),s=n(88),c=n(63),i=n(14),l=n(2),u=n(11),d=n(1),j=r.createContext({dispatch:function(){},prefs:Object(c.a)()});j.displayName="Prefs";var b=function(){return r.useContext(j)},f=function(e){var t=Object(o.a)().prefs,n=Object(s.a)().reportError,b=r.useCallback((function(e,r){var o=function(e,t){switch(t.type){case"init":return Object(l.a)(Object(l.a)({},e),t.state);case"repair":var n=Object(c.a)(),r=Object.entries(n).reduce((function(t,n){var r=Object(a.a)(n,2),o=r[0],s=r[1],c=o;return"number"===typeof s&&!Number.isFinite(e[c])||typeof s!==typeof e[c]?(console.info('Repairing preference "'.concat(o,'" by setting it to ').concat(s,", ")+"was ".concat(e[c]," (bad type)")),Object(l.a)(Object(l.a)({},t),{},Object(i.a)({},c,s))):t}),{}),o=e.proofingFormat,s=e.storyFormat,d=t.allFormats;try{Object(u.formatWithNameAndVersion)(d,o.name,o.version)}catch(f){var j=Object(u.newestFormatNamed)(d,o.name);j?(console.info("Repairing proofing format preference (version doesn't exist) by setting to ".concat(j.name," ").concat(j.version,", was ").concat(o.name," ").concat(o.version)),r.proofingFormat={name:j.name,version:j.version}):(console.info("Repairing proofing format preference (format doesn't exist at all) by setting to default ".concat(n.proofingFormat.name," ").concat(n.proofingFormat.version,", was ").concat(o.name," ").concat(o.version)),r.proofingFormat={name:n.proofingFormat.name,version:n.proofingFormat.version})}try{Object(u.formatWithNameAndVersion)(d,s.name,s.version)}catch(p){var b=Object(u.newestFormatNamed)(d,s.name);b?(console.info("Repairing story format preference (version doesn't exist) by setting to ".concat(b.name," ").concat(b.version,", was ").concat(s.name," ").concat(s.version)),r.storyFormat={name:b.name,version:b.version}):(console.info("Repairing story format preference (format doesn't exist at all) by setting to default ".concat(n.storyFormat.name," ").concat(n.storyFormat.version,", was ").concat(s.name," ").concat(o.version)),r.storyFormat={name:n.storyFormat.name,version:n.storyFormat.version})}return Object(l.a)(Object(l.a)({},e),r);case"update":return Object(l.a)(Object(l.a)({},e),{},Object(i.a)({},t.name,t.value))}}(e,r);try{t.saveMiddleware(o,r)}catch(s){n(s,"store.errors.cantPersistPrefs")}return o}),[t,n]),f=r.useReducer(b,Object(c.a)()),p=Object(a.a)(f,2),m=p[0],h=p[1];return Object(d.jsx)(j.Provider,{value:{dispatch:h,prefs:m},children:e.children})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return g}));var a=n(4),r=n(2),o=n(21),s=n.n(o),c=n(0),i=n(86),l=n.n(i),u=n(67),d=n(82),j=n(88),b=n(13),f=n(1),p=Object(d.a)().map((function(e){return Object(r.a)(Object(r.a)({},e),{},{id:s()(),loadState:"unloaded",selected:!1,userAdded:!1})})),m=c.createContext({dispatch:function(){},formats:[]});m.displayName="StoryFormats";var h=function(){return c.useContext(m)},g=function(e){var t=Object(u.a)().storyFormats,n=Object(j.a)().reportError,o=c.useCallback((function(e,a){var o=function(e,t){switch(t.type){case"init":return Object(b.a)(t.state);case"repair":var n=Object(d.a)(),a=e.filter((function(e){var t=e.userAdded||n.some((function(t){return t.name===e.name&&t.version===e.version}));return t||console.info("Repairing story formats by removing ".concat(e.name," ").concat(e.version," ")+"(outdated version of built-in format)"),t}));return n.forEach((function(e){a.some((function(t){return t.name===e.name&&t.version===e.version}))||(console.info("Repairing story formats by adding built-in ".concat(e.name," ").concat(e.version)),a.push(Object(r.a)(Object(r.a)({},e),{},{id:s()(),loadState:"unloaded",selected:!1,userAdded:!1})))})),a;case"create":return e.some((function(e){return e.name===t.props.name&&e.version===t.props.version}))?e:[].concat(Object(b.a)(e),[Object(r.a)(Object(r.a)({},t.props),{},{id:s()(),loadState:"unloaded"})]);case"delete":return e.filter((function(e){return e.id!==t.id}));case"update":return e.some((function(e){return e.id!==t.id&&e.name===t.props.name&&e.version===t.props.version}))?e:e.map((function(e){return e.id!==t.id?e:Object(r.a)(Object(r.a)({},e),t.props)}))}return e}(e,a);try{t.saveMiddleware(o,a)}catch(c){n(c,"store.errors.cantPersistStoryFormats")}return o}),[n,t]),i=l()(o,p),h=Object(a.a)(i,2),g=h[0],O=h[1];return Object(f.jsx)(m.Provider,{value:{dispatch:O,formats:g},children:e.children})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(2),r=(n(0),n(55)),o=n(5),s=n(15),c=n(27),i=n(69),l=n(47),u=n(169),d=(n(377),n(1)),j=function(e){var t=Object(r.a)().t,n=Object(l.a)();return Object(d.jsx)(c.a,Object(a.a)(Object(a.a)({},e),{},{className:"about-twine-dialog",fixedSize:!0,headerLabel:t("dialogs.aboutTwine.title",{version:n.version}),children:Object(d.jsxs)("div",{className:"content",children:[Object(d.jsx)("p",{children:t("dialogs.aboutTwine.twineDescription")}),Object(d.jsx)("p",{dangerouslySetInnerHTML:{__html:t("dialogs.aboutTwine.license")}}),Object(d.jsxs)("div",{className:"credits",children:[Object(d.jsxs)("div",{className:"code",children:[Object(d.jsx)("h3",{children:t("dialogs.aboutTwine.codeHeader")}),Object(d.jsx)("ul",{children:u.code.map((function(e){return Object(d.jsx)("li",{children:e},e)}))})]}),Object(d.jsxs)("div",{className:"localizations",children:[Object(d.jsx)("h3",{children:t("dialogs.aboutTwine.localizationHeader")}),Object(d.jsx)("ul",{children:u.localizations.map((function(e){return Object(d.jsx)("li",{children:e},e)}))})]})]}),Object(d.jsxs)(s.a,{children:[Object(d.jsx)(i.a,{href:"https://twinery.org/donate",icon:Object(d.jsx)(o.y,{}),label:t("dialogs.aboutTwine.donateToTwine"),variant:"primary"}),Object(d.jsx)(i.a,{href:"https://github.com/klembot/twinejs",icon:Object(d.jsx)(o.p,{}),label:t("dialogs.aboutTwine.codeRepo")})]})]})}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(62),o=n(43),s=n(73),c=(n(276),n(1)),i=function(){return Object(c.jsx)("div",{className:"loading-curtain",children:Object(c.jsx)(s.b,{})})},l=n(9),u=n(65),d=function(){var e=Object(l.usePrefsContext)().prefs;return a.useEffect((function(){u.a.changeLanguage(e.locale)}),[e.locale]),null},j=n(52),b=n(28),f=n(37),p=n(55),m=n(535),h=n(530),g=(n(162),function(e){var t=e.children,n=e.ignoreSelector,a=e.onClickAway;return Object(c.jsx)("div",{onClick:function(e){var t;n?(null===(t=e.target)||void 0===t?void 0:t.closest(n))||a():a()},children:t})}),O=(n(367),function(e){var t,n={gridTemplateColumns:"columnWidth"in e?"repeat(auto-fit, ".concat("number"===typeof e.columnWidth?e.columnWidth+"px":e.columnWidth,")"):"repeat(".concat(e.columns,", 1fr)"),maxWidth:null!==(t=e.maxWidth)&&void 0!==t?t:"auto"};return Object(c.jsx)("div",{className:"card-group",style:n,children:e.children})}),v=n(22),x=n.n(v),y=n(241),w=n(42),C=function(e){var t=e.title;return a.useEffect((function(){if(Object(w.a)()){var e=window.setTimeout((function(){document.querySelector("title").innerHTML=t}),0);return function(){return window.clearTimeout(e)}}}),[t]),Object(c.jsx)(y.a,{children:Object(c.jsx)("title",{children:t})})},S=(n(370),a.forwardRef((function(e,t){var n,r=e.children,o=e.grabbable,s=e.title,i=a.useRef(null),l=x()("main-content",{padded:null===(n=e.padded)||void 0===n||n});return a.useImperativeHandle(t,(function(){return i.current})),a.useEffect((function(){i.current&&i.current.focus()}),[]),a.useEffect((function(){var e,t,n=i.current;function a(a){n&&(n.scrollLeft=e.left+(t.left-a.clientX),n.scrollTop=e.top+(t.top-a.clientY))}function r(e){n&&(n.releasePointerCapture(e.pointerId),n.removeEventListener("pointerleave",r),n.removeEventListener("pointermove",a),n.style.cursor="",e.preventDefault())}function s(e){2===e.button&&r(e)}function c(o){2===o.button&&n&&(n.setPointerCapture(o.pointerId),n.addEventListener("pointerleave",r),n.addEventListener("pointermove",a),n.addEventListener("pointerup",s),n.style.cursor="grabbing",e={left:n.scrollLeft,top:n.scrollTop},t={left:o.clientX,top:o.clientY},o.preventDefault())}function l(e){e.preventDefault()}if(o&&n)return n.addEventListener("pointerdown",c),n.addEventListener("contextmenu",l),function(){n.removeEventListener("pointerdown",c),n.removeEventListener("contextmenu",l)}}),[o]),Object(c.jsxs)("div",{className:l,ref:i,children:[s&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(C,{title:s}),Object(c.jsx)("h1",{children:s})]}),r]})}))),A=n(5),k=n(11),N=(n(371),function(e){var t=e.label;return Object(c.jsx)("span",{className:"badge",children:t})}),E=n(18),F=n(2),I=n(20),P=n(78),D=(n(372),function(e){var t=e.label,n=e.onDoubleClick,r=e.onSelect,o=e.selected,s=Object(I.a)(e,["label","onDoubleClick","onSelect","selected"]),i=a.useCallback((function(e){e.ctrlKey||e.shiftKey?r(!o,!1):r(!0,!0)}),[r,o]),l=a.useCallback((function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.ctrlKey||e.shiftKey?r(!o,!1):r(!0,!0))}),[r,o]);return Object(c.jsx)("div",{className:x()("selectable-card",{selected:o}),role:"button","aria-label":t,"aria-pressed":o,onClick:i,onDoubleClick:n,onKeyDown:l,tabIndex:0,children:Object(c.jsx)(P.a,Object(F.a)({},s))})}),T=function(e){var t=e.format,n=Object(p.a)().t;return"unloaded"===t.loadState||"loading"===t.loadState?Object(c.jsx)("div",{className:"story-format-card-details",children:Object(c.jsx)("p",{children:n("components.storyFormatCard.loadingFormat")})}):"error"===t.loadState?Object(c.jsx)("div",{className:"story-format-card-details",children:Object(c.jsx)("p",{children:n("components.storyFormatCard.loadError",{errorMessage:t.loadError.message})})}):Object(c.jsxs)("div",{className:"story-format-card-details",children:[t.properties.author&&Object(c.jsx)("p",{className:"story-format-card-author",dangerouslySetInnerHTML:{__html:n("components.storyFormatCard.author",{author:t.properties.author})}}),t.properties.description&&Object(c.jsx)("div",{className:"story-format-card-description",dangerouslySetInnerHTML:{__html:t.properties.description}}),t.properties.license&&Object(c.jsx)("p",{className:"story-format-card-license",children:n("components.storyFormatCard.license",{license:t.properties.license})})]})},L=(n(373),function(e){var t=e.defaultFormat,n=e.editorExtensionsDisabled,a=e.format,r=e.onSelect,o=e.proofingFormat,i=Object(p.a)().t,l=Object(c.jsx)(c.Fragment,{});return"error"===a.loadState?l=Object(c.jsx)(A.b,{}):"unloaded"===a.loadState||"loading"===a.loadState?l=Object(c.jsx)(s.b,{}):"loaded"===a.loadState&&a.properties.image&&(l=Object(c.jsx)("img",{src:Object(k.formatImageUrl)(a),alt:""})),Object(c.jsx)("div",{className:"story-format-card",children:Object(c.jsx)(D,{label:i("components.storyFormatCard.name",{name:a.name,version:a.version}),onSelect:r,selected:a.selected,children:Object(c.jsxs)(E.b,{children:[Object(c.jsx)("div",{className:"story-format-image",children:l}),Object(c.jsxs)("div",{className:"story-format-description",children:[Object(c.jsx)("h2",{children:i("components.storyFormatCard.name",{name:a.name,version:a.version})}),Object(c.jsx)(T,{format:a})]}),Object(c.jsxs)("div",{className:"story-format-badges",children:[!a.userAdded&&Object(c.jsx)(N,{label:i("components.storyFormatCard.builtIn")}),t&&Object(c.jsx)(N,{label:i("components.storyFormatCard.defaultFormat")}),n&&Object(c.jsx)(N,{label:i("components.storyFormatCard.editorExtensionsDisabled")}),"loaded"===a.loadState&&a.properties.proofing&&Object(c.jsx)(N,{label:i("components.storyFormatCard.proofing")}),o&&Object(c.jsx)(N,{label:i("components.storyFormatCard.proofingFormat")})]})]})})})}),M=n(17),B=n(142),z=n(14),R=n(4),U=n(103),V=n(8),X=function(){var e=Object(b.f)(),t=Object(p.a)().t;return["/","/stories"].includes(e.location.pathname)?null:Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.e,{}),variant:"primary",label:e.length>1?"\uc774\uc804 \ud398\uc774\uc9c0":t("routes.storyList.titleGeneric"),onClick:function(){return e.length>1?e.goBack():e.push("/")}})},H=(n(414),function(e){var t=e.helpUrl,n=void 0===t?"https://twinery.org/2guide":t,a=e.pinnedControls,r=e.tabs,o=Object(p.a)().t;return Object(c.jsx)("div",{className:"route-toolbar",children:Object(c.jsxs)(U.d,{selectedTabClassName:"selected",children:[Object(c.jsxs)("div",{className:"route-toolbar-top",children:[Object(c.jsx)(X,{}),Object(c.jsx)(U.b,{className:"route-toolbar-tablist",children:Object.keys(r).map((function(e){return Object(c.jsx)(U.a,{className:"route-toolbar-tab",children:e},e)}))}),Object(c.jsxs)("div",{className:"route-toolbar-pinned-controls",children:[a,Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.z,{}),label:o("common.help"),onClick:function(){return window.open(n,"_blank")}})]})]}),Object(c.jsx)("div",{children:Object.entries(r).map((function(e){var t=Object(R.a)(e,2),n=t[0],a=t[1];return Object(c.jsx)(U.c,{children:a},n)}))})]})})}),W=n(7),Q=n.n(W),q=n(12),K=n(15),Y=n(48),G=n(32),J=n(49),Z=n(3),_=n(47);function $(){var e=Object(l.usePrefsContext)().prefs,t=Object(k.useStoryFormatsContext)(),n=t.dispatch,r=t.formats,o=Object(Z.useStoriesContext)().stories;return{publishArchive:a.useCallback(Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(J.b)(o,Object(_.a)()));case 1:case"end":return e.stop()}}),e)}))),[o]),proofStory:a.useCallback(function(){var t=Object(q.a)(Q.a.mark((function t(a){var s,c,i;return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=Object(Z.storyWithId)(o,a),c=Object(k.formatWithNameAndVersion)(r,e.proofingFormat.name,e.proofingFormat.version),t.next=4,Object(k.loadFormatProperties)(c)(n);case 4:if(i=t.sent){t.next=7;break}throw new Error("Couldn't load story format properties");case 7:return t.abrupt("return",Object(J.d)(s,i.source,Object(_.a)()));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[r,e.proofingFormat.name,e.proofingFormat.version,o,n]),publishStory:a.useCallback(function(){var e=Object(q.a)(Q.a.mark((function e(t,a){var s,c,i;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Object(Z.storyWithId)(o,t),c=Object(k.formatWithNameAndVersion)(r,s.storyFormat,s.storyFormatVersion),e.next=4,Object(k.loadFormatProperties)(c)(n);case 4:if(i=e.sent){e.next=7;break}throw new Error("Couldn't load story format properties");case 7:return e.abrupt("return",Object(J.d)(s,i.source,Object(_.a)(),a));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[r,o,n]),publishStoryData:a.useCallback((function(e){var t=Object(Z.storyWithId)(o,e);return Object(J.c)(t,Object(_.a)(),{startOptional:!0})}),[o])}}function ee(){var e=$(),t=e.proofStory,n=e.publishStory;if(Object(w.a)()){var a=window.twineElectron;if(!a)throw new Error("Electron bridge is not present on window.");return{playStory:function(){var e=Object(q.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a.ipcRenderer,e.next=3,n(t);case 3:e.t1=e.sent,e.t0.send.call(e.t0,"open-with-temp-file",e.t1,".html");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),proofStory:function(){var e=Object(q.a)(Q.a.mark((function e(n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a.ipcRenderer,e.next=3,t(n);case 3:e.t1=e.sent,e.t0.send.call(e.t0,"open-with-temp-file",e.t1,".html");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),testStory:function(){var e=Object(q.a)(Q.a.mark((function e(t,r){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a.ipcRenderer,e.next=3,n(t,{formatOptions:"debug",startId:r});case 3:e.t1=e.sent,e.t0.send.call(e.t0,"open-with-temp-file",e.t1,".html");case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}}return{playStory:function(){var e=Object(q.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.open("#/stories/".concat(t,"/play"),"_blank");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),proofStory:function(){var e=Object(q.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.open("#/stories/".concat(t,"/proof"),"_blank");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),testStory:function(){var e=Object(q.a)(Q.a.mark((function e(t,n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.open(n?"#/stories/".concat(t,"/test/").concat(n):"#/stories/".concat(t,"/test"),"_blank");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}}var te=n(247);function ne(e,t){var n=new Blob([e],{type:"text/html;charset=utf-8"});Object(te.saveAs)(n,t)}var ae=n(534);function re(e){return e.startPassage}function oe(e){var t=re(e),n=e.passages.find((function(e){return e.id===t}));return n?n.name:"error"}function se(e){for(var t=[],n=0;n<e.length;n++)"["==e[n].charAt(0)&&"["==e[n].charAt(1)&&t.push(e[n].replace("[[","").replace("]]",""));return t}function ce(e){var t=re(e),n=e.passages.find((function(e){return e.id===t}));return n?le(n.text):"error"}function ie(e,t){var n=e.passages.find((function(e){return e.name===t}));return n?le(n.text):"error"}function le(e){return e.split("\n")}var ue=function(e){var t,n,r,s,i,l=e.story,u=$().publishStory,d=a.useState(),j=Object(R.a)(d,2),b=j[0],f=j[1],m=a.useState(),h=Object(R.a)(m,2),g=h[0],O=h[1],v=a.useState(),x=Object(R.a)(v,2),y=x[0],w=x[1],C=a.useState(),S=Object(R.a)(C,2),k=S[0],N=S[1],F=ee(),I=F.playStory,P=F.proofStory,D=F.testStory,T=Object(p.a)().t;function L(){f(void 0),O(void 0),w(void 0),N(void 0)}function M(){return(M=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}throw new Error("No story provided to publish");case 2:return L(),e.prev=3,e.next=6,I(l.id);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),f(e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})))).apply(this,arguments)}function B(){return(B=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}throw new Error("No story provided to publish");case 2:return L(),e.prev=3,e.next=6,P(l.id);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),O(e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})))).apply(this,arguments)}function z(){return(z=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}throw new Error("No story provided to publish");case 2:return L(),e.prev=3,e.t0=ne,e.next=7,u(l.id);case 7:e.t1=e.sent,e.t2=Object(G.storyFileName)(l),(0,e.t0)(e.t1,e.t2),e.next=15;break;case 12:e.prev=12,e.t3=e.catch(3),w(e.t3);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})))).apply(this,arguments)}function U(){return(U=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}throw new Error("No story provided to publish");case 2:return L(),e.prev=3,e.next=6,D(l.id);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),w(e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})))).apply(this,arguments)}function X(e,t,n){return H.apply(this,arguments)}function H(){return H=Object(q.a)(Q.a.mark((function e(t,n,a){var r,o,s,c,i,u,d,j,b;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j=Q.a.mark((function e(n){var j;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j=ie(l,t[n]),r="0",o="0",s="0",c="0",i="0",u="0",d="0",e.t0=j[0],e.next="health"===e.t0?11:"money"===e.t0?13:"hungry"===e.t0?15:"strength"===e.t0?17:"agility"===e.t0?19:"armour"===e.t0?21:"mental"===e.t0?23:25;break;case 11:return r=j[1],e.abrupt("break",25);case 13:return o=j[1],e.abrupt("break",25);case 15:return s=j[1],e.abrupt("break",25);case 17:return c=j[1],e.abrupt("break",25);case 19:return i=j[1],e.abrupt("break",25);case 21:return u=j[1],e.abrupt("break",25);case 23:return d=j[1],e.abrupt("break",25);case 25:return e.prev=25,e.next=28,ae.a.post("http://localhost:3001/game_play/option",{episode:a,text:t[n],result_text:j[2],health_change:r,money_change:o,hungry_change:s,strength_change:c,agility_change:i,armour_change:u,mental_change:d}).then((function(e){console.log(e.data),console.log(t[n])})).catch((function(e){console.log(e)}));case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(25),console.log(e.t1);case 33:case"end":return e.stop()}}),e,null,[[25,30]])})),b=0;case 2:if(!(b<t.length)){e.next=7;break}return e.delegateYield(j(b),"t0",4);case 4:b++,e.next=2;break;case 7:case"end":return e.stop()}}),e)}))),H.apply(this,arguments)}function W(){return W=Object(q.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}throw new Error("No story provided to publish");case 2:L();try{t=ce(l),ae.a.post("http://localhost:3001/game_play",{genre:1,title:oe(l),mainText:t[0]}).then((function(e){var n=se(t),a=e.data;X(n,t,a),alert("\uc5d0\ud53c\uc18c\ub4dc \uc0dd\uc131 \uc131\uacf5")})).catch((function(e){console.log(e)}))}catch(o){N(o)}case 4:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}return Object(c.jsxs)(K.a,{children:[Object(c.jsx)(Y.a,{ariaLabel:null!==(t=null===k||void 0===k?void 0:k.message)&&void 0!==t?t:"",disabled:!l,icon:Object(c.jsx)(A.S,{}),label:T("routeActions.build.test"),onChangeOpen:function(){return N(void 0)},onClick:function(){return U.apply(this,arguments)},open:!!k,children:Object(c.jsxs)(E.b,{children:[Object(c.jsx)("p",{children:null===k||void 0===k?void 0:k.message}),Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.V,{}),label:T("common.close"),onClick:function(){return N(void 0)},variant:"primary"})]})}),Object(c.jsx)(Y.a,{ariaLabel:null!==(n=null===b||void 0===b?void 0:b.message)&&void 0!==n?n:"",disabled:!l,icon:Object(c.jsx)(A.F,{}),label:T("routeActions.build.play"),onChangeOpen:function(){return f(void 0)},onClick:function(){return M.apply(this,arguments)},open:!!b,children:Object(c.jsxs)(E.b,{children:[Object(c.jsx)("p",{children:null===b||void 0===b?void 0:b.message}),Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.V,{}),label:T("common.close"),onClick:function(){return f(void 0)},variant:"primary"})]})}),Object(c.jsx)(Y.a,{ariaLabel:null!==(r=null===g||void 0===g?void 0:g.message)&&void 0!==r?r:"",disabled:!l,icon:Object(c.jsx)(A.t,{}),label:T("routeActions.build.proof"),onChangeOpen:function(){return O(void 0)},onClick:function(){return B.apply(this,arguments)},open:!!g,children:Object(c.jsxs)(E.b,{children:[Object(c.jsx)("p",{children:null===g||void 0===g?void 0:g.message}),Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.V,{}),label:T("common.close"),onClick:function(){return O(void 0)},variant:"primary"})]})}),Object(c.jsx)(Y.a,{ariaLabel:null!==(s=null===y||void 0===y?void 0:y.message)&&void 0!==s?s:"",disabled:!l,icon:Object(c.jsx)(A.w,{}),label:T("routeActions.build.publishToFile"),onChangeOpen:function(){return w(void 0)},onClick:function(){return z.apply(this,arguments)},open:!!y,children:Object(c.jsxs)(E.b,{children:[Object(c.jsx)("p",{children:null===y||void 0===y?void 0:y.message}),Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.V,{}),label:T("common.close"),onClick:function(){return w(void 0)},variant:"primary"})]})}),Object(c.jsx)(Y.a,{ariaLabel:null!==(i=null===y||void 0===y?void 0:y.message)&&void 0!==i?i:"",disabled:!l,icon:Object(c.jsx)(A.r,{}),label:"\uc800\uc7a5\ud558\uae30",onChangeOpen:function(){return w(void 0)},onClick:function(){return W.apply(this,arguments)},open:!!y,children:Object(c.jsxs)(E.b,{children:[Object(c.jsx)("p",{children:null===y||void 0===y?void 0:y.message}),Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.V,{}),label:T("common.close"),onClick:function(){return w(void 0)},variant:"primary"})]})})]})},de=function(){var e=Object(M.useDialogsContext)().dispatch,t=Object(b.f)(),n=Object(p.a)().t;return Object(c.jsxs)(K.a,{children:[Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.M,{}),label:n("routeActions.app.preferences"),onClick:function(){return e({type:"addDialog",component:M.AppPrefsDialog})}}),Object(c.jsx)(V.a,{disabled:"/story-formats"===t.location.pathname,icon:Object(c.jsx)(A.u,{}),label:n("routeActions.app.storyFormats"),onClick:function(){return t.push("/story-formats")}}),Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.i,{}),label:n("routeActions.app.aboutApp"),onClick:function(){return e({type:"addDialog",component:M.AboutTwineDialog})}}),Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.k,{}),label:n("routeActions.app.reportBug"),onClick:function(){return window.open("https://twinery.org/2bugs","_blank")}})]})},je=n(57),be=n(45);n(419);function fe(e){try{return new URL(e),!0}catch(t){}return!1}var pe=function(){var e=Object(k.useStoryFormatsContext)(),t=e.dispatch,n=e.formats,r=a.useState(""),o=Object(R.a)(r,2),s=o[0],i=o[1],l=Object(p.a)().t;function u(){return(u=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.t1=k.createFromProperties,e.t2=s,e.next=5,Object(be.a)(s);case 5:e.t3=e.sent,e.t4=(0,e.t1)(e.t2,e.t3),(0,e.t0)(e.t4);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var d=function(){var e=Object(q.a)(Q.a.mark((function e(t){var a;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==s.trim()){e.next=2;break}return e.abrupt("return",{valid:!1});case 2:if(fe(s)){e.next=4;break}return e.abrupt("return",{message:l("routes.storyFormatList.toolbar.addStoryFormatButton.invalidUrl"),valid:!1});case 4:return e.prev=4,e.next=7,Object(be.a)(s);case 7:if(a=e.sent,!n.some((function(e){return e.name===a.name&&e.version===a.version}))){e.next=10;break}return e.abrupt("return",{message:l("routes.storyFormatList.toolbar.addStoryFormatButton.alreadyAdded",{storyFormatName:a.name,storyFormatVersion:a.version}),valid:!1});case 10:return e.abrupt("return",{message:l("routes.storyFormatList.toolbar.addStoryFormatButton.addPreview",{storyFormatName:a.name,storyFormatVersion:a.version}),valid:!0});case 13:return e.prev=13,e.t0=e.catch(4),e.abrupt("return",{message:l("routes.storyFormatList.toolbar.addStoryFormatButton.fetchError",{errorMessage:e.t0.message}),valid:!1});case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(c.jsx)("span",{className:"add-format-button",children:Object(c.jsx)(je.a,{icon:Object(c.jsx)(A.G,{}),label:l("common.add"),onChange:function(e){return i(e.target.value)},onSubmit:function(){return u.apply(this,arguments)},prompt:l("routes.storyFormatList.toolbar.addStoryFormatButton.prompt"),submitIcon:Object(c.jsx)(A.G,{}),submitLabel:l("common.add"),submitVariant:"create",validate:d,value:s})})},me=function(e){var t=e.format,n=Object(l.usePrefsContext)(),a=n.dispatch,r=n.prefs,o=Object(p.a)().t,s="loaded"!==(null===t||void 0===t?void 0:t.loadState)||t.properties.proofing||r.storyFormat.name===t.name&&r.storyFormat.version===t.version;return Object(c.jsx)(V.a,{disabled:s,icon:Object(c.jsx)(A.P,{}),label:o("routes.storyFormatList.toolbar.useAsDefaultFormat"),onClick:function(){if(!t)throw new Error("Can't set undefined format as default");a({type:"update",name:"storyFormat",value:{name:t.name,version:t.version}})}})},he=function(e){var t=e.format,n=Object(l.usePrefsContext)(),a=n.dispatch,r=n.prefs,o=Object(p.a)().t,s="loaded"!==(null===t||void 0===t?void 0:t.loadState)||!t.properties.proofing||r.proofingFormat.name===t.name&&r.proofingFormat.version===t.version;return Object(c.jsx)(V.a,{disabled:s,icon:Object(c.jsx)(A.t,{}),label:o("routes.storyFormatList.toolbar.useAsProofingFormat"),onClick:function(){if(!t)throw new Error("Can't set undefined format as proofing");a({type:"update",name:"proofingFormat",value:{name:t.name,version:t.version}})}})},ge=function(e){var t=e.format,n=Object(k.useStoryFormatsContext)().dispatch,a=Object(l.usePrefsContext)().prefs,r=Object(p.a)().t,o=(null===t||void 0===t?void 0:t.name)===a.storyFormat.name&&(null===t||void 0===t?void 0:t.version)===a.storyFormat.version,s=(null===t||void 0===t?void 0:t.name)===a.proofingFormat.name&&(null===t||void 0===t?void 0:t.version)===a.proofingFormat.version;return Object(c.jsx)(V.a,{disabled:!t||!t.userAdded||o||s,icon:Object(c.jsx)(A.T,{}),label:r("common.remove"),onClick:function(){return t&&n(Object(k.deleteFormat)(t))}})},Oe=n(13),ve=function(e){var t=e.format,n=Object(l.usePrefsContext)(),a=n.dispatch,r=n.prefs,o=Object(p.a)().t,s=r.disabledStoryFormatEditorExtensions.some((function(e){return e.name===(null===t||void 0===t?void 0:t.name)&&e.version===(null===t||void 0===t?void 0:t.version)}));return Object(c.jsx)(V.a,{disabled:!t,icon:Object(c.jsx)(A.H,{}),label:o("routes.storyFormatList.toolbar.".concat(s?"enable":"disable","FormatExtensions")),onClick:function(){if(!t)throw new Error("Format is not set");a(s?Object(l.setPref)("disabledStoryFormatEditorExtensions",r.disabledStoryFormatEditorExtensions.filter((function(e){return e.name!==t.name||e.version!==t.version}))):Object(l.setPref)("disabledStoryFormatEditorExtensions",[].concat(Object(Oe.a)(r.disabledStoryFormatEditorExtensions),[{name:t.name,version:t.version}])))}})},xe=function(e){var t=e.selectedFormats,n=1===t.length?t[0]:void 0;return Object(c.jsxs)(K.a,{children:[Object(c.jsx)(pe,{}),Object(c.jsx)(ge,{format:n}),Object(c.jsx)(ve,{format:n}),Object(c.jsx)(me,{format:n}),Object(c.jsx)(he,{format:n})]})},ye=n(35),we=function(){var e=Object(l.usePrefsContext)(),t=e.dispatch,n=e.prefs,a=Object(p.a)().t;function r(e){t(Object(l.setPref)("storyFormatListFilter",e))}return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(ye.a,{disabled:"current"===n.storyFormatListFilter,label:a("routes.storyFormatList.title.current"),onChange:function(){return r("current")},value:"current"===n.storyFormatListFilter}),Object(c.jsx)(ye.a,{disabled:"user"===n.storyFormatListFilter,label:a("routes.storyFormatList.title.user"),onChange:function(){return r("user")},value:"user"===n.storyFormatListFilter}),Object(c.jsx)(ye.a,{disabled:"all"===n.storyFormatListFilter,label:a("routes.storyFormatList.title.all"),onChange:function(){return r("all")},value:"all"===n.storyFormatListFilter})]})},Ce=function(e){var t,n=e.selectedFormats,a=Object(p.a)().t;return Object(c.jsx)(H,{tabs:(t={},Object(z.a)(t,a("common.storyFormat"),Object(c.jsx)(xe,{selectedFormats:n})),Object(z.a)(t,a("common.view"),Object(c.jsx)(we,{})),Object(z.a)(t,a("common.appName"),Object(c.jsx)(de,{})),t)})},Se=function(){var e=Object(k.useStoryFormatsContext)(),t=e.dispatch,n=e.formats,r=Object(l.usePrefsContext)(),o=r.dispatch,s=r.prefs,i=Object(p.a)().t,u=n.filter((function(e){return e.selected})),d=Object(k.sortFormats)(Object(k.filteredFormats)(n,s.storyFormatListFilter));return a.useEffect((function(){var e,n=Object(f.a)(u);try{for(n.s();!(e=n.n()).done;){var a=e.value;a.selected&&!d.includes(a)&&t(Object(k.deselectFormat)(a))}}catch(r){n.e(r)}finally{n.f()}}),[o,u,d,t]),Object(c.jsx)("div",{className:"story-format-list-route",children:Object(c.jsxs)(M.DialogsContextProvider,{children:[Object(c.jsx)(Ce,{selectedFormats:u}),Object(c.jsx)(g,{ignoreSelector:".story-format-card",onClickAway:function(){return t(Object(k.deselectAllFormats)())},children:Object(c.jsxs)(S,{title:i("routes.storyFormatList.title.".concat(s.storyFormatListFilter)),children:[Object(c.jsx)("p",{children:i(d.length>0?"routes.storyFormatList.storyFormatExplanation":"routes.storyFormatList.noneVisible")}),Object(c.jsx)(B.a,{children:Object(c.jsx)(O,{columnWidth:"450px",children:Object(c.jsx)(m.a,{component:null,children:d.map((function(e){return Object(c.jsx)(h.a,{classNames:"pop",timeout:200,children:Object(c.jsx)(L,{defaultFormat:e.name===s.storyFormat.name&&e.version===s.storyFormat.version,editorExtensionsDisabled:s.disabledStoryFormatEditorExtensions.some((function(t){return e.name===t.name&&e.version===t.version})),format:e,onSelect:function(){return function(e){t(Object(k.selectFormat)(e,!0))}(e)},proofingFormat:e.name===s.proofingFormat.name&&e.version===s.proofingFormat.version})},e.id)}))})})})]})})]})})},Ae=n(23),ke=n(136),Ne=function(e){var t=e.getCenter,n=e.story,r=Object(Ae.useUndoableStoriesContext)().dispatch,o=a.useCallback((function(){var e=t(),a=e.left,o=e.top;r(Object(Z.createUntitledPassage)(n,a,o),"undoChange.newPassage")}),[r,t,n]),s=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.G,{}),label:s("common.new"),onClick:o})},Ee=n(102),Fe=function(e){var t=e.passages,n=e.story,r=Object(Ae.useUndoableStoriesContext)().dispatch,o=Object(p.a)().t,s=a.useMemo((function(){return 0===t.length||t.some((function(e){return n.startPassage===e.id}))}),[t,n.startPassage]),i=a.useCallback((function(){0!==t.length&&r(Object(Z.deletePassages)(n,t),t.length>1?"undoChange.deletePassages":"undoChange.deletePassage")}),[r,t,n]);return Object(Ee.a)("Backspace,Delete",i,[i]),Object(c.jsx)(V.a,{disabled:s,icon:Object(c.jsx)(A.T,{}),label:!s&&t.length>1?o("common.deleteCount",{count:t.length}):o("common.delete"),onClick:i})},Ie=function(e){var t=e.passages,n=e.story,a=Object(M.useDialogsContext)().dispatch,r=Object(p.a)().t;return Object(c.jsx)(V.a,{disabled:0===t.length,icon:Object(c.jsx)(A.s,{}),label:t.length>1?r("common.editCount",{count:t.length}):r("common.edit"),onClick:function(){a((function(e){return t.forEach((function(t){return e({type:"addDialog",component:M.PassageEditDialog,props:{passageId:t.id,storyId:n.id}})}))}))}})},Pe=function(e){var t=e.story,n=Object(Z.useStoriesContext)().dispatch,a=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.D,{}),label:a("common.selectAll"),onClick:function(){return n(Object(Z.selectAllPassages)(t))}})},De=function(e){var t=e.passage,n=e.story,a=Object(Z.useStoriesContext)(),r=a.dispatch,o=a.stories,s=Object(p.a)().t;return Object(c.jsx)(V.a,{disabled:!t||t.id===n.startPassage,icon:Object(c.jsx)(A.K,{}),label:s("routes.storyEdit.toolbar.startStoryHere"),onClick:function(){if(!t)throw new Error("No passage set");r(Object(Z.updateStory)(o,n,{startPassage:t.id}))}})},Te=function(e){var t=e.passage,n=e.story,a=ee().testStory,r=Object(p.a)().t;return Object(c.jsx)(V.a,{disabled:!t,icon:Object(c.jsx)(A.S,{}),label:r("routes.storyEdit.toolbar.testFromHere"),onClick:function(){return a(n.id,null===t||void 0===t?void 0:t.id)}})},Le=function(e){var t=e.getCenter,n=e.story,r=Object(Z.useStoriesContext)().dispatch,o=a.useMemo((function(){return n.passages.filter((function(e){return e.selected}))}),[n.passages]),s=a.useMemo((function(){return 1===o.length?o[0]:void 0}),[o]);return Object(c.jsxs)(K.a,{children:[Object(c.jsx)(Ne,{getCenter:t,story:n}),Object(c.jsx)(Ie,{passages:o,story:n}),Object(c.jsx)(ke.a,{onRename:function(e){return function(e,t){if(!t)throw new Error("Passage is unset");r(Object(Z.updatePassage)(n,t,{name:e},{dontUpdateOthers:!0}))}(e,s)},passage:s,story:n}),Object(c.jsx)(Fe,{passages:o,story:n}),Object(c.jsx)(Te,{passage:s,story:n}),Object(c.jsx)(De,{passage:s,story:n}),Object(c.jsx)(Pe,{story:n})]})},Me=function(){var e=Object(p.a)().t;return Object(c.jsx)(V.a,{disabled:!0,icon:Object(c.jsx)(A.U,{}),label:e("common.rename")})},Be=function(e){var t=e.existingStories,n=e.onRename,r=e.story,o=a.useState(r.name),s=Object(R.a)(o,2),i=s[0],l=s[1],u=Object(p.a)().t;return a.useEffect((function(){return l(r.name)}),[r]),Object(c.jsx)(je.a,{icon:Object(c.jsx)(A.U,{}),label:u("common.rename"),onChange:function(e){return l(e.target.value)},onSubmit:n,prompt:u("common.renamePrompt",{name:r.name}),validate:function(e){return""===e.trim()?{message:u("components.renameStoryButton.emptyName"),valid:!1}:t.some((function(t){return t.id!==r.id&&Object(G.storyFileName)(t)===Object(G.storyFileName)(Object(F.a)(Object(F.a)({},r),{},{name:e}))}))?{message:u("components.renameStoryButton.nameAlreadyUsed"),valid:!1}:{valid:!0}},value:i})},ze=function(e){return e.story?Object(c.jsx)(Be,Object(F.a)({},e)):Object(c.jsx)(Me,{})},Re=function(e){var t=e.story,n=Object(M.useDialogsContext)().dispatch,a=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.C,{}),label:a("common.details"),onClick:function(){return n({type:"addDialog",component:M.StoryDetailsDialog,props:{storyId:t.id}})}})},Ue=function(e){var t=e.story,n=Object(M.useDialogsContext)().dispatch,a=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.L,{}),label:a("routes.storyEdit.toolbar.findAndReplace"),onClick:function(){return n({type:"addDialog",component:M.StorySearchDialog,props:{storyId:t.id}})}})},Ve=function(e){var t=e.story,n=Object(M.useDialogsContext)().dispatch,a=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.j,{}),label:a("routes.storyEdit.toolbar.javaScript"),onClick:function(){return n({type:"addDialog",component:M.StoryJavaScriptDialog,props:{storyId:t.id}})}})},Xe=function(e){var t=e.story,n=Object(M.useDialogsContext)().dispatch,a=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.R,{}),label:a("routes.storyEdit.toolbar.passageTags"),onClick:function(){return n({type:"addDialog",component:M.PassageTagsDialog,props:{storyId:t.id}})}})},He=function(e){var t=e.story,n=Object(M.useDialogsContext)().dispatch,a=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.x,{}),label:a("routes.storyEdit.toolbar.stylesheet"),onClick:function(){return n({type:"addDialog",component:M.StoryStylesheetDialog,props:{storyId:t.id}})}})},We=function(e){var t=Object(Z.useStoriesContext)(),n=t.dispatch,a=t.stories,r=e.story;return Object(c.jsxs)(K.a,{children:[Object(c.jsx)(Ue,{story:r}),Object(c.jsx)(ze,{existingStories:a,onRename:function(e){return n(Object(Z.updateStory)(a,r,{name:e}))},story:r}),Object(c.jsx)(Re,{story:r}),Object(c.jsx)(Xe,{story:r}),Object(c.jsx)(Ve,{story:r}),Object(c.jsx)(He,{story:r})]})},Qe=function(){var e=Object(Ae.useUndoableStoriesContext)(),t=e.redo,n=e.redoLabel,a=e.undo,r=e.undoLabel;Object(p.a)().t;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(V.a,{disabled:!a,icon:Object(c.jsx)(A.c,{}),label:null!==r&&void 0!==r?r:"\ub418\ub3cc\ub9ac\uae30",onClick:a}),Object(c.jsx)(V.a,{disabled:!t,icon:Object(c.jsx)(A.d,{}),label:null!==n&&void 0!==n?n:"\uc55e\uc73c\ub85c",onClick:t})]})},qe=function(e){var t,n=e.getCenter,a=e.story;return Object(c.jsx)(H,{pinnedControls:Object(c.jsx)(Qe,{}),tabs:(t={},Object(z.a)(t,"\uc2a4\ud1a0\ub9ac Box",Object(c.jsx)(Le,{getCenter:n,story:a})),Object(z.a)(t,"\uc5d0\ud53c\uc18c\ub4dc",Object(c.jsx)(We,{story:a})),Object(z.a)(t,"\ube4c\ub4dc",Object(c.jsx)(ue,{story:a})),Object(z.a)(t,"Twine \uc124\uc815",Object(c.jsx)(de,{})),t)})},Ke=(n(420),n(250));function Ye(e,t){var n=a.useState(e),r=Object(R.a)(n,2),o=r[0],s=r[1],c=a.useRef(),i=a.useCallback((function(){c.current&&window.requestAnimationFrame((function(e){var t=c.current;if(t.lastTimestamp){t.elapsed+=(e-t.lastTimestamp)/500,t.lastTimestamp=e;var n=function(e,t,n,a){var r;if(a<1)return e(r=t+n*Object(Ke.quadOut)(a)),r;e(t+n)}(s,t.zoom.start,t.zoom.change,t.elapsed);if(n){var a=t.scrollNormalizedCenter.left*n-t.scrollCenter.width,r=t.scrollNormalizedCenter.top*n-t.scrollCenter.height;a>=0&&r>=0&&(t.scrollTarget.scrollLeft=a,t.scrollTarget.scrollTop=r),i()}else c.current=void 0}else t.lastTimestamp=e,i()}))}),[]);return a.useEffect((function(){!c.current&&o!==e&&t&&(c.current={scrollTarget:t,elapsed:0,scrollNormalizedCenter:{left:(t.scrollLeft+t.clientWidth/2)/o,top:(t.scrollTop+t.clientHeight/2)/o},scrollCenter:{height:t.clientHeight/2,width:t.clientWidth/2},zoom:{start:o,change:e-o}},window.requestAnimationFrame(i))}),[o,t,i,e]),o}var Ge=n(29),Je=(n(451),function(e){var t=e.container,n=e.ignoreEventsOnSelector,r=e.onSelectRect,o=e.onTemporarySelectRect,s=a.useState(!1),i=Object(R.a)(s,2),l=i[0],u=i[1],d=a.useState(!1),j=Object(R.a)(d,2),b=j[0],f=j[1],p=a.useState(),m=Object(R.a)(p,2),h=m[0],g=m[1],O=a.useState(),v=Object(R.a)(O,2),x=v[0],y=v[1];a.useEffect((function(){var e,a=t.current;function r(t){return{left:t.clientX-e.left+a.scrollLeft,top:t.clientY-e.top+a.scrollTop}}function o(e){a&&(a.releasePointerCapture(e.pointerId),a.removeEventListener("pointermove",s),a.removeEventListener("pointerup",o),f(!1))}function s(e){y(r(e))}function c(t){"touch"!==t.pointerType&&0===t.button&&a&&(n&&t.target.closest(n)||(e=a.getBoundingClientRect(),a.setPointerCapture(t.pointerId),a.addEventListener("pointermove",s),a.addEventListener("pointerup",o),u(!(!t.shiftKey&&!t.ctrlKey)),f(!0),g(r(t)),y(r(t))))}if(a)return a.addEventListener("pointerdown",c),function(){return a.removeEventListener("pointerdown",c)}}),[t,n]),a.useEffect((function(){h&&x&&(b?o(Object(Ge.e)(h,x),l):(r(Object(Ge.e)(h,x),l),g(void 0),y(void 0)))}),[l,x,b,r,o,h]);var w=a.useMemo((function(){if(!h||!x)return{};var e=Object(Ge.e)(h,x);return{transform:"translate(".concat(e.left,"px, ").concat(e.top,"px) scale(").concat(e.width/100,", ").concat(e.height/100,")")}}),[x,h]);return h&&x?Object(c.jsx)("div",{className:"marquee-selection",style:w}):null}),Ze=(n(452),25*Math.sqrt(2)),_e=function(e){var t=e.offset,n=e.passage,a={left:n.left,top:n.top};return n.selected&&(a.left+=t.left,a.top+=t.top),Object(c.jsx)("line",{className:"broken-connection",x1:a.left+n.width,y1:a.top+n.height,x2:a.left+n.width+Ze,y2:a.top+n.height+Ze,style:{markerEnd:"url(#link-broken)"}})};function $e(e){var t=e.start,n=e.end,a=e.radius,r=e.largeArc,o=e.sweep,s=e.rotation;return"M"+t.left+","+t.top+" A"+a.left+","+a.top+" "+(null!==s&&void 0!==s?s:"0")+(r?" 1":" 0")+(o?" 1 ":" 0 ")+n.left+","+n.top}n(453);var et=function(e){var t=e.end,n=e.offset,r=e.start,o=e.variant,s=a.useMemo((function(){var e=r,a=t;r.selected&&(e=Object(F.a)(Object(F.a)({},r),{},{left:r.left+n.left,top:r.top+n.top})),t.selected&&(a=Object(F.a)(Object(F.a)({},t),{},{left:t.left+n.left,top:t.top+n.top}));var o=Object(Ge.d)(e),s=Object(Ge.d)(a);if(!(o=Object(Ge.f)(e,o,s)))return"";if(!(s=Object(Ge.f)(a,o,s)))return"";var c=Object(Ge.c)(o,s),i=o.left<s.left;return o.left===s.left&&o.top<s.top&&(i=!0),$e({start:o,end:s,radius:{left:c,top:.75*c},rotation:Object(Ge.b)(o,s),sweep:i})}),[t,n.left,n.top,r]);return Object(c.jsx)("path",{d:s,className:"passage-connection variant-".concat(o),style:{markerEnd:"url(#link-arrowhead)"}})},tt=(n(454),function(e){var t=e.offset,n=e.passage,r=e.variant,o={left:n.left,top:n.top};n.selected&&(o.left+=t.left,o.top+=t.top);var s=a.useMemo((function(){return.4*Math.min(n.width,n.height)}),[n.height,n.width]),i=a.useMemo((function(){return $e({start:{left:o.left,top:o.top+n.height/2},end:{left:o.left,top:o.top},radius:{left:s,top:s},sweep:!0,largeArc:!0})}),[n.height,s,o.left,o.top]);return Object(c.jsx)("path",{className:"self-connection variant-".concat(r),d:i,style:{markerEnd:"url(#link-arrowhead)"}})}),nt=a.memo((function(e){var t=e.broken,n=e.connections,a=e.offset,r=e.self,o=e.variant,s=void 0===o?"link":o;return Object(c.jsxs)(c.Fragment,{children:[Array.from(n).map((function(e){return Array.from(e[1]).map((function(t){return Object(c.jsx)(et,{end:t,offset:a,start:e[0],variant:s},e[0].name+t.name)}))})),Array.from(r).map((function(e){return Object(c.jsx)(tt,{offset:a,passage:e,variant:s},e.name)})),Array.from(t).map((function(e){return Object(c.jsx)(_e,{offset:a,passage:e},e.name)}))]})}));nt.displayName="PassageConnectionGroup";n(455);var at=function(){return Object(c.jsxs)("defs",{children:[Object(c.jsx)("marker",{id:"link-arrowhead",refX:"6",refY:"4",markerWidth:"8",markerHeight:"8",orient:"auto",children:Object(c.jsx)("path",{d:"M 1,1 7,4 1,7 Z"})}),Object(c.jsxs)("marker",{id:"link-broken",refX:"7.5",refY:"7.5",markerWidth:"15",markerHeight:"15",children:[Object(c.jsx)("circle",{cx:"7.5",cy:"7.5",r:"7.5"}),Object(c.jsx)("path",{d:"M4.5 7.5h 6z"})]}),Object(c.jsxs)("marker",{id:"link-start",markerWidth:"15",markerHeight:"15",refX:"16",refY:"16",viewBox:"0 0 32 32",children:[Object(c.jsx)("circle",{cx:"16",cy:"16",r:"16"}),Object(c.jsx)("path",{d:"M8 17a8 8 0 0 1 7 7a6 6 0 0 0 3 -5a9 9 0 0 0 6 -8a3 3 0 0 0 -3 -3a9 9 0 0 0 -8 6a6 6 0 0 0 -5 3"}),Object(c.jsx)("path",{d:"M11 18a6 6 0 0 0 -3 6a6 6 0 0 0 6 -3"}),Object(c.jsx)("circle",{className:"fill-white",cx:"19",cy:"13",r:"1"})]})]})},rt=(n(456),a.memo((function(e){var t=e.offset,n=e.passage,a={left:n.left,top:n.top};return n.selected&&(a.left+=t.left,a.top+=t.top),Object(c.jsx)("line",{className:"start-connection",x1:a.left-50,y1:a.top+n.height/2,x2:a.left,y2:a.top+n.height/2,style:{markerStart:"url(#link-start)"}})})));rt.displayName="StartConnection";var ot=n(89),st=function(){return[]};var ct=new Set,it={left:0,top:0},lt=function(e){var t=e.formatName,n=e.formatVersion,r=e.offset,o=e.passages,s=e.startPassageId,i=function(e,t){var n,r,o=Object(l.usePrefsContext)().prefs,s=Object(k.useStoryFormatsContext)(),c=s.dispatch,i=s.formats,u=Object(k.formatWithNameAndVersion)(i,e,t),d=a.useState(),j=Object(R.a)(d,2),b=j[0],f=j[1],p=Object(l.formatEditorExtensionsDisabled)(o,e,t);return a.useEffect((function(){p||("unloaded"===u.loadState?c(Object(k.loadFormatProperties)(u)):"loaded"===u.loadState&&f(Object(be.b)(u,ot.a)))}),[c,p,u]),p?st:null!==(n=null===b||void 0===b||null===(r=b.references)||void 0===r?void 0:r.parsePassageText)&&void 0!==n?n:st}(t,n),u=a.useMemo((function(){return Object(Z.passageConnections)(o)}),[o]),d=u.draggable,j=u.fixed,b=a.useMemo((function(){return Object(Z.passageConnections)(o,i)}),[o,i]),f=b.draggable,p=b.fixed,m=a.useMemo((function(){return o.find((function(e){return e.id===s}))}),[o,s]);return Object(c.jsxs)("svg",{className:"link-connectors",children:[Object(c.jsx)(at,{}),m&&Object(c.jsx)(rt,{offset:r,passage:m}),Object(c.jsx)(nt,Object(F.a)(Object(F.a)({},d),{},{offset:r})),Object(c.jsx)(nt,Object(F.a)(Object(F.a)({},j),{},{offset:it})),Object(c.jsx)(nt,{broken:ct,connections:f.connections,offset:r,self:ct,variant:"reference"}),Object(c.jsx)(nt,{broken:ct,connections:p.connections,offset:it,self:ct,variant:"reference"})]})},ut=n(252),dt=n(251),jt=n(126),bt=(n(460),a.memo((function(e){var t=e.onDeselect,n=e.onDrag,r=e.onDragStart,o=e.onDragStop,s=e.onEdit,i=e.onSelect,l=e.passage,u=e.tagColors,d=Object(p.a)().t,j=a.useMemo((function(){return x()("passage-card",{empty:""===l.text&&0===l.tags.length,selected:l.selected})}),[l.selected,l.tags.length,l.text]),b=a.useRef(null),f=a.useMemo((function(){return l.text.length>0?l.text.substring(0,400):Object(c.jsx)("span",{className:"placeholder",children:d("touchOnly"===ut.a?"components.passageCard.placeholderTouch":"components.passageCard.placeholderClick")})}),[l.text,d]),m=a.useMemo((function(){return{height:l.height,left:l.left,top:l.top,width:l.width}}),[l.height,l.left,l.top,l.width]),h=a.useCallback((function(e){e.shiftKey||e.ctrlKey?l.selected?t(l):i(l,!1):l.selected||i(l,!0)}),[t,i,l]),g=a.useCallback((function(){return s(l)}),[s,l]),O=a.useCallback((function(e,t){i(l,t)}),[i,l]);return Object(c.jsx)(dt.DraggableCore,{nodeRef:b,onMouseDown:h,onStart:r,onDrag:n,onStop:o,children:Object(c.jsx)("div",{className:j,ref:b,style:m,children:Object(c.jsxs)(D,{highlighted:l.highlighted,label:l.name,onDoubleClick:g,onSelect:O,selected:l.selected,children:[Object(c.jsx)(jt.a,{tagColors:u,tags:l.tags}),Object(c.jsx)("h2",{children:l.name}),Object(c.jsx)(E.b,{children:f})]})})})})));bt.displayName="PassageCard";n(461);var ft=a.memo((function(e){var t=e.passages,n=a.useMemo((function(){return Object(Oe.a)(t).sort((function(e,t){return e.top!==t.top?e.top-t.top:e.left-t.left}))}),[t]);return Object(c.jsx)(m.a,{component:null,children:n.map((function(t){return Object(c.jsx)(h.a,{classNames:"pop",timeout:200,children:Object(c.jsx)(bt,Object(F.a)({passage:t},e))},t.id)}))})}));ft.displayName="PassageCardGroup";n(462);function pt(e,t){switch(t.type){case"start":return{dragging:!0,dragX:t.x,dragY:t.y,startX:t.x,startY:t.y};case"move":return Object(F.a)(Object(F.a)({},e),{},{dragX:t.x,dragY:t.y});case"stop":return Promise.resolve().then((function(){return t.callback({left:e.dragX-e.startX,top:e.dragY-e.startY})})),{dragging:!1,dragX:0,dragY:0,startX:0,startY:0}}}var mt=function(e){var t=e.formatName,n=e.formatVersion,r=e.onDeselect,o=e.onDrag,s=e.onEdit,i=e.onSelect,l=e.passages,u=e.startPassageId,d=e.tagColors,j=e.visibleZoom,b=e.zoom,f=a.useState(j<=.6),p=Object(R.a)(f,2),m=p[0],h=p[1],g=a.useRef(null),O=a.useMemo((function(){return Object(Ge.a)([].concat(Object(Oe.a)(l),[{top:0,left:0,width:0,height:0}]))}),[l]),v=a.useMemo((function(){return{height:"calc(".concat(O.height,"px + max(50vh, ").concat(1e3/j,"px))"),width:"calc(".concat(O.width,"px + max(50vw, ").concat(1e3/j,"px))"),transform:"scale(".concat(j,")")}}),[O.height,O.width,j]),y=a.useReducer(pt,{dragging:!1,dragX:0,dragY:0,startX:0,startY:0}),w=Object(R.a)(y,2),C=w[0],S=w[1];a.useEffect((function(){b===j&&h(b<=.6)}),[j,b]),a.useEffect((function(){g.current&&(g.current.style.setProperty("--drag-offset-left","".concat((C.dragX-C.startX)/j,"px")),g.current.style.setProperty("--drag-offset-top","".concat((C.dragY-C.startY)/j,"px")))}),[C.dragX,C.dragY,C.startX,C.startY,j]);var A=a.useCallback((function(e,t){document.body.classList.add("dragging-passages"),S({type:"start",x:t.x,y:t.y})}),[]),k=a.useCallback((function(e,t){return S({type:"move",x:t.x,y:t.y})}),[]),N=a.useCallback((function(){window.setTimeout((function(){document.body.classList.remove("dragging-passages"),S({type:"stop",callback:o})}),0)}),[o]),E=a.useCallback((function(e,t){C.dragging||i(e,t)}),[i,C.dragging]);return Object(c.jsxs)("div",{className:x()("passage-map",{"compact-passage-cards":m}),ref:g,style:v,children:[Object(c.jsx)(lt,{formatName:t,formatVersion:n,offset:{left:(C.dragX-C.startX)/b,top:(C.dragY-C.startY)/b},passages:l,startPassageId:u}),Object(c.jsx)(ft,{onDeselect:r,onDragStart:A,onDrag:k,onDragStop:N,onEdit:s,onSelect:E,passages:l,tagColors:d})]})},ht=function(e){var t=e.container,n=e.onSelectRect,r=Object(I.a)(e,["container","onSelectRect"]),o=a.useState(),s=Object(R.a)(o,2),i=s[0],l=s[1],u=a.useState(),d=Object(R.a)(u,2),j=d[0],b=d[1],f=a.useMemo((function(){return i?e.passages.map((function(e){if(j&&e.selected)return e;var t=Object(Ge.g)(i,e);return t===e.selected?e:Object(F.a)(Object(F.a)({},e),{},{selected:t})})):e.passages}),[e.passages,j,i]),p=a.useCallback((function(t,n){l({height:t.height/e.zoom,left:t.left/e.zoom,top:t.top/e.zoom,width:t.width/e.zoom}),b(n)}),[e.zoom]),m=a.useCallback((function(e,t){l(void 0),b(void 0),n(e,t)}),[n]);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(Je,{container:t,ignoreEventsOnSelector:".passage-card, .zoom-buttons",onSelectRect:m,onTemporarySelectRect:p}),Object(c.jsx)(mt,Object(F.a)(Object(F.a)({},r),{},{passages:f}))]})},gt=function(){var e=a.useState(!1),t=Object(R.a)(e,2),n=t[0],r=t[1],o=Object(M.useDialogsContext)().dispatch,s=a.useRef(null),i=Object(b.g)().storyId,l=Object(Ae.useUndoableStoriesContext)(),u=l.dispatch,d=l.stories,j=Object(Z.storyWithId)(d,i);!function(e){var t=Object(Z.useStoriesContext)(),n=t.dispatch,a=t.stories;Object(Ee.a)("-",(function(){switch(e.zoom){case 1:n(Object(Z.updateStory)(a,e,{zoom:.6}));break;case.6:n(Object(Z.updateStory)(a,e,{zoom:.3}))}}),{keydown:!1,keyup:!0},[n,a,e]),Object(Ee.a)("=",(function(){switch(e.zoom){case.3:n(Object(Z.updateStory)(a,e,{zoom:.6}));break;case.6:n(Object(Z.updateStory)(a,e,{zoom:1}))}}),{keydown:!1,keyup:!0},[n,a,e])}(j);var f=a.useMemo((function(){return j.passages.filter((function(e){return e.selected}))}),[j.passages]),p=a.useCallback((function(){if(!s.current)throw new Error("Asked for the center of the main content, but it does not exist in the DOM yet");return{left:(s.current.scrollLeft+s.current.clientWidth/2)/j.zoom,top:(s.current.scrollTop+s.current.clientHeight/2)/j.zoom}}),[j.zoom]),m=a.useCallback((function(e){return u(Object(Z.deselectPassage)(j,e))}),[j,u]),h=a.useCallback((function(e){Math.abs(e.left)<1&&Math.abs(e.top)<1||u(Object(Z.movePassages)(j,j.passages.reduce((function(e,t){return t.selected?[].concat(Object(Oe.a)(e),[t.id]):e}),[]),e.left/j.zoom,e.top/j.zoom),(f.length,"undoChange.movePassages"))}),[f.length,j,u]),g=a.useCallback((function(e){o({type:"addDialog",component:M.PassageEditDialog,props:{passageId:e.id,storyId:j.id}})}),[o,j.id]),O=a.useCallback((function(e,t){return u(Object(Z.selectPassage)(j,e,t))}),[j,u]),v=a.useCallback((function(e,t){var n={height:e.height/j.zoom,left:e.left/j.zoom,top:e.top/j.zoom,width:e.width/j.zoom};u(Object(Z.selectPassagesInRect)(j,n,t?f.map((function(e){return e.id})):[]))}),[f,j,u]);a.useEffect((function(){if(!n&&(r(!0),0===j.passages.length)){var e=p();u(Object(Z.createUntitledPassage)(j,e.left,e.top))}}),[p,n,j,u]);var x=Ye(j.zoom,s.current);return Object(c.jsxs)("div",{className:"story-edit-route",children:[Object(c.jsx)(C,{title:j.name}),Object(c.jsx)(qe,{getCenter:p,story:j}),Object(c.jsx)(S,{grabbable:!0,padded:!1,ref:s,children:Object(c.jsx)(ht,{container:s,formatName:j.storyFormat,formatVersion:j.storyFormatVersion,onDeselect:m,onDrag:h,onEdit:g,onSelect:O,onSelectRect:v,passages:j.passages,startPassageId:j.startPassage,tagColors:j.tagColors,visibleZoom:x,zoom:j.zoom})})]})},Ot=function(){return Object(c.jsx)(Ae.UndoableStoriesContextProvider,{children:Object(c.jsx)(M.DialogsContextProvider,{children:Object(c.jsx)(gt,{})})})},vt=n(172),xt=n.n(vt);n(513);var yt=function(e){var t,n=e.watch,r=a.useState(),o=Object(R.a)(r,2),s=o[0],i=o[1],l=a.useState(!1),u=Object(R.a)(l,2),d=u[0],j=u[1],b=a.useState(),f=Object(R.a)(b,2),m=f[0],h=f[1],g=Object(p.a)().t,O=Object(w.a)()||!(null===(t=navigator.storage)||void 0===t?void 0:t.estimate);return a.useEffect((function(){function e(){return(e=Object(q.a)(Q.a.mark((function e(){var t,a,r;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,navigator.storage.estimate();case 3:t=e.sent,a=t.quota,r=t.usage,void 0!==a&&void 0!==r&&h((100*(1-r/a)).toFixed(0)),i(n),j(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}O||d||s===n||function(){e.apply(this,arguments)}()}),[O,s,n,d]),O?null:Object(c.jsx)("span",{className:"storage-quota",children:m&&g("components.storageQuota.freeSpace",{percent:m})})},wt=function(){var e=Object(Z.useStoriesContext)().stories,t=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.E,{}),label:t("routes.storyList.toolbar.archive"),onClick:function(){return ne(Object(J.b)(e,Object(_.a)()),Object(J.a)())}})},Ct=function(){var e=Object(M.useDialogsContext)().dispatch,t=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.v,{}),label:t("common.import"),onClick:function(){return e({type:"addDialog",component:M.StoryImportDialog})}})},St=function(){var e=Object(M.useDialogsContext)().dispatch,t=Object(p.a)().t;return Object(c.jsx)(V.a,{icon:Object(c.jsx)(A.R,{}),label:t("routes.storyList.toolbar.storyTags"),onClick:function(){e({type:"addDialog",component:M.StoryTagsDialog})}})},At=function(){return Object(c.jsxs)(K.a,{children:[Object(c.jsx)(St,{}),Object(c.jsx)(Ct,{}),Object(c.jsx)(wt,{})]})},kt=n(85),Nt=function(){var e=Object(Z.useStoriesContext)(),t=e.dispatch,n=e.stories,r=a.useState(Object(kt.a)(Object(Z.storyDefaults)().name,n.map((function(e){return e.name})))),o=Object(R.a)(r,2),s=o[0],i=o[1],u=Object(b.f)(),d=Object(l.usePrefsContext)().prefs,j=Object(p.a)().t;return Object(c.jsx)(je.a,{icon:Object(c.jsx)(A.G,{}),label:j("common.new"),submitLabel:j("common.create"),submitVariant:"create",onChange:function(e){return i(e.target.value)},onSubmit:function(){var e=Object(Z.createStory)(n,d,{name:s})(t,(function(){return n}));u.push("/stories/".concat(e))},prompt:j("routes.storyList.toolbar.createStoryButton.prompt"),validate:function(e){return""===e.trim()?{valid:!1,message:j("routes.storyList.toolbar.createStoryButton.emptyName")}:n.some((function(t){return t.name.toLowerCase()===e.toLowerCase()}))?{valid:!1,message:j("routes.storyList.toolbar.createStoryButton.nameConflict")}:{valid:!0}},value:s})},Et=(n(514),function(e){var t=e.cancelIcon,n=e.cancelLabel,r=e.confirmIcon,o=e.confirmLabel,s=e.confirmVariant,i=e.onConfirm,l=e.prompt,u=Object(I.a)(e,["cancelIcon","cancelLabel","confirmIcon","confirmLabel","confirmVariant","onConfirm","prompt"]),d=a.useState(!1),j=Object(R.a)(d,2),b=j[0],f=j[1],m=Object(p.a)().t;return Object(c.jsx)("span",{className:"confirm-button",children:Object(c.jsx)(Y.a,Object(F.a)(Object(F.a)({ariaLabel:l,focusSelector:"button:nth-child(2)",onChangeOpen:f,open:b},u),{},{children:Object(c.jsxs)("div",{children:[Object(c.jsx)(E.b,{children:l}),Object(c.jsxs)(K.a,{children:[Object(c.jsx)(V.a,{icon:null!==r&&void 0!==r?r:Object(c.jsx)(A.l,{}),label:null!==o&&void 0!==o?o:m("common.ok"),onClick:function(){f(!1),i()},variant:null!==s&&void 0!==s?s:"primary"}),Object(c.jsx)(V.a,{icon:null!==t&&void 0!==t?t:Object(c.jsx)(A.V,{}),label:null!==n&&void 0!==n?n:m("common.cancel"),onClick:function(){return f(!1)}})]})]})}))})}),Ft=function(e){var t=e.story,n=a.useState(null===t||void 0===t?void 0:t.name),r=Object(R.a)(n,2),o=r[0],s=r[1],i=Object(Z.useStoriesContext)().dispatch,l=Object(p.a)().t;return a.useEffect((function(){(null===t||void 0===t?void 0:t.name)&&s(t.name)}),[null===t||void 0===t?void 0:t.name]),Object(c.jsx)(Et,{confirmIcon:Object(c.jsx)(A.T,{}),confirmLabel:l("common.delete"),confirmVariant:"danger",disabled:!t,icon:Object(c.jsx)(A.T,{}),label:l("common.delete"),onConfirm:t?function(){return i(Object(Z.deleteStory)(t))}:function(){},prompt:l("routes.storyList.toolbar.deleteStoryButton.warning.".concat(Object(w.a)()?"electron":"web"),{storyName:o})})},It=function(e){var t=e.story,n=Object(Z.useStoriesContext)(),a=n.dispatch,r=n.stories,o=Object(p.a)().t;return Object(c.jsx)(V.a,{disabled:!t,icon:Object(c.jsx)(A.q,{}),label:o("common.duplicate"),onClick:function(){if(!t)throw new Error("No story set");a(Object(Z.duplicateStory)(t,r))}})},Pt=function(e){var t=e.story,n=Object(b.f)(),a=Object(p.a)().t;return Object(c.jsx)(V.a,{disabled:!t,icon:Object(c.jsx)(A.s,{}),label:a("common.edit"),onClick:function(){return n.push("/stories/".concat(null===t||void 0===t?void 0:t.id))}})},Dt=n(68),Tt=function(e){var t,n=e.story,a=Object(l.usePrefsContext)(),r=a.dispatch,o=a.prefs,s=Object(Z.useStoriesContext)(),i=s.dispatch,u=s.stories;return Object(c.jsx)(Dt.a,{assignedTags:null!==(t=null===n||void 0===n?void 0:n.tags)&&void 0!==t?t:[],disabled:!n,existingTags:Object(Z.storyTags)(u),icon:Object(c.jsx)(A.Q,{}),onAdd:function(e,t){if(!n)throw new Error("Story is unset");i(Object(Z.updateStory)(u,n,{tags:n.tags?[].concat(Object(Oe.a)(n.tags),[e]):[e]})),t&&r(Object(l.setPref)("storyTagColors",Object(F.a)(Object(F.a)({},o.storyTagColors),{},Object(z.a)({},e,t))))}})},Lt=function(e){var t=e.selectedStory,n=Object(Z.useStoriesContext)(),a=n.dispatch,r=n.stories;return Object(c.jsxs)(K.a,{children:[Object(c.jsx)(Nt,{}),Object(c.jsx)(Pt,{story:t}),Object(c.jsx)(Tt,{story:t}),Object(c.jsx)(ze,{existingStories:r,onRename:function(e){return a(Object(Z.updateStory)(r,t,{name:e}))},story:t}),Object(c.jsx)(It,{story:t}),Object(c.jsx)(Ft,{story:t})]})},Mt=n(58),Bt=function(){var e=Object(p.a)().t,t=Object(l.usePrefsContext)(),n=t.dispatch,a=t.prefs;return Object(c.jsx)(Mt.a,{icon:Object(c.jsx)(A.h,{}),items:[{checkable:!0,checked:"date"===a.storyListSort,label:e("routes.storyList.toolbar.sortByDate"),onClick:function(){return n(Object(l.setPref)("storyListSort","date"))}},{checkable:!0,checked:"name"===a.storyListSort,label:e("routes.storyList.toolbar.sortByName"),onClick:function(){return n(Object(l.setPref)("storyListSort","name"))}}],label:e("routes.storyList.toolbar.sort")})},zt=function(e){var t=Object(l.usePrefsContext)(),n=t.dispatch,a=t.prefs,r=Object(p.a)().t;return Object(c.jsx)(Mt.a,{disabled:0===e.tags.length,icon:Object(c.jsx)(A.Q,{}),items:[{checkable:!0,checked:0===a.storyListTagFilter.length,label:r("routes.storyList.toolbar.showAllStories"),onClick:function(){return n({type:"update",name:"storyListTagFilter",value:[]})}},{separator:!0}].concat(Object(Oe.a)(e.tags.map((function(e){return{checkable:!0,checked:a.storyListTagFilter.includes(e),label:e,onClick:function(){return n({type:"update",name:"storyListTagFilter",value:a.storyListTagFilter.includes(e)?a.storyListTagFilter.filter((function(t){return t!==e})):[].concat(Object(Oe.a)(a.storyListTagFilter),[e])})}}})))),label:r("routes.storyList.toolbar.showTags")})},Rt=function(){var e=Object(Z.useStoriesContext)().stories;return Object(c.jsxs)(K.a,{children:[Object(c.jsx)(Bt,{}),Object(c.jsx)(zt,{tags:Object(Z.storyTags)(e)})]})},Ut=function(e){var t,n=e.selectedStories,a=Object(Z.useStoriesContext)().stories,r=(Object(p.a)().t,1===n.length?n[0]:void 0);return Object(c.jsx)(H,{pinnedControls:Object(c.jsx)(yt,{watch:a}),tabs:(t={},Object(z.a)(t,"\uc5d0\ud53c\uc18c\ub4dc",Object(c.jsx)(Lt,{selectedStory:r})),Object(z.a)(t,"\uc800\uc7a5\uc18c",Object(c.jsx)(At,{})),Object(z.a)(t,"\ube4c\ub4dc",Object(c.jsx)(ue,{story:r})),Object(z.a)(t,"\uad00\ub9ac",Object(c.jsx)(Rt,{})),Object(z.a)(t,"Twine \uc124\uc815",Object(c.jsx)(de,{})),t)})};n(515);function Vt(e){for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n);return t%360}n(516);var Xt=a.memo((function(e){var t=e.story,n=[Vt(t.name)];n.push((n[0]+15)%360),n.push((n[0]-15)%360),n.push((n[0]+30)%360),n.push((n[0]-30)%360),n.push((n[0]+60)%360);var a=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,i=t.passages.map((function(e){return{key:e.name,x:e.left+e.width/2,y:e.top+e.height/2,radius:Math.max(e.width,e.height)}})).reduce((function(e,t,i){var l=t.radius+200;return a=Math.min(a,t.x-l),r=Math.min(r,t.y-l),o=Math.max(o,t.x+l),s=Math.max(s,t.y+l),e[0].push(Object(c.jsx)("circle",{cx:t.x,cy:t.y,r:l,style:{fill:"hsl(".concat(n[i%n.length],", 80%, 80%)")}},"".concat(t.key,"-bg"))),e[1].push(Object(c.jsx)("circle",{cx:t.x,cy:t.y,r:t.radius,style:{fill:"hsl(".concat(n[i%n.length],", 80%, 60%)")}},"".concat(t.key,"-fg"))),e}),[[],[]]).map((function(e,t){return Object(c.jsx)("g",{className:"story-preview-".concat(0===t?"bg":"fg"),children:e},t)})),l="".concat(a," ").concat(r," ").concat(o-a," ").concat(s-r);return Object(c.jsx)("svg",{className:"story-preview",viewBox:l,xmlns:"http://www.w3.org/2000/svg",children:i})}));Xt.displayName="StoryPreview";var Ht=new Intl.DateTimeFormat([]),Wt=function(e){var t=e.onChangeTagColor,n=e.onEdit,a=e.onRemoveTag,r=e.onSelect,o=e.story,s=e.storyTagColors,i=Object(I.a)(e,["onChangeTagColor","onEdit","onRemoveTag","onSelect","story","storyTagColors"]),l=Object(p.a)().t;return Object(c.jsx)("div",{className:"story-card",children:Object(c.jsx)(D,Object(F.a)(Object(F.a)({},i),{},{label:o.name,onDoubleClick:n,onSelect:r,selected:o.selected,children:Object(c.jsxs)(E.b,{children:[Object(c.jsxs)("div",{className:"story-card-summary",children:[Object(c.jsx)("div",{className:"story-card-summary-preview",children:Object(c.jsx)(Xt,{story:o})}),Object(c.jsxs)("div",{className:"story-card-summary-text",children:[Object(c.jsx)("h2",{children:o.name}),Object(c.jsxs)("p",{children:[l("components.storyCard.lastUpdated",{date:Ht.format(o.lastUpdate)}),Object(c.jsx)("br",{}),l("components.storyCard.passageCount",{count:o.passages.length})]})]})]}),o.tags&&Object(c.jsx)("div",{className:"tags",children:o.tags.map((function(e){return Object(c.jsx)(Dt.b,{color:s[e],name:e,onChangeColor:function(n){return t(e,n)},onRemove:function(){return a(e)}},e)}))})]})}))})},Qt=function(e){var t=e.onSelectStory,n=e.stories,a=Object(l.usePrefsContext)(),r=a.dispatch,o=a.prefs,s=Object(Ae.useUndoableStoriesContext)().dispatch,i=Object(b.f)();function u(e,t){r(Object(l.setPref)("storyTagColors",Object(F.a)(Object(F.a)({},o.storyTagColors),{},Object(z.a)({},e,t))))}return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(O,{columnWidth:"360px",children:Object(c.jsx)(m.a,{component:null,children:n.map((function(e){return Object(c.jsx)(h.a,{classNames:"pop",timeout:200,children:Object(c.jsx)(Wt,{onChangeTagColor:u,onEdit:function(){return i.push("/stories/".concat(e.id))},onRemoveTag:function(t){return function(e,t){s(Object(Z.updateStory)(n,e,{tags:e.tags.filter((function(e){return e!==t}))}))}(e,t)},onSelect:function(){return t(e)},story:e,storyTagColors:o.storyTagColors})},e.id)}))})})})},qt=function(){var e=Object(M.useDialogsContext)().dispatch,t=Object(Z.useStoriesContext)(),n=t.dispatch,r=t.stories,s=Object(l.usePrefsContext)().prefs,i=function(){var e=Object(l.usePrefsContext)().prefs;return{shouldShowDonationPrompt:a.useCallback((function(){return!e.donateShown&&Date.now()>e.firstRunTime+12096e5}),[e.donateShown,e.firstRunTime])}}(),u=i.shouldShowDonationPrompt,d=Object(p.a)().t,j=a.useMemo((function(){return r.filter((function(e){return e.selected}))}),[r]),b=a.useMemo((function(){var e=s.storyListTagFilter.length>0?r.filter((function(e){return e.tags.some((function(e){return s.storyListTagFilter.includes(e)}))})):r;switch(s.storyListSort){case"date":return xt()(e,"lastUpdated");case"name":return xt()(e,"name")}}),[s.storyListSort,s.storyListTagFilter,r]);return a.useEffect((function(){var e,t=Object(f.a)(j);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.selected&&!b.includes(a)&&n(Object(Z.deselectStory)(a))}}catch(r){t.e(r)}finally{t.f()}}),[j,r,n,b]),a.useEffect((function(){u()&&e({type:"addDialog",component:M.AppDonationDialog})}),[e,u]),Object(c.jsxs)("div",{className:"story-list-route",children:[Object(c.jsx)(Ut,{selectedStories:j}),Object(c.jsx)(g,{ignoreSelector:".story-card",onClickAway:function(){return n(Object(Z.deselectAllStories)())},children:Object(c.jsxs)(S,{title:d(s.storyListTagFilter.length>0?"routes.storyList.taggedTitleCount":"routes.storyList.titleCount",{count:b.length}),children:[Object(c.jsx)(o.c,{}),Object(c.jsx)("div",{className:"stories",children:0===r.length?Object(c.jsx)("p",{children:d("routes.storyList.noStories")}):Object(c.jsx)(Qt,{onSelectStory:function(e){return n(Object(Z.selectStory)(e,!0))},stories:b})})]})})]})},Kt=function(){return Object(c.jsx)(Ae.UndoableStoriesContextProvider,{children:Object(c.jsx)(M.DialogsContextProvider,{children:Object(c.jsx)(qt,{})})})};function Yt(e){delete window.CodeMirror,delete window.SVG,delete window.Store,delete window.StoryFormat,delete window.amdDefine,delete window.app,delete window.jQuery,document.open(),document.write(e),document.close()}var Gt=function(){var e=a.useState(),t=Object(R.a)(e,2),n=t[0],r=t[1],s=a.useState(!1),i=Object(R.a)(s,2),l=i[0],u=i[1],d=Object(b.g)().storyId,j=$().publishStory;return a.useEffect((function(){function e(){return(e=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=Yt,e.next=4,j(d);case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),r(e.t2);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}l||(u(!0),function(){e.apply(this,arguments)}())}),[l,j,d]),n?Object(c.jsx)(o.a,{children:n.message}):null},Jt=function(){var e=a.useState(),t=Object(R.a)(e,2),n=t[0],r=t[1],s=a.useState(!1),i=Object(R.a)(s,2),l=i[0],u=i[1],d=Object(b.g)().storyId,j=$().proofStory;return a.useEffect((function(){function e(){return(e=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=Yt,e.next=4,j(d);case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),r(e.t2);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}l||(u(!0),function(){e.apply(this,arguments)}())}),[l,j,d]),n?Object(c.jsx)(o.a,{children:n.message}):null},Zt=function(){var e=a.useState(),t=Object(R.a)(e,2),n=t[0],r=t[1],s=a.useState(!1),i=Object(R.a)(s,2),l=i[0],u=i[1],d=Object(b.g)(),j=d.passageId,f=d.storyId,p=$().publishStory;return a.useEffect((function(){function e(){return(e=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=Yt,e.next=4,p(f,{formatOptions:"debug",startId:j});case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),r(e.t2);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}l||(u(!0),function(){e.apply(this,arguments)}())}),[l,j,p,f]),n?Object(c.jsx)(o.a,{children:n.message}):null},_t=(n(517),n(25)),$t=n(31),en=n(30),tn=n(24),nn=function(e){Object($t.a)(n,e);var t=Object(en.a)(n);function n(){return Object(tn.a)(this,n),t.apply(this,arguments)}return Object(_t.a)(n,[{key:"setItem",value:function(e,t){window.sessionStorage.setItem(e,JSON.stringify(t))}},{key:"getItem",value:function(e){var t;return null===(t=window.sessionStorage.getItem(e))?null:t}},{key:"clearItem",value:function(e){window.sessionStorage.removeItem(e)}}]),n}((function e(){Object(tn.a)(this,e)})),an=nn,rn=function(e){Object($t.a)(n,e);var t=Object(en.a)(n);function n(e){return Object(tn.a)(this,n),t.call(this,e)}return Object(_t.a)(n,[{key:"render",value:function(){return Object(c.jsxs)("div",{className:"btn__container",children:[Object(c.jsx)("a",{href:"/#/select",children:Object(c.jsx)("div",{className:"font-hambak sign-btn",children:"Play Game"})}),Object(c.jsx)("a",{href:"/#/",children:Object(c.jsx)("div",{className:"font-hambak login-btn",children:"MyPage"})})]})}}]),n}(a.Component),on=function(e){Object($t.a)(n,e);var t=Object(en.a)(n);function n(e){return Object(tn.a)(this,n),t.call(this,e)}return Object(_t.a)(n,[{key:"render",value:function(){return Object(c.jsxs)("div",{className:"btn__container",children:[Object(c.jsx)("a",{href:"/#/login",children:Object(c.jsx)("div",{className:"font-hambak login-btn",children:"LOGIN"})}),Object(c.jsx)("a",{href:"/#/signup",children:Object(c.jsx)("div",{className:"font-hambak sign-btn",children:"SIGN UP"})})]})}}]),n}(a.Component),sn=function(){var e=a.useRef(null),t=a.useState(0),n=Object(R.a)(t,2),r=n[0],o=n[1],s=Object(c.jsx)(on,{}),i=new an,l=i.getItem("userNickname");s=null===i.getItem("userToken")?Object(c.jsx)(on,{}):Object(c.jsx)(rn,{nickname:l});var u={backgroundColor:"rgba(34, 40, 49, ".concat(r/400,")")};return window.addEventListener("scroll",(function(){o(window.scrollY)})),Object(c.jsxs)("body",{children:[Object(c.jsxs)("main",{className:"index-main",children:[Object(c.jsx)("header",{ref:e,className:"index-header header-position",style:u,children:Object(c.jsxs)("div",{className:"header-container",children:[Object(c.jsx)("div",{className:"header__left",children:Object(c.jsxs)("span",{className:"font-hambak title",children:["TEXT ADVENTURE",Object(c.jsx)("br",{}),"PROJECT"]})}),Object(c.jsxs)("div",{className:"header__right",children:[Object(c.jsxs)("div",{className:"category__container",children:[Object(c.jsx)("div",{className:"category",children:Object(c.jsx)("a",{href:"",children:Object(c.jsx)("span",{className:"font-game-thick category-span",children:"\uac8c\uc784\uc18c\uac1c"})})}),Object(c.jsx)("div",{className:"category",children:Object(c.jsx)("a",{href:"/#/select",children:Object(c.jsx)("span",{className:"font-game-thick category-span",children:"\uc2dc\uc791\ud558\uae30"})})}),Object(c.jsx)("div",{className:"category",children:Object(c.jsx)("a",{href:"",children:Object(c.jsx)("span",{className:"font-game-thick category-span",children:"\ucee4\ubba4\ub2c8\ud2f0"})})}),Object(c.jsx)("div",{className:"category",children:Object(c.jsx)("a",{href:"",children:Object(c.jsx)("span",{className:"font-game-thick category-span",children:"\ubc84\uadf8\uc81c\ubcf4"})})})]}),s]})]})}),Object(c.jsx)("div",{className:"first-section",children:Object(c.jsx)("div",{children:Object(c.jsx)("p",{className:"intro font-game-thick",children:"\uc720\uc800\uac00 \ub9cc\ub4e4\uc5b4\uac00\ub294 \ud14d\uc2a4\ud2b8 \uc5b4\ub4dc\ubca4\uccd0 \uac8c\uc784"})})}),Object(c.jsx)("div",{className:"second-section"}),Object(c.jsxs)("div",{className:"third-section",children:[Object(c.jsx)("div",{className:"third-section-line"}),Object(c.jsxs)("div",{className:"explain-game",children:[Object(c.jsxs)("div",{className:"play-game-title-container",children:[Object(c.jsx)("div",{className:"title-line1"}),Object(c.jsx)("h1",{className:"font-game-thick explain-game-title",children:"\uac8c\uc784 \uc18c\uac1c"}),Object(c.jsx)("div",{className:"title-line1"})]}),Object(c.jsx)("div",{className:"play-game-main-text",children:Object(c.jsxs)("p",{className:"explain-main-text description-size",children:["\uc720\uc800\uac00 \ub9cc\ub4e4\uc5b4\uac00\ub294 \ud14d\uc2a4\ud2b8 \uc5b4\ub4dc\ubca4\uccd0 \uac8c\uc784\uc740 '\ucf58\ud150\uce20\uac00 \ubb34\ud55c\ud55c \uac8c\uc784\uc744 \ub9cc\ub4e4 \uc218 \uc788\uc744\uae4c?' \ub77c\ub294 \uc9c8\ubb38\uc5d0\uc11c \ucd9c\ubc1c\ud55c \ud504\ub85c\uc81d\ud2b8\uc785\ub2c8\ub2e4.",Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),"\uac8c\uc784\uc774\ub77c\ub294 \ubd84\uc57c\ub294 \uac8c\uc774\uba38\ub3c4 \uac1c\ubc1c\uc790\ub9cc\ud07c\uc774\ub098 \uac8c\uc784\uc5d0 \ub300\ud55c \uc774\ud574\ub3c4\uac00 \ub192\ub2e4\ub294 \ud2b9\uc9d5\uc774 \uc788\uc2b5\ub2c8\ub2e4. \uadf8\ub9ac\ud558\uc5ec \uc720\uc800\ub4e4\uc774 \ubaa8\ub450 \ud611\uc5c5\ud558\uc5ec \ubc1c\uc804\uc2dc\ucf1c\ub098\uac08 \uc218 \uc788\ub294 \uac8c\uc784\uc744 \uac1c\ubc1c\ud574\ubcf4\ub824\uace0 \ud569\ub2c8\ub2e4.",Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),"\uad81\uadf9\uc801\uc73c\ub85c \uc774 \ud504\ub85c\uc81d\ud2b8\ub294 \uac8c\uc784\uc774\uba74\uc11c \ub3d9\uc2dc\uc5d0 \uac8c\uc784 \uc81c\uc791 \ud234\uc744 \uac1c\ubc1c\ud558\ub294 \uacfc\uc815\uc785\ub2c8\ub2e4.",Object(c.jsx)("br",{})]})}),Object(c.jsx)("div",{className:"empty",children:Object(c.jsx)("button",{className:"go-to-select-btn display-none",onClick:function(){return window.location.href="/#/select"},children:Object(c.jsx)("span",{className:"font-game-thick",children:"\uac8c\uc784 \uc2dc\uc791\ud558\uae30"})})}),Object(c.jsxs)("div",{className:"make-game-title-container",children:[Object(c.jsx)("div",{className:"title-line1"}),Object(c.jsx)("h1",{className:"font-game-thick explain-game-title",children:"\uac8c\uc784\uc744 \uc990\uae30\ub294 \ubc29\ubc95"}),Object(c.jsx)("div",{className:"title-line1"})]}),Object(c.jsx)("div",{className:"make-game-main-text",children:Object(c.jsxs)("p",{className:"explain-main-text description-size",children:["'\uba54\uc778\uc2a4\ud1a0\ub9ac'\ub780 \uac8c\uc784\uc758 \uc7a5\ub974\ub97c \uacb0\uc815\ud558\ub294 \uc2dc\uc791 \uc774\uc57c\uae30\uc785\ub2c8\ub2e4.",Object(c.jsx)("br",{}),"'\uc5d0\ud53c\uc18c\ub4dc'\ub780 \uba54\uc778\uc2a4\ud1a0\ub9ac\uc5d0 \ub9de\ucd94\uc5b4 \uc774\ud6c4\uc5d0 \ub4f1\uc7a5\ud558\uac8c \ub418\ub294 \uc791\uc740 \uc0ac\uac74\ub4e4\uc785\ub2c8\ub2e4.",Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),"\uc5d0\ud53c\uc18c\ub4dc\ub294 \uc720\uc800\uac00 \ub9cc\ub4e4 \uc218 \uc788\uc2b5\ub2c8\ub2e4.",Object(c.jsx)("br",{}),Object(c.jsx)("br",{})]})})]}),Object(c.jsx)("div",{})]}),Object(c.jsxs)("div",{className:"fourth-section",children:[Object(c.jsx)("div",{}),Object(c.jsxs)("div",{className:"block-chain-introduction",children:[Object(c.jsxs)("div",{className:"block-chain-title-container",children:[Object(c.jsx)("div",{className:"title-line2"}),Object(c.jsxs)("h1",{className:"font-game-thick block-chain-title",children:["\uc720\uc800\uac00 \uc9c1\uc811 \ucee8\ud150\uce20\ub97c \ucd94\uac00\ud574\ub098\uac00\ub294",Object(c.jsx)("br",{}),"\ud14d\uc2a4\ud2b8 \uac8c\uc784 \uac1c\ubc1c \ubc29\ubc95"]}),Object(c.jsx)("div",{className:"title-line2"})]}),Object(c.jsx)("div",{className:"block-chain-main-container",children:Object(c.jsx)("p",{className:"block-chain-main-text description-size",children:"\ub2e4\uc74c\uacfc \uac19\uc740 \ubd84\uc57c\uc5d0\uc11c \ud65c\uc6a9\ub429\ub2c8\ub2e4."})})]}),Object(c.jsx)("div",{className:"fourth-section-line"})]})]}),Object(c.jsx)("footer",{className:"index-footer"}),Object(c.jsx)("script",{src:"/js/index.js"})]})},cn=(n(518),n.p+"static/media/sword-svgrepo-com.dfa127b1.svg"),ln=n.p+"static/media/write-svgrepo-com.0e931a97.svg",un=(n(124),n.p+"static/media/mode-apo.63ba34d3.png"),dn=n.p+"static/media/mode-fantasy.3be543ec.png",jn=function(e){Object($t.a)(n,e);var t=Object(en.a)(n);function n(){return Object(tn.a)(this,n),t.apply(this,arguments)}return Object(_t.a)(n,[{key:"render",value:function(){return Object(c.jsxs)("div",{className:"game_mode-modes",children:[Object(c.jsxs)("div",{className:"game_mode-modes-element ".concat(1===this.props.click?"click":""),onClick:function(e){this.props.onClick(1)}.bind(this),children:[Object(c.jsx)("svg",{className:"btn_deco deco1",version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"1280.000000pt",height:"1280.000000pt",viewBox:"0 0 1280.000000 1280.000000",preserveAspectRatio:"xMidYMid meet",children:Object(c.jsxs)("g",{transform:"translate(0.000000,1280.000000) scale(0.100000,-0.100000)",stroke:"none",children:[Object(c.jsx)("path",{d:"M0 11645 l0 -1155 1155 0 1155 0 0 1155 0 1155 -1155 0 -1155 0 0\r -1155z m1820 0 l0 -665 -665 0 -665 0 0 665 0 665 665 0 665 0 0 -665z"}),Object(c.jsx)("path",{d:"M2738 11433 l-3 -1368 -1367 -3 -1368 -2 0 -5030 0 -5030 245 0 245\r 0 0 2735 0 2735 440 0 440 0 0 -1595 0 -1595 930 0 930 0 -2 243 -3 242 -682\r 3 -683 2 0 1350 0 1350 683 2 682 3 0 1610 0 1610 -927 3 -928 2 0 -930 0\r -930 245 0 245 0 0 685 0 685 438 -2 437 -3 3 -1122 2 -1123 -1125 0 -1125 0\r 0 1805 0 1805 1368 2 1367 3 3 1368 2 1367 1805 0 1805 0 0 -440 0 -440 -1370\r 0 -1370 0 3 -927 2 -928 1610 0 1610 0 3 683 2 682 1350 0 1350 0 2 -682 3\r -683 243 -3 242 -2 0 930 0 930 -1595 0 -1595 0 0 440 0 440 2735 0 2735 0 0\r 245 0 245 -5030 0 -5030 0 -2 -1367z m4102 -933 l0 -440 -1122 2 -1123 3 -3\r 438 -2 437 1125 0 1125 0 0 -440z"}),Object(c.jsx)("path",{d:"M4106 8691 c-3 -5 -5 -526 -3 -1157 l2 -1149 1155 0 1155 0 0 1155 0\r 1155 -1152 2 c-667 2 -1154 -1 -1157 -6z m1824 -1151 l0 -670 -670 0 -670 0 0\r 670 0 670 670 0 670 0 0 -670z"})]})}),Object(c.jsx)("svg",{className:"btn_deco deco2",version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"1280.000000pt",height:"1280.000000pt",viewBox:"0 0 1280.000000 1280.000000",preserveAspectRatio:"xMidYMid meet",children:Object(c.jsxs)("g",{transform:"translate(0.000000,1280.000000) scale(0.100000,-0.100000)",stroke:"none",children:[Object(c.jsx)("path",{d:"M0 11645 l0 -1155 1155 0 1155 0 0 1155 0 1155 -1155 0 -1155 0 0\r -1155z m1820 0 l0 -665 -665 0 -665 0 0 665 0 665 665 0 665 0 0 -665z"}),Object(c.jsx)("path",{d:"M2738 11433 l-3 -1368 -1367 -3 -1368 -2 0 -5030 0 -5030 245 0 245\r 0 0 2735 0 2735 440 0 440 0 0 -1595 0 -1595 930 0 930 0 -2 243 -3 242 -682\r 3 -683 2 0 1350 0 1350 683 2 682 3 0 1610 0 1610 -927 3 -928 2 0 -930 0\r -930 245 0 245 0 0 685 0 685 438 -2 437 -3 3 -1122 2 -1123 -1125 0 -1125 0\r 0 1805 0 1805 1368 2 1367 3 3 1368 2 1367 1805 0 1805 0 0 -440 0 -440 -1370\r 0 -1370 0 3 -927 2 -928 1610 0 1610 0 3 683 2 682 1350 0 1350 0 2 -682 3\r -683 243 -3 242 -2 0 930 0 930 -1595 0 -1595 0 0 440 0 440 2735 0 2735 0 0\r 245 0 245 -5030 0 -5030 0 -2 -1367z m4102 -933 l0 -440 -1122 2 -1123 3 -3\r 438 -2 437 1125 0 1125 0 0 -440z"}),Object(c.jsx)("path",{d:"M4106 8691 c-3 -5 -5 -526 -3 -1157 l2 -1149 1155 0 1155 0 0 1155 0\r 1155 -1152 2 c-667 2 -1154 -1 -1157 -6z m1824 -1151 l0 -670 -670 0 -670 0 0\r 670 0 670 670 0 670 0 0 -670z"})]})}),Object(c.jsx)("svg",{className:"btn_deco deco3",version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"1280.000000pt",height:"1280.000000pt",viewBox:"0 0 1280.000000 1280.000000",preserveAspectRatio:"xMidYMid meet",children:Object(c.jsxs)("g",{transform:"translate(0.000000,1280.000000) scale(0.100000,-0.100000)",stroke:"none",children:[Object(c.jsx)("path",{d:"M0 11645 l0 -1155 1155 0 1155 0 0 1155 0 1155 -1155 0 -1155 0 0\r -1155z m1820 0 l0 -665 -665 0 -665 0 0 665 0 665 665 0 665 0 0 -665z"}),Object(c.jsx)("path",{d:"M2738 11433 l-3 -1368 -1367 -3 -1368 -2 0 -5030 0 -5030 245 0 245\r 0 0 2735 0 2735 440 0 440 0 0 -1595 0 -1595 930 0 930 0 -2 243 -3 242 -682\r 3 -683 2 0 1350 0 1350 683 2 682 3 0 1610 0 1610 -927 3 -928 2 0 -930 0\r -930 245 0 245 0 0 685 0 685 438 -2 437 -3 3 -1122 2 -1123 -1125 0 -1125 0\r 0 1805 0 1805 1368 2 1367 3 3 1368 2 1367 1805 0 1805 0 0 -440 0 -440 -1370\r 0 -1370 0 3 -927 2 -928 1610 0 1610 0 3 683 2 682 1350 0 1350 0 2 -682 3\r -683 243 -3 242 -2 0 930 0 930 -1595 0 -1595 0 0 440 0 440 2735 0 2735 0 0\r 245 0 245 -5030 0 -5030 0 -2 -1367z m4102 -933 l0 -440 -1122 2 -1123 3 -3\r 438 -2 437 1125 0 1125 0 0 -440z"}),Object(c.jsx)("path",{d:"M4106 8691 c-3 -5 -5 -526 -3 -1157 l2 -1149 1155 0 1155 0 0 1155 0\r 1155 -1152 2 c-667 2 -1154 -1 -1157 -6z m1824 -1151 l0 -670 -670 0 -670 0 0\r 670 0 670 670 0 670 0 0 -670z"})]})}),Object(c.jsx)("svg",{className:"btn_deco deco4",version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"1280.000000pt",height:"1280.000000pt",viewBox:"0 0 1280.000000 1280.000000",preserveAspectRatio:"xMidYMid meet",children:Object(c.jsxs)("g",{transform:"translate(0.000000,1280.000000) scale(0.100000,-0.100000)",stroke:"none",children:[Object(c.jsx)("path",{d:"M0 11645 l0 -1155 1155 0 1155 0 0 1155 0 1155 -1155 0 -1155 0 0\r -1155z m1820 0 l0 -665 -665 0 -665 0 0 665 0 665 665 0 665 0 0 -665z"}),Object(c.jsx)("path",{d:"M2738 11433 l-3 -1368 -1367 -3 -1368 -2 0 -5030 0 -5030 245 0 245\r 0 0 2735 0 2735 440 0 440 0 0 -1595 0 -1595 930 0 930 0 -2 243 -3 242 -682\r 3 -683 2 0 1350 0 1350 683 2 682 3 0 1610 0 1610 -927 3 -928 2 0 -930 0\r -930 245 0 245 0 0 685 0 685 438 -2 437 -3 3 -1122 2 -1123 -1125 0 -1125 0\r 0 1805 0 1805 1368 2 1367 3 3 1368 2 1367 1805 0 1805 0 0 -440 0 -440 -1370\r 0 -1370 0 3 -927 2 -928 1610 0 1610 0 3 683 2 682 1350 0 1350 0 2 -682 3\r -683 243 -3 242 -2 0 930 0 930 -1595 0 -1595 0 0 440 0 440 2735 0 2735 0 0\r 245 0 245 -5030 0 -5030 0 -2 -1367z m4102 -933 l0 -440 -1122 2 -1123 3 -3\r 438 -2 437 1125 0 1125 0 0 -440z"}),Object(c.jsx)("path",{d:"M4106 8691 c-3 -5 -5 -526 -3 -1157 l2 -1149 1155 0 1155 0 0 1155 0\r 1155 -1152 2 c-667 2 -1154 -1 -1157 -6z m1824 -1151 l0 -670 -670 0 -670 0 0\r 670 0 670 670 0 670 0 0 -670z"})]})}),Object(c.jsx)("img",{className:"genre-img",src:un,alt:""}),Object(c.jsx)("div",{className:"subtitle",children:Object(c.jsx)("h1",{className:"font-game-thick",children:"\uc544\ud3ec\uce7c\ub9bd\uc2a4"})})]}),Object(c.jsxs)("div",{className:"game_mode-modes-element ".concat(2===this.props.click?"click":""),onClick:function(e){this.props.onClick(2)}.bind(this),children:[Object(c.jsx)("svg",{className:"btn_deco deco1",version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"1280.000000pt",height:"1280.000000pt",viewBox:"0 0 1280.000000 1280.000000",preserveAspectRatio:"xMidYMid meet",children:Object(c.jsxs)("g",{transform:"translate(0.000000,1280.000000) scale(0.100000,-0.100000)",stroke:"none",children:[Object(c.jsx)("path",{d:"M0 11645 l0 -1155 1155 0 1155 0 0 1155 0 1155 -1155 0 -1155 0 0\r -1155z m1820 0 l0 -665 -665 0 -665 0 0 665 0 665 665 0 665 0 0 -665z"}),Object(c.jsx)("path",{d:"M2738 11433 l-3 -1368 -1367 -3 -1368 -2 0 -5030 0 -5030 245 0 245\r 0 0 2735 0 2735 440 0 440 0 0 -1595 0 -1595 930 0 930 0 -2 243 -3 242 -682\r 3 -683 2 0 1350 0 1350 683 2 682 3 0 1610 0 1610 -927 3 -928 2 0 -930 0\r -930 245 0 245 0 0 685 0 685 438 -2 437 -3 3 -1122 2 -1123 -1125 0 -1125 0\r 0 1805 0 1805 1368 2 1367 3 3 1368 2 1367 1805 0 1805 0 0 -440 0 -440 -1370\r 0 -1370 0 3 -927 2 -928 1610 0 1610 0 3 683 2 682 1350 0 1350 0 2 -682 3\r -683 243 -3 242 -2 0 930 0 930 -1595 0 -1595 0 0 440 0 440 2735 0 2735 0 0\r 245 0 245 -5030 0 -5030 0 -2 -1367z m4102 -933 l0 -440 -1122 2 -1123 3 -3\r 438 -2 437 1125 0 1125 0 0 -440z"}),Object(c.jsx)("path",{d:"M4106 8691 c-3 -5 -5 -526 -3 -1157 l2 -1149 1155 0 1155 0 0 1155 0\r 1155 -1152 2 c-667 2 -1154 -1 -1157 -6z m1824 -1151 l0 -670 -670 0 -670 0 0\r 670 0 670 670 0 670 0 0 -670z"})]})}),Object(c.jsx)("svg",{className:"btn_deco deco2",version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"1280.000000pt",height:"1280.000000pt",viewBox:"0 0 1280.000000 1280.000000",preserveAspectRatio:"xMidYMid meet",children:Object(c.jsxs)("g",{transform:"translate(0.000000,1280.000000) scale(0.100000,-0.100000)",stroke:"none",children:[Object(c.jsx)("path",{d:"M0 11645 l0 -1155 1155 0 1155 0 0 1155 0 1155 -1155 0 -1155 0 0\r -1155z m1820 0 l0 -665 -665 0 -665 0 0 665 0 665 665 0 665 0 0 -665z"}),Object(c.jsx)("path",{d:"M2738 11433 l-3 -1368 -1367 -3 -1368 -2 0 -5030 0 -5030 245 0 245\r 0 0 2735 0 2735 440 0 440 0 0 -1595 0 -1595 930 0 930 0 -2 243 -3 242 -682\r 3 -683 2 0 1350 0 1350 683 2 682 3 0 1610 0 1610 -927 3 -928 2 0 -930 0\r -930 245 0 245 0 0 685 0 685 438 -2 437 -3 3 -1122 2 -1123 -1125 0 -1125 0\r 0 1805 0 1805 1368 2 1367 3 3 1368 2 1367 1805 0 1805 0 0 -440 0 -440 -1370\r 0 -1370 0 3 -927 2 -928 1610 0 1610 0 3 683 2 682 1350 0 1350 0 2 -682 3\r -683 243 -3 242 -2 0 930 0 930 -1595 0 -1595 0 0 440 0 440 2735 0 2735 0 0\r 245 0 245 -5030 0 -5030 0 -2 -1367z m4102 -933 l0 -440 -1122 2 -1123 3 -3\r 438 -2 437 1125 0 1125 0 0 -440z"}),Object(c.jsx)("path",{d:"M4106 8691 c-3 -5 -5 -526 -3 -1157 l2 -1149 1155 0 1155 0 0 1155 0\r 1155 -1152 2 c-667 2 -1154 -1 -1157 -6z m1824 -1151 l0 -670 -670 0 -670 0 0\r 670 0 670 670 0 670 0 0 -670z"})]})}),Object(c.jsx)("svg",{className:"btn_deco deco3",version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"1280.000000pt",height:"1280.000000pt",viewBox:"0 0 1280.000000 1280.000000",preserveAspectRatio:"xMidYMid meet",children:Object(c.jsxs)("g",{transform:"translate(0.000000,1280.000000) scale(0.100000,-0.100000)",stroke:"none",children:[Object(c.jsx)("path",{d:"M0 11645 l0 -1155 1155 0 1155 0 0 1155 0 1155 -1155 0 -1155 0 0\r -1155z m1820 0 l0 -665 -665 0 -665 0 0 665 0 665 665 0 665 0 0 -665z"}),Object(c.jsx)("path",{d:"M2738 11433 l-3 -1368 -1367 -3 -1368 -2 0 -5030 0 -5030 245 0 245\r 0 0 2735 0 2735 440 0 440 0 0 -1595 0 -1595 930 0 930 0 -2 243 -3 242 -682\r 3 -683 2 0 1350 0 1350 683 2 682 3 0 1610 0 1610 -927 3 -928 2 0 -930 0\r -930 245 0 245 0 0 685 0 685 438 -2 437 -3 3 -1122 2 -1123 -1125 0 -1125 0\r 0 1805 0 1805 1368 2 1367 3 3 1368 2 1367 1805 0 1805 0 0 -440 0 -440 -1370\r 0 -1370 0 3 -927 2 -928 1610 0 1610 0 3 683 2 682 1350 0 1350 0 2 -682 3\r -683 243 -3 242 -2 0 930 0 930 -1595 0 -1595 0 0 440 0 440 2735 0 2735 0 0\r 245 0 245 -5030 0 -5030 0 -2 -1367z m4102 -933 l0 -440 -1122 2 -1123 3 -3\r 438 -2 437 1125 0 1125 0 0 -440z"}),Object(c.jsx)("path",{d:"M4106 8691 c-3 -5 -5 -526 -3 -1157 l2 -1149 1155 0 1155 0 0 1155 0\r 1155 -1152 2 c-667 2 -1154 -1 -1157 -6z m1824 -1151 l0 -670 -670 0 -670 0 0\r 670 0 670 670 0 670 0 0 -670z"})]})}),Object(c.jsx)("svg",{className:"btn_deco deco4",version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"1280.000000pt",height:"1280.000000pt",viewBox:"0 0 1280.000000 1280.000000",preserveAspectRatio:"xMidYMid meet",children:Object(c.jsxs)("g",{transform:"translate(0.000000,1280.000000) scale(0.100000,-0.100000)",stroke:"none",children:[Object(c.jsx)("path",{d:"M0 11645 l0 -1155 1155 0 1155 0 0 1155 0 1155 -1155 0 -1155 0 0\r -1155z m1820 0 l0 -665 -665 0 -665 0 0 665 0 665 665 0 665 0 0 -665z"}),Object(c.jsx)("path",{d:"M2738 11433 l-3 -1368 -1367 -3 -1368 -2 0 -5030 0 -5030 245 0 245\r 0 0 2735 0 2735 440 0 440 0 0 -1595 0 -1595 930 0 930 0 -2 243 -3 242 -682\r 3 -683 2 0 1350 0 1350 683 2 682 3 0 1610 0 1610 -927 3 -928 2 0 -930 0\r -930 245 0 245 0 0 685 0 685 438 -2 437 -3 3 -1122 2 -1123 -1125 0 -1125 0\r 0 1805 0 1805 1368 2 1367 3 3 1368 2 1367 1805 0 1805 0 0 -440 0 -440 -1370\r 0 -1370 0 3 -927 2 -928 1610 0 1610 0 3 683 2 682 1350 0 1350 0 2 -682 3\r -683 243 -3 242 -2 0 930 0 930 -1595 0 -1595 0 0 440 0 440 2735 0 2735 0 0\r 245 0 245 -5030 0 -5030 0 -2 -1367z m4102 -933 l0 -440 -1122 2 -1123 3 -3\r 438 -2 437 1125 0 1125 0 0 -440z"}),Object(c.jsx)("path",{d:"M4106 8691 c-3 -5 -5 -526 -3 -1157 l2 -1149 1155 0 1155 0 0 1155 0\r 1155 -1152 2 c-667 2 -1154 -1 -1157 -6z m1824 -1151 l0 -670 -670 0 -670 0 0\r 670 0 670 670 0 670 0 0 -670z"})]})}),Object(c.jsx)("img",{className:"genre-img",src:dn,alt:""}),Object(c.jsx)("div",{className:"subtitle",children:Object(c.jsx)("h1",{className:"font-game-thick",children:"\ud310\ud0c0\uc9c0"})})]})]})}}]),n}(a.Component),bn=jn,fn=function(e){Object($t.a)(n,e);var t=Object(en.a)(n);function n(){return Object(tn.a)(this,n),t.apply(this,arguments)}return Object(_t.a)(n,[{key:"render",value:function(){return Object(c.jsxs)("div",{className:"game_mode-text",children:[Object(c.jsx)("h1",{className:"title_font text_center font-game-thick",children:this.props.click_title}),Object(c.jsx)("h2",{className:"content_font font-game-thin",children:this.props.click_explain})]})}}]),n}(a.Component),pn=fn,mn=function(e){Object($t.a)(n,e);var t=Object(en.a)(n);function n(){return Object(tn.a)(this,n),t.apply(this,arguments)}return Object(_t.a)(n,[{key:"render",value:function(){return Object(c.jsxs)("div",{className:"game_mode-select_button",children:[Object(c.jsx)("button",{className:"font-game-thin mode_select_btn",onClick:function(){window.location.replace("./#/game-play")}.bind(this),children:"\uc120\ud0dd"}),Object(c.jsx)("button",{className:"font-game-thin mode_select_btn",onClick:function(){this.props.onClickCancel()}.bind(this),children:"\ucde8\uc18c"})]})}}]),n}(a.Component),hn=mn,gn=n.p+"static/media/wave_line.9b11e668.svg";function On(e){var t=Object(a.useState)(1),n=Object(R.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)([{id:1,title:"\uc544\ud3ec\uce7c\ub9bd\uc2a4",explain:"\uba78\ub9dd\ud55c \uc138\uacc4\uc5d0\uc11c \uc0b4\uc544\ub0a8\uc73c\uc138\uc694."},{id:2,title:"\ud310\ud0c0\uc9c0",explain:"\ub9c8\ubc95\uacfc \uac80\uc758 \uc138\uacc4\uc5d0\uc11c \ub2f9\uc2e0\uc744 \uc99d\uba85\ud558\uc138\uc694."}]),i=Object(R.a)(s,2),l=i[0],u=(i[1],l.filter((function(e){return e.id===r}))[0]);return Object(c.jsx)("div",{className:"game_mode-container ".concat(e.hidden?"hidden":""),children:Object(c.jsxs)("div",{className:"game_mode-background",children:[Object(c.jsx)("img",{className:"line",src:gn,alt:""}),Object(c.jsxs)("div",{className:"game_mode",children:[Object(c.jsxs)("div",{className:"mode-container",children:[Object(c.jsx)(pn,{click_title:u.title,click_explain:u.explain}),Object(c.jsx)("div",{className:"side-block"}),Object(c.jsx)(bn,{click:r,onClick:function(e){o(Number(e))}.bind(this)}),Object(c.jsx)("div",{className:"side-block"})]}),Object(c.jsx)(hn,{click:r,onClickCancel:function(){e.hiddenOff()}.bind(this)})]}),Object(c.jsx)("img",{className:"line",src:gn,alt:""})]})})}var vn,xn,yn,wn,Cn,Sn=function(){var e=a.useState(!0),t=Object(R.a)(e,2),n=t[0],r=t[1];return Object(c.jsxs)("body",{className:"select-body",children:[Object(c.jsxs)("main",{className:"select-main",children:[Object(c.jsxs)("div",{className:"game__section",children:[Object(c.jsx)("div",{}),Object(c.jsxs)("div",{className:"display-flex flex-direction-column justify-align-center introduce-game-animation",children:[Object(c.jsx)("div",{className:"svg-container1",children:Object(c.jsx)("img",{className:"icon-sword",src:cn,alt:""})}),Object(c.jsx)("div",{className:"center-line1"}),Object(c.jsx)("h1",{className:"font-game-thick introduce-game",children:"\ub2f9\uc2e0\uc758 \uc120\ud0dd\uc774 \ub9cc\ub4e4\uc5b4\ub098\uac00\ub294 \ubaa8\ud5d8"})]}),Object(c.jsx)("div",{className:"appear-animation",onClick:function(){r(!1)},children:Object(c.jsx)("div",{className:"game-start-btn",children:Object(c.jsx)("h1",{className:"font-game-thick",children:"\uac8c\uc784 \uc2dc\uc791\ud558\uae30"})})}),Object(c.jsx)("div",{})]}),Object(c.jsxs)("div",{className:"create__section",children:[Object(c.jsx)("div",{}),Object(c.jsxs)("div",{className:"display-flex flex-direction-column justify-align-center introduce-create-animation",children:[Object(c.jsx)("div",{className:"svg-container2",children:Object(c.jsx)("img",{className:"icon-write",src:ln,alt:""})}),Object(c.jsx)("div",{className:"center-line2"}),Object(c.jsx)("h1",{className:"font-game-thick introduce-create",children:"\ub098\ub9cc\uc758 \uc2a4\ud1a0\ub9ac\ub97c \ub9cc\ub4e4\uc5b4 \uac8c\uc784 \uc81c\uc791\uc5d0 \ucc38\uc5ec\ud558\uc138\uc694"})]}),Object(c.jsx)("a",{href:"/#/story-list",children:Object(c.jsx)("div",{className:"appear-animation2",children:Object(c.jsx)("div",{className:"episode-make-btn",children:Object(c.jsx)("h1",{className:"font-game-thick",children:"\uc5d0\ud53c\uc18c\ub4dc \ub9cc\ub4e4\uae30"})})})}),Object(c.jsx)("div",{})]})]}),Object(c.jsx)("footer",{className:"select-footer"}),Object(c.jsx)(On,{hidden:n,hiddenOff:function(){r(!0)}})]})},An=(n(99),n.p+"static/media/book-svgrepo-com.88ded2c9.svg"),kn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAABLCAYAAAA4TnrqAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAEB0lEQVR4Xu1cvW7UQBA+h18huCipoUWioUGChleggu54NrrkBXgBChoQFJRAm7SghIifQM7MXGxw7F3dNzP2rJ2spRUON7Mz88342/Xe7hUzh6t8Mz8gM/MhTRWPDosh++e+N4Y2UPV/ycnOoGa8wLo2aBROnXuBtXSKZ1AzJrDKsiy4AR6eADKjF0ECjQZBxP2LPry6JkquKlNSQBRLkmNbIX7kz7gd0UCwCfbXEbusVaz01gHlOYhw4mMDCX/GzTQie2TcmI/xqGewBLkQgdUkdLqf5NwJHJCCEMIET2TO5AnLn7G29USQP6Xo15dKxdkJkT7E3ZLK0gGlDcFPD35CJGD5uT9SSxksQWIgsCykWPnykf7dp/aF2jdqxwIfhxaFX8WCPERkzkFtrfXy4cFGURQ8MxZdq5H08/MjUrouUpQK46Rfz/Dr4lkS6Xe4LFZZtwC/Sg1Q3C/p8bviD8CGlwgXTROLIC4xsJARAi7fSMR/vJDoy04MLGSaIH78Wk5b9fvCAO4HIni4N5ng5MCCZq4RDKzBdvTfv97pmHrweCFLQVM69OaAk37HrqWyrJylByGRpgUsq8spbat8tzhseYRXMwiVxwmVYmB5DOu8JD2pq6DZepNof5P3/Hd3ufjeYSewYq6vjncvVnZUl4n0QxZB0m8/SldU3l8QJQtnXRCI/oeZwRKk3ARWvXTTXsKp1+rbX8LG5AX+JhVtE3zcme5smJdxeF3qJrUb1CTAH9NsvTOI9E7cKLRKgke7Z7ltiXBLFvly1tD9MKqSahjGgwn1msESJCuDJQDL+n4nMLVeNLREE9JKNRDkylqfw38SGawMlgABgWiuLAFYyQgeJWmU9AUxq0VzZQmgy2BlsAQICERzZQnASkbwYyJuFK9cWShSwgU7QbfnUzRXliCvGSwBWLFtktgXoP3ub18S6XeSh8704ZjB9fbQydgxVdaYfAliP3oH4YpxEMxgCUDOYAnAshF8yFC/pC8IJSAKknnIiITgU2yB3COnP1BbFHd3OIm8mfQVtWc2xPrTjr0bep1rbkZym0C6U/8H3e/S/W75afG0v3BtPcXA4hMQ7i/ZBAzP7xi0fbq/X1WaLUKddvDXAmKA8A7AVD9csUdA6ULUa/G20CYW34M8hvbf2k6Jqp3KeZC+nsyDh5pCAeapgyDtGazTDcfQJQHrXPxESgAVeBu7BKyfEPzjF2rOIbkAgmRuIvi28mp/6NvNFJNXUzosP0omqawzTlanWMd01tkEIqKsBqvqfGpHSkxPghUsk3Ekmz3LmJ4EK1jwsNtz0NruTIOUyzE2mv3z8IwcUteCMLMQN2rUWlmoHX7XnPzlBdbUuC2YWC+wpsZtScFy4cahn/O/KODaJ0yA0bkAAAAASUVORK5CYII=";function Nn(){return vn=a.useRef(null),xn=a.useRef(null),yn=a.useRef(null),Object(c.jsxs)("div",{className:"right_ui",children:[Object(c.jsx)("div",{className:"health",ref:vn}),Object(c.jsx)("div",{className:"hungry",ref:xn}),Object(c.jsx)("div",{className:"money",ref:yn})]})}var En,Fn,In,Pn,Dn,Tn,Ln,Mn,Bn,zn,Rn,Un=0,Vn=0,Xn=1,Hn=!1;function Wn(e){var t=a.useRef(null),n=a.useRef(null),r=a.useRef(null),o=a.useRef(null),s=a.useRef(null),i=a.useRef(null),l=a.useRef(null),u=a.useRef(null),d=a.useRef(null);function j(){Pn=0,Dn=!1,Tn=0,Ln=1,Mn=r.current.clientHeight,In=En.split(""),n.current.addEventListener("click",g);var e=function(){var e=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Bn=!1;case 1:if(!1!==Bn){e.next=6;break}return e.next=4,new Promise((function(e,t){setTimeout((function(){b(),e()}),20)}));case 4:e.next=1;break;case 6:Hn?m():f();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}function b(){!0!==Dn?Tn<In.length?0!==Pn?Pn-=1:(t.current.innerHTML+=In[Tn],"."===In[Tn]&&(Pn=10),Tn++,n.current.clientHeight*Ln<t.current.clientHeight+l.current.clientHeight&&(t.current.innerText=t.current.innerText.slice(0,-1),r.current.style.height="".concat(n.current.clientHeight*Ln+Mn,"px"),O(),Pn=30,Ln++)):Bn=!0:(Bn=!0,En=(En=En.replace(/\t/g,"&nbsp;")).replace(/\n/g,"<br><br>"),t.current.innerHTML=En,n.current.removeEventListener("click",g))}function f(){var e=[],t=0;for(t=0;t<Fn.length;t++)e[t]=document.createElement("div"),e[t].className="option_div",e[t].id="".concat(t),e[t].innerText=Fn[t].text,e[t].addEventListener("click",(function(e){p(e.target.id)})),o.current.appendChild(e[t]);o.current.classList.remove("hidden")}function p(e){s.current.classList.remove("hidden"),ae.a.patch("".concat("http://ec2-13-209-21-126.ap-northeast-2.compute.amazonaws.com:8080","/game_play/changestatus/3"),{changed_health:zn[e].health_change,changed_money:zn[e].money_change,changed_hungry:zn[e].hungry_change,changed_strength:zn[e].strength_change,changed_agility:zn[e].agility_change,changed_armour:zn[e].armour_change,changed_mental:zn[e].mental_change}).then((function(t){s.current.innerHTML+="<br>"+Fn[e].result_text+"<br><br>";var a=!1;for(var r in zn[e])if(0!=zn[e][r]){a=!0;var o=void 0;switch(r){case"health_change":o="\uccb4\ub825\uc774";break;case"money_change":o="\ub3c8\uc774";break;case"hungry_change":o="\ud5c8\uae30\uac00";break;case"strength_change":o="\uadfc\ub825\uc774";break;case"agility_change":o="\ubbfc\ucca9\uc774";break;case"armour_change":o="\ubc29\uc5b4\uac00";break;case"mental_change":o="\uc815\uc2e0\ub825\uc774"}zn[e][r]<0?s.current.innerHTML+=o+" "+zn[e][r]+"\ub9cc\ud07c \uc904\uc5c8\uc2b5\ub2c8\ub2e4\n":s.current.innerHTML+=o+zn[e][r]+"\ub9cc\ud07c \ub298\uc5c8\uc2b5\ub2c8\ub2e4\n"}Rn.health+=zn[e].health_change,Rn.hungry+=zn[e].hungry_change,Rn.money+=zn[e].money_change,Rn.strength+=zn[e].strength_change,Rn.agility+=zn[e].agility_change,Rn.armour+=zn[e].armour_change,Rn.mental+=zn[e].mental_change,m(),s.current.style.height="".concat(n.current.clientHeight-i.current.clientHeight,"px"),O(),a&&h()}))}function m(){var e;(e=document.createElement("div")).className="result_div font-game-thick",Hn?(e.innerText+="\ub85c\ube44\ub85c . . .",e.addEventListener("click",(function(){window.location.href="http://localhost:3000/#/select"}))):(e.innerText+="\ub2e4\uc74c\uc73c\ub85c . . .",e.addEventListener("click",(function(e){!function(){t.current.innerText="",o.current.innerHTML="",s.current.innerHTML="",i.current.innerHTML="",r.current.style.height="auto",o.current.classList.add("hidden"),s.current.classList.add("hidden"),void i.current.classList.add("hidden"),Un+=1,(Rn.health<=0||Rn.hungry<=0)&&(Hn=!0);Hn?(Xn=11,x()):(Un+1)%3===1?(Vn+=1,w("main")):(Xn=Math.floor(9*Math.random())+2,x());setTimeout((function(){j()}),1500)}()}))),i.current.appendChild(e),i.current.classList.remove("hidden"),O(),Ln++}function h(){vn.current.innerHTML="",xn.current.innerHTML="",yn.current.innerHTML="",Rn.health<0?Rn.health=0:Rn.health>5&&(Rn.health=5),Rn.hungry<0?Rn.hungry=0:Rn.hungry>5&&(Rn.hungry=5);var e=Rn.health,t=Rn.hungry,n=Rn.money,a=[],r=[],o=[],s=[],c=[],i=Math.floor(n/5),l=0;for(l=0;l<e;l++)a[l]=new Image,a[l].className="right-ui-img",a[l].src="data:image/png;base64,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",a[l].width=30,vn.current.appendChild(a[l]);for(l=0;l<5-e;l++)r[l]=new Image,r[l].className="right-ui-img",r[l].src="data:image/png;base64,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",r[l].width=30,vn.current.appendChild(r[l]);for(l=0;l<t;l++)s[l]=new Image,s[l].className="right-ui-img",s[l].src="data:image/png;base64,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",s[l].width=30,xn.current.appendChild(s[l]);for(l=0;l<5-t;l++)c[l]=new Image,c[l].className="right-ui-img",c[l].src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABCCAYAAADAD1E9AAAACXBIWXMAABJ0AAASdAHeZh94AAACv0lEQVR4Xu2bsU7DMBCGG8RUlVbq0KEsIF4AdlbepEOl7n2OqnMfgHdghB1eAAEDA0sXqkqVKoqNCILUxr91l6ZJ/kgs6d35/PnsPzZJ0qjOtVHuSoLEO0CMaOMnQIDC6iBAAhQSELqzAoUAD4X+ubsnSbIxV7CdwWBwb4wugoaAQbPZfJ1Op38aNXk0TB5byrz3FYjA+2aiAs/GWi6XxwDnL5O9B4h2JG8730ASoJA8ARKgkIDQHdrvCdtwult1tT+ERGI4HN6s1+urPHKIidlqtd4nk8lR1qfQKRyCZ5PdB3g2j8VisQWPKhxTgh7bQitQIf/CQxQGEJm+hdMBEigMIJBbKUzU98Lo3nU8Ht/N5/PLUlD6J0n1CkSnZhXgUYUVyl+9AhVyKlUIAhQOFwEKAcIqnO5dQ/vX0Wj0vFqtToR5lcYdBhgCl/a4TvCiVBh9PClN6SglyjVQCJIACVBIQOjuFBHXabFR1wcjEOfC9irn7p3CWdEgPPfYOwFScfGJQhHBWTktCZAAhQRA906n8+Iytf8X3nr1yZwW35sDT7WXdcAc98psNpv5eP2575zCdYcXM5JcA0Fa9v1A10WAIEDXUhd1GoO3Uy9LVqBjvI3iPqa37bb2e/o63zOOOlCtQm151DXbtTNz42vRC+3KWIHCqiBAAhQSELqzAh0Afc98fA5sNJ58BWehpX/G5gMtzMqoMKiup6m6ZgGF1NYHlFMYLTWPXa0AxqxtKNdaAYxZ2wgQJSC0c1Zgt9t9FsbdqXuv17v9r8FfChv+bjYyc9+XSlsNme9xI0PrmIPqahsr5Kuruq2BOqP6K0olAOahrijpSgDMQ13rBhDtr7qdswJdU6Ldbr+ptx4I2O/3r8G9665T+2kvRrnUHwHAXsfkCIbUM6vKGqhHJDISAUYCy5oTIAEKCQjdWYFCgJ+f6Yt317jwrQAAAABJRU5ErkJggg==",c[l].width=30,xn.current.appendChild(c[l]);if(n<=5)for(l=0;l<n;l++)o[i+l]=new Image,o[i+l].className="money_img",o[i+l].src=kn,o[i+l].width=30,yn.current.appendChild(o[i+l]);else{for(l=0;l<i;l++)o[l]=new Image,o[l].className="money5_img",o[l].src="data:image/png;base64,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",o[l].width=30,yn.current.appendChild(o[l]);for(l=0;l<n%5;l++)o[i+l]=new Image,o[i+l].className="money_img",o[i+l].src=kn,o[i+l].width=30,yn.current.appendChild(o[i+l])}}function g(){Dn=!0}function O(){var e=n.current.scrollHeight;n.current.scrollTo({top:e,behavior:"smooth"})}function v(){return(v=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uba54\uc778 \uc5d0\ud53c\uc18c\ub4dc \uac00\uc838\uc624\uae30 \ud568\uc218 \uc9c4\uc785"),e.next=3,ae.a.get("".concat("http://ec2-13-209-21-126.ap-northeast-2.compute.amazonaws.com:8080","/game_play/mainepisode")).then((function(e){console.log("\uba54\uc778 \uc5d0\ud53c\uc18c\ub4dc \uac00\uc838\uc624\uae30 \uc131\uacf5"),wn=e.data.mainEpisodes}));case 3:w("main");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return y.apply(this,arguments)}function y(){return(y=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.a.get("".concat("http://ec2-13-209-21-126.ap-northeast-2.compute.amazonaws.com:8080","/game_play/episode/").concat(Xn)).then((function(e){console.log("\ub178\ub9d0 \uc5d0\ud53c\uc18c\ub4dc \uac00\uc838\uc624\uae30 \uc131\uacf5"),Cn=e.data}));case 2:w("normal");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){var t;"main"===e?t=wn[Vn]:"normal"===e&&(t=Cn),d.current.innerText="#"+t.Episode_Text.id,u.current.innerText=t.Episode_Text.title,En=t.Episode_Text.main_text,Fn=t.Option_Texts,zn=t.Option_Stat_Changes}return a.useEffect((function(){console.log("\uac8c\uc784 \uc2a4\ud0c0\ud2b8 \ud568\uc218 \uc9c4\uc785"),function(){v.apply(this,arguments)}(),ae.a.get("".concat("http://ec2-13-209-21-126.ap-northeast-2.compute.amazonaws.com:8080","/game_play/character/1")).then((function(e){Rn=e.data,h()})),setTimeout(j,3e3)}),[]),Object(c.jsxs)("main",{className:"main",children:[Object(c.jsx)("div",{className:"episode_logo",children:Object(c.jsx)("img",{className:"icon-book",src:An,alt:""})}),Object(c.jsx)("div",{className:"episode_logo_line"}),Object(c.jsxs)("div",{className:"text_view",ref:n,children:[Object(c.jsxs)("div",{className:"header_text_view",ref:l,children:[Object(c.jsx)("div",{className:"episode_number font-game-thick",children:Object(c.jsx)("span",{className:"episode_number_text",ref:d,children:"#0 \uc11c\ub9c9"})}),Object(c.jsx)("div",{className:"episode_title font-game-thick",ref:u,children:"\ubaa8\ud5d8\uc758 \uc2dc\uc791"})]}),Object(c.jsxs)("div",{className:"main_text_view",ref:r,children:[Object(c.jsx)("div",{className:"episode_text",ref:t}),Object(c.jsx)("div",{className:"episode_option hidden font-game-thick",ref:o}),Object(c.jsx)("div",{className:"episode_result_text hidden",ref:s}),Object(c.jsx)("div",{className:"episode_result_option hidden",ref:i})]})]}),Object(c.jsxs)("div",{className:"main_ui",children:[Object(c.jsx)("button",{className:"main-ui-btn font-game-thin",onClick:function(){e.stat_window_event()},children:"\ub2a5\ub825\uce58"}),Object(c.jsx)("button",{className:"main-ui-btn font-game-thin",children:"SAVE"}),Object(c.jsx)("button",{className:"main-ui-btn font-game-thin",children:"\uc778\ubca4\ud1a0\ub9ac"}),Object(c.jsx)("button",{className:"main-ui-btn font-game-thin",children:"\ud658\uacbd\uc124\uc815"})]})]})}function Qn(e,t){for(var n=[],a=0;a<t;a++)n.push(Object(c.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEOUlEQVR4Xu2czWoUQRDHZ/zMQVBBMYgm6wq+gC8gkkN8AMUHUfQRBPMCvkLEczxI8AW8i7JLEvSQU+5iXLtlN07VbKa6uqo/ZtIDgUy6q7vq39W/7e6ZTV1ldq2vr8+aLu3v72MP65xcPpeTM330pQgoHLWsBJzNZllNTxdtkztsmPfTOHp74ezehxvA74+fD8H9kxc/mve/zc1Fl0BD1ckhA0/E8wjyvIeNqkkOAkoCSj6DkgqowTyNNiQjeEFi7GNrmPfd2K2anyuj0ajCzKvGb0Czm9VrcL+zBXut6/pP4y/H5veoMaXIwGtWPB/xHWyiMzGFgPBj1kGVnKtEFTAGr0wfUWMKzos589ZMFl1yYR6VbZuPblFMtBxcXHZfHVTQoI3Po7hpxaOECVQefJkTQ8CrgcTJotmgAsZgHqViaCaqM9Aw76sJymbdqgbzKIFSMzFEBq7MF8pU7CnK1ZkYQsC7KZRJ1aeqgHPmqbapLYw2l8UMnK/z7phAV2IwjxLUgYnNvbN4nSgW0ARkp+xlKrBMy8VM1JhufRVPZUxFAoZeY6lESDQiZSJ7Chvm2Qe1dm9bWebtvkUnSOg8L4YIXX1gJk624a4SnSeymeiTgf/EG+jFZqKPgAPVzi8sloCGF9FPfP3C8rficp1MWcO8qXHn3sIlzLzxxjt/b5dZHn3qbo8qZ3oznR4Bi/vPbLgnF8lElww8EY/p2xCqkwnmIuAQhAgWQ6eAXB4E8zJhw5QGrRTF76q0mPfwKQwHM4m7DpQyjWmPmfft4BeI58EaXCciJtq6QLNlGSh5VyVhrqTpujCQqTve+gEBqfnO7Guw1Zsi1vid5Na7Ktc3eEJQTGQyi9e5qY3ap5hHtY+Z+PjlsYXmApRxn+JTzvakvPkpUxcGCketCCgUsH0eiJmHmUUxEZdP4ft9FWUvDEibeXidWFXwPKVkoHDAioCKAjYf9wmbPTvmYF9nF4jmOQcQcm/3OVBj+uU9uB+jvTFVHlta7A+198Xl6Hsp3Xth84AFfNEvdrB97K8wUDhqywQ8ELY5RHM7M+1P63Oi88jaMhE9N61mk1edTKQYg5mprXZo5mF/O6dwYSI9vIWB3RqRH6ouApKN0OPUyxpOcZOP7ZqhL2PizpZ9NfD/hc/PQjMxNvNYDMSVCxPbM8llCvdy/sVy2kdAJzbECkC5H3ZsLAae4izoVMpEriAUY7l7W27/PhnI7WPQ9YuAwuHVEJDNDaHPWZlrMBAHBASdbI9BefsZg64e3HdbpL1rZKDUh17bFwGFwxdCwDPFxBAMjMrE2MwT7YWF2T5I8xBTeJBCnRZUDAEHzcQYDFRlYmrmFQYqAybGFFZ2Oa/mioDC8UjBQBYTcWXqextCPdjmJQPZkkGDImARUKiA0DwHBnYycUl8WflcprAwA4uAQxLQ5X+4uNQRasIy/wtEmSJ0Rw54KwAAAABJRU5ErkJggg==",className:"cristal"}));for(a=0;a<e-t;a++)n.push(Object(c.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAABJ0AAASdAHeZh94AAAHIElEQVR4Xu1cSW8cRRTOLGYTUtgDdsAGORwgLArIYLBk+WBx4A9w4Oj/4TgSEncuUfApXCKRC2ckZJAQi+AEiE2AjGU7lmMbbIzxrHyv6Rp11/R0vaquqq4x6ag04+5Xr1599d7Xr5ZJ5VRg1/j4+M8waVKYtbq6mrSwgz9qIZlcDckYhi0VhoxXkRABbOUg0PWKDqOxEAHMtanb7QblhXUGyE5Fpqam3tva2roguG1+fv5MToONSqVCHhp5Yr1e32u1Wg86NVChvHQAAd5zsPEpJgh3JOXa7fZpZj1nYiGEsPEgIpyrZYd0qQDGnS+SlkR8SHrKAtI7Ic/Ozr67vb397OHhIYVfBZw3gc/bDGOsuby8TANAnNit1Wp7COuHDHUZVTMOH6PWUGl/f38S4E2Z1pfqjUiceI8lvWw13kN4d3f3YbZ1+oLeQ9krgBY4TwUp9ScC0RcnOudAcN7V9fX155vNJqUgxHmP4vN2FRKmz8GJNF+mcgo5400A+YipLk495xy4s7NzDuA9wzHGkgx5YRRZAO9+SzoHqnEewgcHB/e57kSOfud5onMA0bkieV5R7IminPKh9RCem5u7Cq+bRK5Hc9Q6OO+Boijo1F9YWEiKgwYrTYpmKvi+g7C2mgVYB/D4+PgswJvW6bRD2cgDhX4XnGg9hDc3N8dsAILO2lAj67CedVgHsNPp3Gmj5wi3lBr5b8M2rPNh4RBGnncNXncBoUu5XQ2c5+Sta+qREiceJ9YTiRML54mFAdzY2DjfaDTOGXqE72qp6MCgFH7BFQ5hgOdsVuEB3cIhXQjAeL6ZWiX20GmbTfTyRNO5s/ZbaXp6+jrClvYw6DU5Eud5Vl4cNpFh6jrC3JkiSOSJ2wBylFk3EtPmQID3NOo9rtNIwLJ9nEieiIudQ5mEsEmdgDFMZ0u6hrLBSKyxpVaBdRsMXD5aydFZT1Ry4MzMzJW1tbWXie/iPO8sPoeV81Tj1wAnEq3ReiLF8g2A+VheJSUHAryXoMDnep6qky6fi80tsZ54RsWJnBA+ySGrGoxoiyBPaCCAMQ/Qc6WXqqwY4ufKPZY+dHFWZRnHLV6IOY/W88bxfZiT5SLjR/vOBKLYZ9nA9yeSCvu8C+C9CAE6r3Lr+u/FSZdYVR+VOTErhJ1wnqXlqLIHtW97IgWgy31b0+UoW4hZGsC+uXMFZ5K/gZE0H2yTseA8yvPutmX4CdPz58rKyu/Ypo0SbgxKgzjw/AnrZKHuCE8dEDGnk3vcJMPJA5UGUaOWQkTZlmsBAkWAV6tEBxxyLys5Xtn8puqk6fN2V+1fagnT1v8n9W4BWHCgvQE4DDxpwuPEgd+hjFSr1Sb2dClRpKmb9eWqYeBJho1HwGYdhd4ulBM2U3NhSqQnJia+xYPezw6QFxZ08uGqPjaWPlixtLSU7EAHGEUvXrHsnwrh+CYdxmFfJm7PVh6oYHLPJIsD/9Cxm+H2Ouq8ytoY/L48cHR09H3svP2DntyLQstYtHyjnNqRMcMGJsNesd0pjgz/LY+wck8EFRr0khEVpbMmXj2maGMYYvxLd1nBecA44jzaH8nc6uSkMdEig6vLRhhxbKNpWZW/3StUCg8cuE/MAXCXY2Cfa0vH0wbpYISRSfOZdThTs2RFzga7EkAoeQdKv0fZQ6E86EdOj3wCw7FHAzzytk58DO4vlW4OB8o6DnHjrmHlRAbn0dpo9Kt5Kx6YMQI3VaPCee6L+zi2JGTI+9oEHAc8qqcM4QwDrmkalSkeWohLILK7qL0eiJG5iM7/gBbeQHkSheaGr3JbDDRfFHmekvPkfppwoKzjJ9zoHfENLU9kcB5NFqLpKzdskwCYhLAM4Mdc7wtQjjivpcN5ch9sAPi2KTCBvEjYhymz+qnNgRlKfsE9WkN8E+U1FMoV6VN5lfQiiWYXsXFHJmGb7JgNDpSB+hQ3XhE3fXMig/PoCFuUqihHmCFgI4TlZj5gtFuWSC/Ps2WACwAvFzUuEG5kdcMFgPtomX7qegnlK5TPWJYkhAQ3WgIymttS2KIc2gpdYa4LDpTxorM3veMjeZxokmQzOG8Eep0tybnwQBnAL7ge6OCtLLyPa4K2nA8A39K2yl4F9qKAaZM+APwtDuHr+KT/3vPzLGM5B3mYnUxxHrOOsZgPDpSN+xU3ej8V080TGZxXB+epj1UZQ5au6MMDZVNp8cHVRSHrDTzqRBkAXnSFHvRamV3o2FcGgMSBr6N8iXID5WsdgyXZ6CdZKOJnCDQP93qVwYFyB7dxo/fT+8XFxVwApLMqtG9bs50c64xAGR4o20e7faaX8zRFZVgIAH6oMjLnuXfOk20JAUCK2Y9QyBPp7MknOYDRXozgO5qe9Z1VKTAYJ6bqcfxiEAufyU9nc1pT9ELwQNn2vBdb6SEbYgjrABhC1pCyN0QPzIum4DzwX0I+S/2/9vtrAAAAAElFTkSuQmCC",className:"cristal"}));return n}function qn(){return Object(c.jsxs)("div",{className:"stat-ui font-game-thick",children:[Object(c.jsx)("div",{className:"stat-ui-title",children:Object(c.jsx)("h1",{children:"\uce90\ub9ad\ud130 \uc815\ubcf4"})}),Object(c.jsxs)("div",{className:"stat-ui-div",children:[Object(c.jsx)("div",{className:"stat-img-container",children:Object(c.jsx)("div",{className:"stat-ui-div-text",children:"\ud798"})}),Object(c.jsx)("div",{className:"stat-all-container",children:Object(c.jsx)("div",{className:"cristal-div",children:Qn(20,Rn.strength)})})]}),Object(c.jsxs)("div",{className:"stat-ui-div",children:[Object(c.jsx)("div",{className:"stat-img-container",children:Object(c.jsx)("div",{className:"stat-ui-div-text",children:"\ubbfc\ucca9"})}),Object(c.jsx)("div",{className:"stat-all-container",children:Object(c.jsx)("div",{className:"cristal-div",children:Qn(20,Rn.agility)})})]}),Object(c.jsxs)("div",{className:"stat-ui-div",children:[Object(c.jsx)("div",{className:"stat-img-container",children:Object(c.jsx)("div",{className:"stat-ui-div-text",children:"\ubc29\uc5b4\ub825"})}),Object(c.jsx)("div",{className:"stat-all-container",children:Object(c.jsx)("div",{className:"cristal-div",children:Qn(20,Rn.armour)})})]}),Object(c.jsxs)("div",{className:"stat-ui-div",children:[Object(c.jsx)("div",{className:"stat-img-container",children:Object(c.jsx)("div",{className:"stat-ui-div-text",children:"\uc815\uc2e0\ub825"})}),Object(c.jsx)("div",{className:"stat-all-container",children:Object(c.jsx)("div",{className:"cristal-div",children:Qn(20,Rn.mental)})})]})]})}function Kn(){return Object(c.jsx)("div",{className:"left_ui"})}var Yn=function(){var e=a.useState(!1),t=Object(R.a)(e,2),n=t[0],r=t[1];a.useRef(null);return Object(c.jsxs)("div",{className:"game_play_body",children:[Object(c.jsx)(Kn,{}),Object(c.jsx)(Wn,{stat_window_event:function(){r(!n)}}),Object(c.jsx)(Nn,{}),n?Object(c.jsx)(qn,{}):void 0]})},Gn=(n(519),n.p+"static/media/google-logo.0b50af2f.png"),Jn=n.p+"static/media/arrow-right-svgrepo-com.44510108.svg",Zn=function(){var e=Object(b.f)(),t=a.useState(""),n=Object(R.a)(t,2),r=n[0],o=n[1],s=a.useState(""),i=Object(R.a)(s,2),l=i[0],u=i[1],d=a.useCallback((function(e){return o(e.target.value)}),[]),j=a.useCallback((function(e){return u(e.target.value)}),[]),f={email:String,nickname:String,accessToken:String};return Object(c.jsxs)("body",{className:"login-img",children:[Object(c.jsxs)("main",{className:"login-main",children:[Object(c.jsxs)("header",{className:"login-header",children:[Object(c.jsx)("a",{href:"/",children:Object(c.jsx)("div",{children:Object(c.jsxs)("span",{className:"font-hambak login__title",children:["TEXT ADVENTURE",Object(c.jsx)("br",{}),"PROJECT"]})})}),Object(c.jsx)("div",{})]}),Object(c.jsxs)("div",{className:"login-div",children:[Object(c.jsx)("div",{className:"grid-1 font-game-thick",children:"\ub85c\uadf8\uc778"}),Object(c.jsxs)("div",{className:"grid-2 ",children:[Object(c.jsx)("input",{type:"email",placeholder:"\uacc4\uc815 \uc774\uba54\uc77c",required:!0,onChange:d}),Object(c.jsx)("input",{type:"password",placeholder:"\ube44\ubc00\ubc88\ud638",required:!0,onChange:j}),Object(c.jsx)("form",{className:"google-login-form",children:Object(c.jsxs)("button",{className:"google-login",onClick:function(e){e.preventDefault(),window.location.href="".concat("http://ec2-13-209-21-126.ap-northeast-2.compute.amazonaws.com:8080","/auth/googleAuth")},children:[" ",Object(c.jsx)("img",{src:Gn}),"\uad6c\uae00 \ub85c\uadf8\uc778"]})}),Object(c.jsxs)("div",{className:"autoLogin-container",children:[Object(c.jsx)("input",{type:"checkbox",id:"autoLogin",name:"autoLogin"}),Object(c.jsx)("label",{className:"font-game-thin",htmlFor:"autoLogin",children:"\ub85c\uadf8\uc778 \uc0c1\ud0dc \uc720\uc9c0"})]})]}),Object(c.jsx)("div",{className:"grid-3",children:Object(c.jsx)("button",{className:"login-enter-btn",onClick:function(){Object(ae.a)({method:"POST",url:"".concat("http://ec2-13-209-21-126.ap-northeast-2.compute.amazonaws.com:8080","/auth/login"),data:{email:r,password:l}}).then((function(t){14==t.data.errorMsg?console.log("\uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \uc0ac\uc6a9\uc790\uc785\ub2c8\ub2e4."):15==t.data.errorMsg&&console.log("\uc798\ubabb\ub41c \ube44\ubc00\ubc88\ud638\uc785\ub2c8\ub2e4."),f.email=t.data.email,f.nickname=t.data.nickname,f.accessToken=t.data.access_token;var n=new an;n.setItem("userToken",f.accessToken),n.setItem("userNickname",f.nickname),e.push("/")}))},children:Object(c.jsx)("img",{src:Jn,alt:""})})}),Object(c.jsxs)("div",{className:"grid-4 font-game-thin",children:[Object(c.jsx)("a",{href:"",children:"\uc544\uc774\ub514/\ube44\ubc00\ubc88\ud638 \ucc3e\uae30"}),Object(c.jsx)("br",{}),Object(c.jsx)("a",{href:"/#/signup",children:"\ud68c\uc6d0\uac00\uc785"})]})]}),Object(c.jsx)("div",{})]}),Object(c.jsx)("footer",{className:"login-footer font-game-thin",children:Object(c.jsxs)("div",{className:"footer-link-container",children:[Object(c.jsx)("a",{href:"/",children:"\ud648"}),Object(c.jsx)("a",{href:"",children:"\uace0\uac1d\uc13c\ud130"}),Object(c.jsx)("a",{href:"",children:"\ucfe0\ud0a4\uc124\uc815"}),Object(c.jsx)("a",{href:"",children:"\uc5b8\uc5b4"})]})})]})},_n=(n(520),n.p+"static/media/x.f52a7d36.svg"),$n=(n(521),function(e){Object($t.a)(n,e);var t=Object(en.a)(n);function n(e){var a;return Object(tn.a)(this,n),(a=t.call(this,e)).state={id:a.props.emailDefault},a}return Object(_t.a)(n,[{key:"render",value:function(){return Object(c.jsx)("div",{className:"signup-background",children:Object(c.jsxs)("form",{className:"signup-info",onSubmit:function(e){this.props.submitForm(e)}.bind(this),children:[Object(c.jsxs)("div",{className:"signup-header",children:[Object(c.jsx)("div",{}),Object(c.jsx)("h1",{className:"font-game-thick",children:"\ud68c\uc6d0\uac00\uc785"}),Object(c.jsx)("div",{className:"signup-close",onClick:function(){this.props.closeForm()}.bind(this),children:Object(c.jsx)("img",{src:_n})})]}),Object(c.jsx)("div",{className:"signup-title font-game-thick",children:Object(c.jsx)("h1",{children:"\ubaa8\ud5d8\uc5d0 \ub3c4\uc804\ud558\uc2dc\ub294 \uc5ec\ub7ec\ubd84, \ud658\uc601\ud569\ub2c8\ub2e4."})}),Object(c.jsxs)("div",{className:"signup-line font-game-thin",children:[Object(c.jsx)("label",{htmlFor:"email",children:"\uc544\uc774\ub514(\uc774\uba54\uc77c)"}),Object(c.jsx)("input",{type:"email",id:"email",name:"email",value:this.state.id,onChange:function(e){this.setState({id:e.target.value})}.bind(this),required:!0})]}),Object(c.jsxs)("div",{className:"signup-line font-game-thin",children:[Object(c.jsx)("label",{htmlFor:"pw",children:"\ube44\ubc00\ubc88\ud638"}),Object(c.jsx)("input",{type:"password",id:"pw",name:"pw",required:!0})]}),Object(c.jsxs)("div",{className:"signup-line font-game-thin",children:[Object(c.jsx)("label",{htmlFor:"pwc",children:"\ube44\ubc00\ubc88\ud638 \ud655\uc778"}),Object(c.jsx)("input",{type:"password",id:"pwc",name:"pwc",required:!0})]}),Object(c.jsxs)("div",{className:"signup-line font-game-thin",children:[Object(c.jsx)("label",{htmlFor:"nic",children:"\ubcc4\uba85"}),Object(c.jsx)("input",{type:"text",id:"nic",name:"nic",required:!0})]}),Object(c.jsxs)("div",{className:"signup-line font-game-thin input-checkbox",children:[Object(c.jsxs)("label",{htmlFor:"check",children:["\uac8c\uc784 \uc774\uc6a9 \uc57d\uad00 \ub3d9\uc758 ",Object(c.jsx)("a",{className:"terms-a",href:"/",children:" \uc790\uc138\ud788"})]}),Object(c.jsx)("input",{type:"checkbox",id:"check",required:!0})]}),Object(c.jsx)("button",{className:"signup-form-submit-btn",children:"\uac00\uc785\ud558\uae30"})]})})}}]),n}(a.Component)),ea=(n(522),function(e){Object($t.a)(n,e);var t=Object(en.a)(n);function n(e){var r;return Object(tn.a)(this,n),(r=t.call(this,e)).inputRef=Object(a.createRef)(),r.state={mode:"default",email:"",password:"",password_con:"",nickname:""},r.inputRef=a.createRef(),r}return Object(_t.a)(n,[{key:"render",value:function(){var e="";null===this.inputRef.current||(e=this.inputRef.current.value);var t=Object(c.jsx)($n,{closeForm:function(){this.setState({mode:"default"})}.bind(this),submitForm:function(e){e.preventDefault(),this.state.email=e.target.email.value,this.state.password=e.target.pw.value,this.state.password_con=e.target.pwc.value,this.state.nickname=e.target.nic.value,Object(ae.a)({method:"POST",url:"".concat("http://ec2-13-209-21-126.ap-northeast-2.compute.amazonaws.com:8080","/auth/signup"),data:{email:this.state.email,nickname:this.state.nickname,password:this.state.password}}).then((function(e){13==e.data.errorMsg?console.log("\uc774\ubbf8 \uac00\uc785\ub41c \ud68c\uc6d0\uc785\ub2c8\ub2e4."):11==e.data.errorMsg&&console.log("\uc11c\ubc84 \ubb38\uc81c\ub85c \ud68c\uc6d0\uac00\uc785 \uc2e4\ud328"),10==e.data.successMsg&&(window.location.href="".concat("http://ec2-3-38-165-63.ap-northeast-2.compute.amazonaws.com:5000","/#/login"))}))}.bind(this),emailDefault:e}),n=t;return"default"===this.state.mode?n=null:"signup"===this.state.mode&&(n=t),Object(c.jsxs)("div",{className:"email-container",children:[n,Object(c.jsx)("input",{className:"email-input",type:"email",ref:this.inputRef,placeholder:"\uc774\uba54\uc77c \uc8fc\uc18c",required:!0}),Object(c.jsx)("button",{className:"font-game-thin signup-button",onClick:function(e){this.setState({mode:"signup"})}.bind(this),children:"\uc2dc\uc791\ud558\uae30"})]})}}]),n}(a.Component)),ta=function(){return Object(c.jsxs)("body",{children:[Object(c.jsx)("div",{className:"signup-background-img"}),Object(c.jsxs)("main",{className:"signup-main",children:[Object(c.jsx)("h1",{className:"welcome-title font-game-thick",children:"\ub05d \uc5c6\ub294 \uc774\uc57c\uae30 \uc18d\uc73c\ub85c."}),Object(c.jsx)("h2",{className:"welcome-title-2 font-game-thin",children:"\ub2e4\uc591\ud55c \uc7a5\ub974\uc758 \ud14d\uc2a4\ud2b8 \uc5b4\ub4dc\ubca4\ucc98 \uac8c\uc784\uc744 \uc990\uae30\uc138\uc694. \ub204\uad6c\ub098 \uc790\uc2e0\uc774 \uc6d0\ud558\ub294 \uc774\uc57c\uae30\ub97c \ub9cc\ub4e4\uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4."}),Object(c.jsx)("h3",{className:"welcome-title-3 font-game-thin",children:"\ubaa8\ud5d8\uc744 \ub5a0\ub0a0 \uc900\ube44\uac00 \ub418\uc5c8\ub098\uc694? \uac8c\uc784\uc744 \ud50c\ub808\uc774\ud558\uac70\ub098 \uc2a4\ud1a0\ub9ac\ub97c \uc81c\uc791\ud558\ub824\uba74 \uc774\uba54\uc77c \uc8fc\uc18c\ub97c \uc785\ub825\ud558\uc138\uc694."}),Object(c.jsxs)("div",{className:"signup-form-container",children:[Object(c.jsx)(ea,{onFormSubmit:function(){}.bind(undefined)}),Object(c.jsx)("button",{className:"google-signup-btn",children:Object(c.jsx)("img",{src:Gn,alt:""})})]})]}),Object(c.jsxs)("footer",{className:"signup-footer",children:[Object(c.jsx)("a",{href:"/",children:Object(c.jsx)("h1",{className:"signup-footer-logo font-game-thick",children:"Endless Adventure StorY"})}),Object(c.jsxs)("div",{className:"signup-footer-menu",children:[Object(c.jsxs)("select",{name:"",id:"",children:[Object(c.jsx)("option",{value:"kr",children:"\ud55c\uad6d\uc5b4"}),Object(c.jsx)("option",{value:"en",children:"English"})]}),Object(c.jsx)("button",{children:"\ub85c\uadf8\uc778"})]})]})]})},na=(n(523),function(){return Object(c.jsxs)("div",{className:"user-board",children:[Object(c.jsx)("div",{className:"top",children:Object(c.jsx)("div",{className:"search-bar"})}),Object(c.jsx)("div",{"left-ui":!0}),Object(c.jsx)("div",{className:"main"})]})}),aa=function(){var e=Object(l.usePrefsContext)().prefs;return console.log(e.welcomeSeen),Object(c.jsx)(j.a,{children:e.welcomeSeen?Object(c.jsxs)(b.c,{children:[Object(c.jsx)(b.a,{exact:!0,path:"/",children:Object(c.jsx)(sn,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/select",children:Object(c.jsx)(Sn,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/login",children:Object(c.jsx)(Zn,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/signup",children:Object(c.jsx)(ta,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/game-play",children:Object(c.jsx)(Yn,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/story-list",children:Object(c.jsx)(Kt,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/user-board",children:Object(c.jsx)(na,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId",children:Object(c.jsx)(Ot,{})}),Object(c.jsx)(b.a,{path:"/story-formats",children:Object(c.jsx)(Se,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId/play",children:Object(c.jsx)(Gt,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId/proof",children:Object(c.jsx)(Jt,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId/test/:passageId",children:Object(c.jsx)(Zt,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId/test",children:Object(c.jsx)(Zt,{})}),Object(c.jsx)(b.a,{path:"*",render:function(e){return console.warn('No route for path "'.concat(e.location.pathname,'", rendering story list')),Object(c.jsx)(Kt,{})}})]}):Object(c.jsxs)(b.c,{children:[Object(c.jsx)(b.a,{exact:!0,path:"/",children:Object(c.jsx)(sn,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/select",children:Object(c.jsx)(Sn,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/login",children:Object(c.jsx)(Zn,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/signup",children:Object(c.jsx)(ta,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/game-play",children:Object(c.jsx)(Yn,{})}),Object(c.jsx)(b.a,{exact:!0,path:"/story-list",children:Object(c.jsx)(Kt,{})}),Object(c.jsx)(b.a,{path:"/story-formats",children:Object(c.jsx)(Se,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId/play",children:Object(c.jsx)(Gt,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId/proof",children:Object(c.jsx)(Jt,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId/test/:passageId",children:Object(c.jsx)(Zt,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId/test",children:Object(c.jsx)(Zt,{})}),Object(c.jsx)(b.a,{path:"/stories/:storyId",children:Object(c.jsx)(Ot,{})}),Object(c.jsx)(b.a,{path:"*",render:function(e){return console.warn('No route for path "'.concat(e.location.pathname,'", rendering story list')),Object(c.jsx)(Kt,{})}})]})})},ra=n(67),oa=function(e){var t=e.children,n=a.useState(!1),r=Object(R.a)(n,2),s=r[0],u=r[1],d=a.useState(!1),j=Object(R.a)(d,2),b=j[0],f=j[1],p=a.useState(!1),m=Object(R.a)(p,2),h=m[0],g=m[1],O=a.useState(!1),v=Object(R.a)(O,2),x=v[0],y=v[1],w=a.useState(!1),C=Object(R.a)(w,2),S=C[0],A=C[1],N=Object(l.usePrefsContext)(),E=N.dispatch,F=N.prefs,I=Object(Z.useStoriesContext)().dispatch,P=Object(k.useStoryFormatsContext)(),D=P.dispatch,T=P.formats,L=Object(ra.a)(),M=L.prefs,B=L.stories,z=L.storyFormats;return a.useEffect((function(){function e(){return(e=Object(q.a)(Q.a.mark((function e(){var t,n,a;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=14;break}return e.next=3,z.load();case 3:return t=e.sent,e.next=6,M.load();case 6:return n=e.sent,e.next=9,B.load();case 9:a=e.sent,D({type:"init",state:t}),E({type:"init",state:n}),I({type:"init",state:a}),f(!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),u(!0)}),[D,b,s,M,E,B,I,z]),a.useEffect((function(){b&&!x&&(D({type:"repair"}),y(!0))}),[D,x,b]),a.useEffect((function(){b&&x&&!h&&(E({type:"repair",allFormats:T}),g(!0))}),[x,T,b,E,h]),a.useEffect((function(){if(b&&x&&h&&!S){var e;try{e=Object(k.formatWithNameAndVersion)(T,F.storyFormat.name,F.storyFormat.version)}catch(t){try{e=Object(k.formatWithNameAndVersion)(T,Object(l.defaults)().storyFormat.name,Object(l.defaults)().storyFormat.version)}catch(o){console.error("Could not locate a safe story format, skipping story repair: ".concat(o.message))}}e&&I({type:"repair",allFormats:T,defaultFormat:e}),A(!0)}}),[D,x,T,b,E,h,F.storyFormat.name,F.storyFormat.version,B,I,S]),b&&x&&h&&S?Object(c.jsx)(c.Fragment,{children:t}):Object(c.jsx)(i,{})},sa=n(137);function ca(){var e=Object(sa.a)();return a.useEffect((function(){document.body.dataset.appTheme=e}),[e]),null}n(524),n(525),n(526);var ia=function(){return Object(c.jsx)(o.b,{children:Object(c.jsxs)(l.PrefsContextProvider,{children:[Object(c.jsx)(d,{}),Object(c.jsx)(ca,{}),Object(c.jsx)(k.StoryFormatsContextProvider,{children:Object(c.jsx)(Z.StoriesContextProvider,{children:Object(c.jsx)(oa,{children:Object(c.jsx)(a.Suspense,{fallback:Object(c.jsx)(i,{}),children:Object(c.jsx)(aa,{})})})})})]})})};r.render(Object(c.jsx)(a.StrictMode,{children:Object(c.jsx)(ia,{})}),document.getElementById("root"))}],[[527,1,2]]]);
//# sourceMappingURL=main.a307f3da.chunk.js.map